(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function DT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I_={exports:{}},mc={},S_={exports:{}},me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tl=Symbol.for("react.element"),NT=Symbol.for("react.portal"),bT=Symbol.for("react.fragment"),MT=Symbol.for("react.strict_mode"),OT=Symbol.for("react.profiler"),FT=Symbol.for("react.provider"),LT=Symbol.for("react.context"),BT=Symbol.for("react.forward_ref"),jT=Symbol.for("react.suspense"),zT=Symbol.for("react.memo"),UT=Symbol.for("react.lazy"),Um=Symbol.iterator;function $T(t){return t===null||typeof t!="object"?null:(t=Um&&t[Um]||t["@@iterator"],typeof t=="function"?t:null)}var A_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x_=Object.assign,R_={};function vo(t,e,n){this.props=t,this.context=e,this.refs=R_,this.updater=n||A_}vo.prototype.isReactComponent={};vo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function P_(){}P_.prototype=vo.prototype;function ff(t,e,n){this.props=t,this.context=e,this.refs=R_,this.updater=n||A_}var pf=ff.prototype=new P_;pf.constructor=ff;x_(pf,vo.prototype);pf.isPureReactComponent=!0;var $m=Array.isArray,C_=Object.prototype.hasOwnProperty,mf={current:null},k_={key:!0,ref:!0,__self:!0,__source:!0};function V_(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)C_.call(e,r)&&!k_.hasOwnProperty(r)&&(i[r]=e[r]);var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)i[r]===void 0&&(i[r]=l[r]);return{$$typeof:tl,type:t,key:s,ref:o,props:i,_owner:mf.current}}function qT(t,e){return{$$typeof:tl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function gf(t){return typeof t=="object"&&t!==null&&t.$$typeof===tl}function KT(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var qm=/\/+/g;function dh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?KT(""+t.key):e.toString(36)}function ou(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case tl:case NT:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+dh(o,0):r,$m(i)?(n="",t!=null&&(n=t.replace(qm,"$&/")+"/"),ou(i,e,n,"",function(c){return c})):i!=null&&(gf(i)&&(i=qT(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(qm,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",$m(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+dh(s,l);o+=ou(s,e,n,u,i)}else if(u=$T(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+dh(s,l++),o+=ou(s,e,n,u,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ol(t,e,n){if(t==null)return t;var r=[],i=0;return ou(t,r,"","",function(s){return e.call(n,s,i++)}),r}function GT(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Wt={current:null},au={transition:null},QT={ReactCurrentDispatcher:Wt,ReactCurrentBatchConfig:au,ReactCurrentOwner:mf};function D_(){throw Error("act(...) is not supported in production builds of React.")}me.Children={map:Ol,forEach:function(t,e,n){Ol(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ol(t,function(){e++}),e},toArray:function(t){return Ol(t,function(e){return e})||[]},only:function(t){if(!gf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};me.Component=vo;me.Fragment=bT;me.Profiler=OT;me.PureComponent=ff;me.StrictMode=MT;me.Suspense=jT;me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=QT;me.act=D_;me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=x_({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=mf.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)C_.call(e,u)&&!k_.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:tl,type:t.type,key:i,ref:s,props:r,_owner:o}};me.createContext=function(t){return t={$$typeof:LT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:FT,_context:t},t.Consumer=t};me.createElement=V_;me.createFactory=function(t){var e=V_.bind(null,t);return e.type=t,e};me.createRef=function(){return{current:null}};me.forwardRef=function(t){return{$$typeof:BT,render:t}};me.isValidElement=gf;me.lazy=function(t){return{$$typeof:UT,_payload:{_status:-1,_result:t},_init:GT}};me.memo=function(t,e){return{$$typeof:zT,type:t,compare:e===void 0?null:e}};me.startTransition=function(t){var e=au.transition;au.transition={};try{t()}finally{au.transition=e}};me.unstable_act=D_;me.useCallback=function(t,e){return Wt.current.useCallback(t,e)};me.useContext=function(t){return Wt.current.useContext(t)};me.useDebugValue=function(){};me.useDeferredValue=function(t){return Wt.current.useDeferredValue(t)};me.useEffect=function(t,e){return Wt.current.useEffect(t,e)};me.useId=function(){return Wt.current.useId()};me.useImperativeHandle=function(t,e,n){return Wt.current.useImperativeHandle(t,e,n)};me.useInsertionEffect=function(t,e){return Wt.current.useInsertionEffect(t,e)};me.useLayoutEffect=function(t,e){return Wt.current.useLayoutEffect(t,e)};me.useMemo=function(t,e){return Wt.current.useMemo(t,e)};me.useReducer=function(t,e,n){return Wt.current.useReducer(t,e,n)};me.useRef=function(t){return Wt.current.useRef(t)};me.useState=function(t){return Wt.current.useState(t)};me.useSyncExternalStore=function(t,e,n){return Wt.current.useSyncExternalStore(t,e,n)};me.useTransition=function(){return Wt.current.useTransition()};me.version="18.3.1";S_.exports=me;var q=S_.exports;const WT=DT(q);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HT=q,YT=Symbol.for("react.element"),XT=Symbol.for("react.fragment"),JT=Object.prototype.hasOwnProperty,ZT=HT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eI={key:!0,ref:!0,__self:!0,__source:!0};function N_(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)JT.call(e,r)&&!eI.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:YT,type:t,key:s,ref:o,props:i,_owner:ZT.current}}mc.Fragment=XT;mc.jsx=N_;mc.jsxs=N_;I_.exports=mc;var k=I_.exports,Wh={},b_={exports:{}},pn={},M_={exports:{}},O_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,re){var ae=G.length;G.push(re);e:for(;0<ae;){var Ae=ae-1>>>1,ve=G[Ae];if(0<i(ve,re))G[Ae]=re,G[ae]=ve,ae=Ae;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var re=G[0],ae=G.pop();if(ae!==re){G[0]=ae;e:for(var Ae=0,ve=G.length,Pe=ve>>>1;Ae<Pe;){var et=2*(Ae+1)-1,tt=G[et],_e=et+1,ue=G[_e];if(0>i(tt,ae))_e<ve&&0>i(ue,tt)?(G[Ae]=ue,G[_e]=ae,Ae=_e):(G[Ae]=tt,G[et]=ae,Ae=et);else if(_e<ve&&0>i(ue,ae))G[Ae]=ue,G[_e]=ae,Ae=_e;else break e}}return re}function i(G,re){var ae=G.sortIndex-re.sortIndex;return ae!==0?ae:G.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],c=[],d=1,p=null,m=3,I=!1,R=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(G){for(var re=n(c);re!==null;){if(re.callback===null)r(c);else if(re.startTime<=G)r(c),re.sortIndex=re.expirationTime,e(u,re);else break;re=n(c)}}function O(G){if(C=!1,E(G),!R)if(n(u)!==null)R=!0,gn(U);else{var re=n(c);re!==null&&he(O,re.startTime-G)}}function U(G,re){R=!1,C&&(C=!1,_(y),y=-1),I=!0;var ae=m;try{for(E(re),p=n(u);p!==null&&(!(p.expirationTime>re)||G&&!x());){var Ae=p.callback;if(typeof Ae=="function"){p.callback=null,m=p.priorityLevel;var ve=Ae(p.expirationTime<=re);re=t.unstable_now(),typeof ve=="function"?p.callback=ve:p===n(u)&&r(u),E(re)}else r(u);p=n(u)}if(p!==null)var Pe=!0;else{var et=n(c);et!==null&&he(O,et.startTime-re),Pe=!1}return Pe}finally{p=null,m=ae,I=!1}}var B=!1,w=null,y=-1,T=5,A=-1;function x(){return!(t.unstable_now()-A<T)}function V(){if(w!==null){var G=t.unstable_now();A=G;var re=!0;try{re=w(!0,G)}finally{re?S():(B=!1,w=null)}}else B=!1}var S;if(typeof v=="function")S=function(){v(V)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,oe=be.port2;be.port1.onmessage=V,S=function(){oe.postMessage(null)}}else S=function(){M(V,0)};function gn(G){w=G,B||(B=!0,S())}function he(G,re){y=M(function(){G(t.unstable_now())},re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){R||I||(R=!0,gn(U))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(G){switch(m){case 1:case 2:case 3:var re=3;break;default:re=m}var ae=m;m=re;try{return G()}finally{m=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,re){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var ae=m;m=G;try{return re()}finally{m=ae}},t.unstable_scheduleCallback=function(G,re,ae){var Ae=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Ae+ae:Ae):ae=Ae,G){case 1:var ve=-1;break;case 2:ve=250;break;case 5:ve=1073741823;break;case 4:ve=1e4;break;default:ve=5e3}return ve=ae+ve,G={id:d++,callback:re,priorityLevel:G,startTime:ae,expirationTime:ve,sortIndex:-1},ae>Ae?(G.sortIndex=ae,e(c,G),n(u)===null&&G===n(c)&&(C?(_(y),y=-1):C=!0,he(O,ae-Ae))):(G.sortIndex=ve,e(u,G),R||I||(R=!0,gn(U))),G},t.unstable_shouldYield=x,t.unstable_wrapCallback=function(G){var re=m;return function(){var ae=m;m=re;try{return G.apply(this,arguments)}finally{m=ae}}}})(O_);M_.exports=O_;var tI=M_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nI=q,dn=tI;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var F_=new Set,Aa={};function is(t,e){Hs(t,e),Hs(t+"Capture",e)}function Hs(t,e){for(Aa[t]=e,t=0;t<e.length;t++)F_.add(e[t])}var ur=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hh=Object.prototype.hasOwnProperty,rI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Km={},Gm={};function iI(t){return Hh.call(Gm,t)?!0:Hh.call(Km,t)?!1:rI.test(t)?Gm[t]=!0:(Km[t]=!0,!1)}function sI(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function oI(t,e,n,r){if(e===null||typeof e>"u"||sI(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ht(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kt[t]=new Ht(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];kt[e]=new Ht(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kt[t]=new Ht(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kt[t]=new Ht(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kt[t]=new Ht(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kt[t]=new Ht(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kt[t]=new Ht(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kt[t]=new Ht(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kt[t]=new Ht(t,5,!1,t.toLowerCase(),null,!1,!1)});var yf=/[\-:]([a-z])/g;function _f(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(yf,_f);kt[e]=new Ht(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(yf,_f);kt[e]=new Ht(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(yf,_f);kt[e]=new Ht(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kt[t]=new Ht(t,1,!1,t.toLowerCase(),null,!1,!1)});kt.xlinkHref=new Ht("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kt[t]=new Ht(t,1,!1,t.toLowerCase(),null,!0,!0)});function vf(t,e,n,r){var i=kt.hasOwnProperty(e)?kt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(oI(e,n,i,r)&&(n=null),r||i===null?iI(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var gr=nI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fl=Symbol.for("react.element"),Ps=Symbol.for("react.portal"),Cs=Symbol.for("react.fragment"),wf=Symbol.for("react.strict_mode"),Yh=Symbol.for("react.profiler"),L_=Symbol.for("react.provider"),B_=Symbol.for("react.context"),Ef=Symbol.for("react.forward_ref"),Xh=Symbol.for("react.suspense"),Jh=Symbol.for("react.suspense_list"),Tf=Symbol.for("react.memo"),Vr=Symbol.for("react.lazy"),j_=Symbol.for("react.offscreen"),Qm=Symbol.iterator;function qo(t){return t===null||typeof t!="object"?null:(t=Qm&&t[Qm]||t["@@iterator"],typeof t=="function"?t:null)}var Je=Object.assign,fh;function ra(t){if(fh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fh=e&&e[1]||""}return`
`+fh+t}var ph=!1;function mh(t,e){if(!t||ph)return"";ph=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,l=s.length-1;1<=o&&0<=l&&i[o]!==s[l];)l--;for(;1<=o&&0<=l;o--,l--)if(i[o]!==s[l]){if(o!==1||l!==1)do if(o--,l--,0>l||i[o]!==s[l]){var u=`
`+i[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{ph=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?ra(t):""}function aI(t){switch(t.tag){case 5:return ra(t.type);case 16:return ra("Lazy");case 13:return ra("Suspense");case 19:return ra("SuspenseList");case 0:case 2:case 15:return t=mh(t.type,!1),t;case 11:return t=mh(t.type.render,!1),t;case 1:return t=mh(t.type,!0),t;default:return""}}function Zh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Cs:return"Fragment";case Ps:return"Portal";case Yh:return"Profiler";case wf:return"StrictMode";case Xh:return"Suspense";case Jh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case B_:return(t.displayName||"Context")+".Consumer";case L_:return(t._context.displayName||"Context")+".Provider";case Ef:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Tf:return e=t.displayName||null,e!==null?e:Zh(t.type)||"Memo";case Vr:e=t._payload,t=t._init;try{return Zh(t(e))}catch{}}return null}function lI(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zh(e);case 8:return e===wf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function z_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function uI(t){var e=z_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ll(t){t._valueTracker||(t._valueTracker=uI(t))}function U_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=z_(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Ru(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function ed(t,e){var n=e.checked;return Je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Wm(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function $_(t,e){e=e.checked,e!=null&&vf(t,"checked",e,!1)}function td(t,e){$_(t,e);var n=Xr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?nd(t,e.type,n):e.hasOwnProperty("defaultValue")&&nd(t,e.type,Xr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Hm(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function nd(t,e,n){(e!=="number"||Ru(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ia=Array.isArray;function js(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xr(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function rd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return Je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ym(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error($(92));if(ia(n)){if(1<n.length)throw Error($(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xr(n)}}function q_(t,e){var n=Xr(e.value),r=Xr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Xm(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function K_(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function id(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?K_(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bl,G_=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bl=Bl||document.createElement("div"),Bl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function xa(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ha={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cI=["Webkit","ms","Moz","O"];Object.keys(ha).forEach(function(t){cI.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ha[e]=ha[t]})});function Q_(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ha.hasOwnProperty(t)&&ha[t]?(""+e).trim():e+"px"}function W_(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=Q_(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var hI=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sd(t,e){if(e){if(hI[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function od(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ad=null;function If(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ld=null,zs=null,Us=null;function Jm(t){if(t=il(t)){if(typeof ld!="function")throw Error($(280));var e=t.stateNode;e&&(e=wc(e),ld(t.stateNode,t.type,e))}}function H_(t){zs?Us?Us.push(t):Us=[t]:zs=t}function Y_(){if(zs){var t=zs,e=Us;if(Us=zs=null,Jm(t),e)for(t=0;t<e.length;t++)Jm(e[t])}}function X_(t,e){return t(e)}function J_(){}var gh=!1;function Z_(t,e,n){if(gh)return t(e,n);gh=!0;try{return X_(t,e,n)}finally{gh=!1,(zs!==null||Us!==null)&&(J_(),Y_())}}function Ra(t,e){var n=t.stateNode;if(n===null)return null;var r=wc(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error($(231,e,typeof n));return n}var ud=!1;if(ur)try{var Ko={};Object.defineProperty(Ko,"passive",{get:function(){ud=!0}}),window.addEventListener("test",Ko,Ko),window.removeEventListener("test",Ko,Ko)}catch{ud=!1}function dI(t,e,n,r,i,s,o,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var da=!1,Pu=null,Cu=!1,cd=null,fI={onError:function(t){da=!0,Pu=t}};function pI(t,e,n,r,i,s,o,l,u){da=!1,Pu=null,dI.apply(fI,arguments)}function mI(t,e,n,r,i,s,o,l,u){if(pI.apply(this,arguments),da){if(da){var c=Pu;da=!1,Pu=null}else throw Error($(198));Cu||(Cu=!0,cd=c)}}function ss(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ev(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Zm(t){if(ss(t)!==t)throw Error($(188))}function gI(t){var e=t.alternate;if(!e){if(e=ss(t),e===null)throw Error($(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Zm(i),t;if(s===r)return Zm(i),e;s=s.sibling}throw Error($(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o){for(l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o)throw Error($(189))}}if(n.alternate!==r)throw Error($(190))}if(n.tag!==3)throw Error($(188));return n.stateNode.current===n?t:e}function tv(t){return t=gI(t),t!==null?nv(t):null}function nv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nv(t);if(e!==null)return e;t=t.sibling}return null}var rv=dn.unstable_scheduleCallback,eg=dn.unstable_cancelCallback,yI=dn.unstable_shouldYield,_I=dn.unstable_requestPaint,ot=dn.unstable_now,vI=dn.unstable_getCurrentPriorityLevel,Sf=dn.unstable_ImmediatePriority,iv=dn.unstable_UserBlockingPriority,ku=dn.unstable_NormalPriority,wI=dn.unstable_LowPriority,sv=dn.unstable_IdlePriority,gc=null,Kn=null;function EI(t){if(Kn&&typeof Kn.onCommitFiberRoot=="function")try{Kn.onCommitFiberRoot(gc,t,void 0,(t.current.flags&128)===128)}catch{}}var Mn=Math.clz32?Math.clz32:SI,TI=Math.log,II=Math.LN2;function SI(t){return t>>>=0,t===0?32:31-(TI(t)/II|0)|0}var jl=64,zl=4194304;function sa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Vu(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~i;l!==0?r=sa(l):(s&=o,s!==0&&(r=sa(s)))}else o=n&~i,o!==0?r=sa(o):s!==0&&(r=sa(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Mn(e),i=1<<n,r|=t[n],e&=~i;return r}function AI(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xI(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Mn(s),l=1<<o,u=i[o];u===-1?(!(l&n)||l&r)&&(i[o]=AI(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function hd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ov(){var t=jl;return jl<<=1,!(jl&4194240)&&(jl=64),t}function yh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function nl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Mn(e),t[e]=n}function RI(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Mn(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Af(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Mn(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Re=0;function av(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var lv,xf,uv,cv,hv,dd=!1,Ul=[],zr=null,Ur=null,$r=null,Pa=new Map,Ca=new Map,Nr=[],PI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tg(t,e){switch(t){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":Ur=null;break;case"mouseover":case"mouseout":$r=null;break;case"pointerover":case"pointerout":Pa.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ca.delete(e.pointerId)}}function Go(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=il(e),e!==null&&xf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function CI(t,e,n,r,i){switch(e){case"focusin":return zr=Go(zr,t,e,n,r,i),!0;case"dragenter":return Ur=Go(Ur,t,e,n,r,i),!0;case"mouseover":return $r=Go($r,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Pa.set(s,Go(Pa.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Ca.set(s,Go(Ca.get(s)||null,t,e,n,r,i)),!0}return!1}function dv(t){var e=Mi(t.target);if(e!==null){var n=ss(e);if(n!==null){if(e=n.tag,e===13){if(e=ev(n),e!==null){t.blockedOn=e,hv(t.priority,function(){uv(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function lu(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=fd(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);ad=r,n.target.dispatchEvent(r),ad=null}else return e=il(n),e!==null&&xf(e),t.blockedOn=n,!1;e.shift()}return!0}function ng(t,e,n){lu(t)&&n.delete(e)}function kI(){dd=!1,zr!==null&&lu(zr)&&(zr=null),Ur!==null&&lu(Ur)&&(Ur=null),$r!==null&&lu($r)&&($r=null),Pa.forEach(ng),Ca.forEach(ng)}function Qo(t,e){t.blockedOn===e&&(t.blockedOn=null,dd||(dd=!0,dn.unstable_scheduleCallback(dn.unstable_NormalPriority,kI)))}function ka(t){function e(i){return Qo(i,t)}if(0<Ul.length){Qo(Ul[0],t);for(var n=1;n<Ul.length;n++){var r=Ul[n];r.blockedOn===t&&(r.blockedOn=null)}}for(zr!==null&&Qo(zr,t),Ur!==null&&Qo(Ur,t),$r!==null&&Qo($r,t),Pa.forEach(e),Ca.forEach(e),n=0;n<Nr.length;n++)r=Nr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Nr.length&&(n=Nr[0],n.blockedOn===null);)dv(n),n.blockedOn===null&&Nr.shift()}var $s=gr.ReactCurrentBatchConfig,Du=!0;function VI(t,e,n,r){var i=Re,s=$s.transition;$s.transition=null;try{Re=1,Rf(t,e,n,r)}finally{Re=i,$s.transition=s}}function DI(t,e,n,r){var i=Re,s=$s.transition;$s.transition=null;try{Re=4,Rf(t,e,n,r)}finally{Re=i,$s.transition=s}}function Rf(t,e,n,r){if(Du){var i=fd(t,e,n,r);if(i===null)Rh(t,e,r,Nu,n),tg(t,r);else if(CI(i,t,e,n,r))r.stopPropagation();else if(tg(t,r),e&4&&-1<PI.indexOf(t)){for(;i!==null;){var s=il(i);if(s!==null&&lv(s),s=fd(t,e,n,r),s===null&&Rh(t,e,r,Nu,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Rh(t,e,r,null,n)}}var Nu=null;function fd(t,e,n,r){if(Nu=null,t=If(r),t=Mi(t),t!==null)if(e=ss(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ev(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Nu=t,null}function fv(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vI()){case Sf:return 1;case iv:return 4;case ku:case wI:return 16;case sv:return 536870912;default:return 16}default:return 16}}var Lr=null,Pf=null,uu=null;function pv(){if(uu)return uu;var t,e=Pf,n=e.length,r,i="value"in Lr?Lr.value:Lr.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return uu=i.slice(t,1<r?1-r:void 0)}function cu(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $l(){return!0}function rg(){return!1}function mn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?$l:rg,this.isPropagationStopped=rg,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=$l)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=$l)},persist:function(){},isPersistent:$l}),e}var wo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cf=mn(wo),rl=Je({},wo,{view:0,detail:0}),NI=mn(rl),_h,vh,Wo,yc=Je({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wo&&(Wo&&t.type==="mousemove"?(_h=t.screenX-Wo.screenX,vh=t.screenY-Wo.screenY):vh=_h=0,Wo=t),_h)},movementY:function(t){return"movementY"in t?t.movementY:vh}}),ig=mn(yc),bI=Je({},yc,{dataTransfer:0}),MI=mn(bI),OI=Je({},rl,{relatedTarget:0}),wh=mn(OI),FI=Je({},wo,{animationName:0,elapsedTime:0,pseudoElement:0}),LI=mn(FI),BI=Je({},wo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),jI=mn(BI),zI=Je({},wo,{data:0}),sg=mn(zI),UI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$I={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function KI(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qI[t])?!!e[t]:!1}function kf(){return KI}var GI=Je({},rl,{key:function(t){if(t.key){var e=UI[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=cu(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?$I[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kf,charCode:function(t){return t.type==="keypress"?cu(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?cu(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),QI=mn(GI),WI=Je({},yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),og=mn(WI),HI=Je({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kf}),YI=mn(HI),XI=Je({},wo,{propertyName:0,elapsedTime:0,pseudoElement:0}),JI=mn(XI),ZI=Je({},yc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),e1=mn(ZI),t1=[9,13,27,32],Vf=ur&&"CompositionEvent"in window,fa=null;ur&&"documentMode"in document&&(fa=document.documentMode);var n1=ur&&"TextEvent"in window&&!fa,mv=ur&&(!Vf||fa&&8<fa&&11>=fa),ag=String.fromCharCode(32),lg=!1;function gv(t,e){switch(t){case"keyup":return t1.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yv(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ks=!1;function r1(t,e){switch(t){case"compositionend":return yv(e);case"keypress":return e.which!==32?null:(lg=!0,ag);case"textInput":return t=e.data,t===ag&&lg?null:t;default:return null}}function i1(t,e){if(ks)return t==="compositionend"||!Vf&&gv(t,e)?(t=pv(),uu=Pf=Lr=null,ks=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mv&&e.locale!=="ko"?null:e.data;default:return null}}var s1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ug(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!s1[t.type]:e==="textarea"}function _v(t,e,n,r){H_(r),e=bu(e,"onChange"),0<e.length&&(n=new Cf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var pa=null,Va=null;function o1(t){Cv(t,0)}function _c(t){var e=Ns(t);if(U_(e))return t}function a1(t,e){if(t==="change")return e}var vv=!1;if(ur){var Eh;if(ur){var Th="oninput"in document;if(!Th){var cg=document.createElement("div");cg.setAttribute("oninput","return;"),Th=typeof cg.oninput=="function"}Eh=Th}else Eh=!1;vv=Eh&&(!document.documentMode||9<document.documentMode)}function hg(){pa&&(pa.detachEvent("onpropertychange",wv),Va=pa=null)}function wv(t){if(t.propertyName==="value"&&_c(Va)){var e=[];_v(e,Va,t,If(t)),Z_(o1,e)}}function l1(t,e,n){t==="focusin"?(hg(),pa=e,Va=n,pa.attachEvent("onpropertychange",wv)):t==="focusout"&&hg()}function u1(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _c(Va)}function c1(t,e){if(t==="click")return _c(e)}function h1(t,e){if(t==="input"||t==="change")return _c(e)}function d1(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Fn=typeof Object.is=="function"?Object.is:d1;function Da(t,e){if(Fn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Hh.call(e,i)||!Fn(t[i],e[i]))return!1}return!0}function dg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function fg(t,e){var n=dg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=dg(n)}}function Ev(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ev(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Tv(){for(var t=window,e=Ru();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Ru(t.document)}return e}function Df(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function f1(t){var e=Tv(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ev(n.ownerDocument.documentElement,n)){if(r!==null&&Df(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=fg(n,s);var o=fg(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var p1=ur&&"documentMode"in document&&11>=document.documentMode,Vs=null,pd=null,ma=null,md=!1;function pg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;md||Vs==null||Vs!==Ru(r)||(r=Vs,"selectionStart"in r&&Df(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ma&&Da(ma,r)||(ma=r,r=bu(pd,"onSelect"),0<r.length&&(e=new Cf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vs)))}function ql(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ds={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionend:ql("Transition","TransitionEnd")},Ih={},Iv={};ur&&(Iv=document.createElement("div").style,"AnimationEvent"in window||(delete Ds.animationend.animation,delete Ds.animationiteration.animation,delete Ds.animationstart.animation),"TransitionEvent"in window||delete Ds.transitionend.transition);function vc(t){if(Ih[t])return Ih[t];if(!Ds[t])return t;var e=Ds[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Iv)return Ih[t]=e[n];return t}var Sv=vc("animationend"),Av=vc("animationiteration"),xv=vc("animationstart"),Rv=vc("transitionend"),Pv=new Map,mg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(t,e){Pv.set(t,e),is(e,[t])}for(var Sh=0;Sh<mg.length;Sh++){var Ah=mg[Sh],m1=Ah.toLowerCase(),g1=Ah[0].toUpperCase()+Ah.slice(1);oi(m1,"on"+g1)}oi(Sv,"onAnimationEnd");oi(Av,"onAnimationIteration");oi(xv,"onAnimationStart");oi("dblclick","onDoubleClick");oi("focusin","onFocus");oi("focusout","onBlur");oi(Rv,"onTransitionEnd");Hs("onMouseEnter",["mouseout","mouseover"]);Hs("onMouseLeave",["mouseout","mouseover"]);Hs("onPointerEnter",["pointerout","pointerover"]);Hs("onPointerLeave",["pointerout","pointerover"]);is("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));is("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));is("onBeforeInput",["compositionend","keypress","textInput","paste"]);is("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));is("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));is("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var oa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),y1=new Set("cancel close invalid load scroll toggle".split(" ").concat(oa));function gg(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,mI(r,e,void 0,t),t.currentTarget=null}function Cv(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==s&&i.isPropagationStopped())break e;gg(i,l,c),s=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,c=l.currentTarget,l=l.listener,u!==s&&i.isPropagationStopped())break e;gg(i,l,c),s=u}}}if(Cu)throw t=cd,Cu=!1,cd=null,t}function Oe(t,e){var n=e[wd];n===void 0&&(n=e[wd]=new Set);var r=t+"__bubble";n.has(r)||(kv(e,t,2,!1),n.add(r))}function xh(t,e,n){var r=0;e&&(r|=4),kv(n,t,r,e)}var Kl="_reactListening"+Math.random().toString(36).slice(2);function Na(t){if(!t[Kl]){t[Kl]=!0,F_.forEach(function(n){n!=="selectionchange"&&(y1.has(n)||xh(n,!1,t),xh(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Kl]||(e[Kl]=!0,xh("selectionchange",!1,e))}}function kv(t,e,n,r){switch(fv(e)){case 1:var i=VI;break;case 4:i=DI;break;default:i=Rf}n=i.bind(null,e,n,t),i=void 0,!ud||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Rh(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===i||l.nodeType===8&&l.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;o=o.return}for(;l!==null;){if(o=Mi(l),o===null)return;if(u=o.tag,u===5||u===6){r=s=o;continue e}l=l.parentNode}}r=r.return}Z_(function(){var c=s,d=If(n),p=[];e:{var m=Pv.get(t);if(m!==void 0){var I=Cf,R=t;switch(t){case"keypress":if(cu(n)===0)break e;case"keydown":case"keyup":I=QI;break;case"focusin":R="focus",I=wh;break;case"focusout":R="blur",I=wh;break;case"beforeblur":case"afterblur":I=wh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":I=ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":I=MI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":I=YI;break;case Sv:case Av:case xv:I=LI;break;case Rv:I=JI;break;case"scroll":I=NI;break;case"wheel":I=e1;break;case"copy":case"cut":case"paste":I=jI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":I=og}var C=(e&4)!==0,M=!C&&t==="scroll",_=C?m!==null?m+"Capture":null:m;C=[];for(var v=c,E;v!==null;){E=v;var O=E.stateNode;if(E.tag===5&&O!==null&&(E=O,_!==null&&(O=Ra(v,_),O!=null&&C.push(ba(v,O,E)))),M)break;v=v.return}0<C.length&&(m=new I(m,R,null,n,d),p.push({event:m,listeners:C}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",I=t==="mouseout"||t==="pointerout",m&&n!==ad&&(R=n.relatedTarget||n.fromElement)&&(Mi(R)||R[cr]))break e;if((I||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,I?(R=n.relatedTarget||n.toElement,I=c,R=R?Mi(R):null,R!==null&&(M=ss(R),R!==M||R.tag!==5&&R.tag!==6)&&(R=null)):(I=null,R=c),I!==R)){if(C=ig,O="onMouseLeave",_="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(C=og,O="onPointerLeave",_="onPointerEnter",v="pointer"),M=I==null?m:Ns(I),E=R==null?m:Ns(R),m=new C(O,v+"leave",I,n,d),m.target=M,m.relatedTarget=E,O=null,Mi(d)===c&&(C=new C(_,v+"enter",R,n,d),C.target=E,C.relatedTarget=M,O=C),M=O,I&&R)t:{for(C=I,_=R,v=0,E=C;E;E=vs(E))v++;for(E=0,O=_;O;O=vs(O))E++;for(;0<v-E;)C=vs(C),v--;for(;0<E-v;)_=vs(_),E--;for(;v--;){if(C===_||_!==null&&C===_.alternate)break t;C=vs(C),_=vs(_)}C=null}else C=null;I!==null&&yg(p,m,I,C,!1),R!==null&&M!==null&&yg(p,M,R,C,!0)}}e:{if(m=c?Ns(c):window,I=m.nodeName&&m.nodeName.toLowerCase(),I==="select"||I==="input"&&m.type==="file")var U=a1;else if(ug(m))if(vv)U=h1;else{U=u1;var B=l1}else(I=m.nodeName)&&I.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(U=c1);if(U&&(U=U(t,c))){_v(p,U,n,d);break e}B&&B(t,m,c),t==="focusout"&&(B=m._wrapperState)&&B.controlled&&m.type==="number"&&nd(m,"number",m.value)}switch(B=c?Ns(c):window,t){case"focusin":(ug(B)||B.contentEditable==="true")&&(Vs=B,pd=c,ma=null);break;case"focusout":ma=pd=Vs=null;break;case"mousedown":md=!0;break;case"contextmenu":case"mouseup":case"dragend":md=!1,pg(p,n,d);break;case"selectionchange":if(p1)break;case"keydown":case"keyup":pg(p,n,d)}var w;if(Vf)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else ks?gv(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(mv&&n.locale!=="ko"&&(ks||y!=="onCompositionStart"?y==="onCompositionEnd"&&ks&&(w=pv()):(Lr=d,Pf="value"in Lr?Lr.value:Lr.textContent,ks=!0)),B=bu(c,y),0<B.length&&(y=new sg(y,t,null,n,d),p.push({event:y,listeners:B}),w?y.data=w:(w=yv(n),w!==null&&(y.data=w)))),(w=n1?r1(t,n):i1(t,n))&&(c=bu(c,"onBeforeInput"),0<c.length&&(d=new sg("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:c}),d.data=w))}Cv(p,e)})}function ba(t,e,n){return{instance:t,listener:e,currentTarget:n}}function bu(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Ra(t,n),s!=null&&r.unshift(ba(t,s,i)),s=Ra(t,e),s!=null&&r.push(ba(t,s,i))),t=t.return}return r}function vs(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function yg(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,i?(u=Ra(n,s),u!=null&&o.unshift(ba(n,u,l))):i||(u=Ra(n,s),u!=null&&o.push(ba(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var _1=/\r\n?/g,v1=/\u0000|\uFFFD/g;function _g(t){return(typeof t=="string"?t:""+t).replace(_1,`
`).replace(v1,"")}function Gl(t,e,n){if(e=_g(e),_g(t)!==e&&n)throw Error($(425))}function Mu(){}var gd=null,yd=null;function _d(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vd=typeof setTimeout=="function"?setTimeout:void 0,w1=typeof clearTimeout=="function"?clearTimeout:void 0,vg=typeof Promise=="function"?Promise:void 0,E1=typeof queueMicrotask=="function"?queueMicrotask:typeof vg<"u"?function(t){return vg.resolve(null).then(t).catch(T1)}:vd;function T1(t){setTimeout(function(){throw t})}function Ph(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),ka(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);ka(e)}function qr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function wg(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Eo=Math.random().toString(36).slice(2),Un="__reactFiber$"+Eo,Ma="__reactProps$"+Eo,cr="__reactContainer$"+Eo,wd="__reactEvents$"+Eo,I1="__reactListeners$"+Eo,S1="__reactHandles$"+Eo;function Mi(t){var e=t[Un];if(e)return e;for(var n=t.parentNode;n;){if(e=n[cr]||n[Un]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=wg(t);t!==null;){if(n=t[Un])return n;t=wg(t)}return e}t=n,n=t.parentNode}return null}function il(t){return t=t[Un]||t[cr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ns(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function wc(t){return t[Ma]||null}var Ed=[],bs=-1;function ai(t){return{current:t}}function Le(t){0>bs||(t.current=Ed[bs],Ed[bs]=null,bs--)}function De(t,e){bs++,Ed[bs]=t.current,t.current=e}var Jr={},$t=ai(Jr),nn=ai(!1),$i=Jr;function Ys(t,e){var n=t.type.contextTypes;if(!n)return Jr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function rn(t){return t=t.childContextTypes,t!=null}function Ou(){Le(nn),Le($t)}function Eg(t,e,n){if($t.current!==Jr)throw Error($(168));De($t,e),De(nn,n)}function Vv(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error($(108,lI(t)||"Unknown",i));return Je({},n,r)}function Fu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Jr,$i=$t.current,De($t,t),De(nn,nn.current),!0}function Tg(t,e,n){var r=t.stateNode;if(!r)throw Error($(169));n?(t=Vv(t,e,$i),r.__reactInternalMemoizedMergedChildContext=t,Le(nn),Le($t),De($t,t)):Le(nn),De(nn,n)}var ir=null,Ec=!1,Ch=!1;function Dv(t){ir===null?ir=[t]:ir.push(t)}function A1(t){Ec=!0,Dv(t)}function li(){if(!Ch&&ir!==null){Ch=!0;var t=0,e=Re;try{var n=ir;for(Re=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ir=null,Ec=!1}catch(i){throw ir!==null&&(ir=ir.slice(t+1)),rv(Sf,li),i}finally{Re=e,Ch=!1}}return null}var Ms=[],Os=0,Lu=null,Bu=0,_n=[],vn=0,qi=null,sr=1,or="";function Ri(t,e){Ms[Os++]=Bu,Ms[Os++]=Lu,Lu=t,Bu=e}function Nv(t,e,n){_n[vn++]=sr,_n[vn++]=or,_n[vn++]=qi,qi=t;var r=sr;t=or;var i=32-Mn(r)-1;r&=~(1<<i),n+=1;var s=32-Mn(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,sr=1<<32-Mn(e)+i|n<<i|r,or=s+t}else sr=1<<s|n<<i|r,or=t}function Nf(t){t.return!==null&&(Ri(t,1),Nv(t,1,0))}function bf(t){for(;t===Lu;)Lu=Ms[--Os],Ms[Os]=null,Bu=Ms[--Os],Ms[Os]=null;for(;t===qi;)qi=_n[--vn],_n[vn]=null,or=_n[--vn],_n[vn]=null,sr=_n[--vn],_n[vn]=null}var hn=null,cn=null,ze=!1,bn=null;function bv(t,e){var n=wn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ig(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hn=t,cn=qr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hn=t,cn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=qi!==null?{id:sr,overflow:or}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=wn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,hn=t,cn=null,!0):!1;default:return!1}}function Td(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Id(t){if(ze){var e=cn;if(e){var n=e;if(!Ig(t,e)){if(Td(t))throw Error($(418));e=qr(n.nextSibling);var r=hn;e&&Ig(t,e)?bv(r,n):(t.flags=t.flags&-4097|2,ze=!1,hn=t)}}else{if(Td(t))throw Error($(418));t.flags=t.flags&-4097|2,ze=!1,hn=t}}}function Sg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hn=t}function Ql(t){if(t!==hn)return!1;if(!ze)return Sg(t),ze=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!_d(t.type,t.memoizedProps)),e&&(e=cn)){if(Td(t))throw Mv(),Error($(418));for(;e;)bv(t,e),e=qr(e.nextSibling)}if(Sg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){cn=qr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}cn=null}}else cn=hn?qr(t.stateNode.nextSibling):null;return!0}function Mv(){for(var t=cn;t;)t=qr(t.nextSibling)}function Xs(){cn=hn=null,ze=!1}function Mf(t){bn===null?bn=[t]:bn.push(t)}var x1=gr.ReactCurrentBatchConfig;function Ho(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error($(309));var r=n.stateNode}if(!r)throw Error($(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var l=i.refs;o===null?delete l[s]:l[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error($(284));if(!n._owner)throw Error($(290,t))}return t}function Wl(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ag(t){var e=t._init;return e(t._payload)}function Ov(t){function e(_,v){if(t){var E=_.deletions;E===null?(_.deletions=[v],_.flags|=16):E.push(v)}}function n(_,v){if(!t)return null;for(;v!==null;)e(_,v),v=v.sibling;return null}function r(_,v){for(_=new Map;v!==null;)v.key!==null?_.set(v.key,v):_.set(v.index,v),v=v.sibling;return _}function i(_,v){return _=Wr(_,v),_.index=0,_.sibling=null,_}function s(_,v,E){return _.index=E,t?(E=_.alternate,E!==null?(E=E.index,E<v?(_.flags|=2,v):E):(_.flags|=2,v)):(_.flags|=1048576,v)}function o(_){return t&&_.alternate===null&&(_.flags|=2),_}function l(_,v,E,O){return v===null||v.tag!==6?(v=Oh(E,_.mode,O),v.return=_,v):(v=i(v,E),v.return=_,v)}function u(_,v,E,O){var U=E.type;return U===Cs?d(_,v,E.props.children,O,E.key):v!==null&&(v.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Vr&&Ag(U)===v.type)?(O=i(v,E.props),O.ref=Ho(_,v,E),O.return=_,O):(O=yu(E.type,E.key,E.props,null,_.mode,O),O.ref=Ho(_,v,E),O.return=_,O)}function c(_,v,E,O){return v===null||v.tag!==4||v.stateNode.containerInfo!==E.containerInfo||v.stateNode.implementation!==E.implementation?(v=Fh(E,_.mode,O),v.return=_,v):(v=i(v,E.children||[]),v.return=_,v)}function d(_,v,E,O,U){return v===null||v.tag!==7?(v=ji(E,_.mode,O,U),v.return=_,v):(v=i(v,E),v.return=_,v)}function p(_,v,E){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Oh(""+v,_.mode,E),v.return=_,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Fl:return E=yu(v.type,v.key,v.props,null,_.mode,E),E.ref=Ho(_,null,v),E.return=_,E;case Ps:return v=Fh(v,_.mode,E),v.return=_,v;case Vr:var O=v._init;return p(_,O(v._payload),E)}if(ia(v)||qo(v))return v=ji(v,_.mode,E,null),v.return=_,v;Wl(_,v)}return null}function m(_,v,E,O){var U=v!==null?v.key:null;if(typeof E=="string"&&E!==""||typeof E=="number")return U!==null?null:l(_,v,""+E,O);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Fl:return E.key===U?u(_,v,E,O):null;case Ps:return E.key===U?c(_,v,E,O):null;case Vr:return U=E._init,m(_,v,U(E._payload),O)}if(ia(E)||qo(E))return U!==null?null:d(_,v,E,O,null);Wl(_,E)}return null}function I(_,v,E,O,U){if(typeof O=="string"&&O!==""||typeof O=="number")return _=_.get(E)||null,l(v,_,""+O,U);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Fl:return _=_.get(O.key===null?E:O.key)||null,u(v,_,O,U);case Ps:return _=_.get(O.key===null?E:O.key)||null,c(v,_,O,U);case Vr:var B=O._init;return I(_,v,E,B(O._payload),U)}if(ia(O)||qo(O))return _=_.get(E)||null,d(v,_,O,U,null);Wl(v,O)}return null}function R(_,v,E,O){for(var U=null,B=null,w=v,y=v=0,T=null;w!==null&&y<E.length;y++){w.index>y?(T=w,w=null):T=w.sibling;var A=m(_,w,E[y],O);if(A===null){w===null&&(w=T);break}t&&w&&A.alternate===null&&e(_,w),v=s(A,v,y),B===null?U=A:B.sibling=A,B=A,w=T}if(y===E.length)return n(_,w),ze&&Ri(_,y),U;if(w===null){for(;y<E.length;y++)w=p(_,E[y],O),w!==null&&(v=s(w,v,y),B===null?U=w:B.sibling=w,B=w);return ze&&Ri(_,y),U}for(w=r(_,w);y<E.length;y++)T=I(w,_,y,E[y],O),T!==null&&(t&&T.alternate!==null&&w.delete(T.key===null?y:T.key),v=s(T,v,y),B===null?U=T:B.sibling=T,B=T);return t&&w.forEach(function(x){return e(_,x)}),ze&&Ri(_,y),U}function C(_,v,E,O){var U=qo(E);if(typeof U!="function")throw Error($(150));if(E=U.call(E),E==null)throw Error($(151));for(var B=U=null,w=v,y=v=0,T=null,A=E.next();w!==null&&!A.done;y++,A=E.next()){w.index>y?(T=w,w=null):T=w.sibling;var x=m(_,w,A.value,O);if(x===null){w===null&&(w=T);break}t&&w&&x.alternate===null&&e(_,w),v=s(x,v,y),B===null?U=x:B.sibling=x,B=x,w=T}if(A.done)return n(_,w),ze&&Ri(_,y),U;if(w===null){for(;!A.done;y++,A=E.next())A=p(_,A.value,O),A!==null&&(v=s(A,v,y),B===null?U=A:B.sibling=A,B=A);return ze&&Ri(_,y),U}for(w=r(_,w);!A.done;y++,A=E.next())A=I(w,_,y,A.value,O),A!==null&&(t&&A.alternate!==null&&w.delete(A.key===null?y:A.key),v=s(A,v,y),B===null?U=A:B.sibling=A,B=A);return t&&w.forEach(function(V){return e(_,V)}),ze&&Ri(_,y),U}function M(_,v,E,O){if(typeof E=="object"&&E!==null&&E.type===Cs&&E.key===null&&(E=E.props.children),typeof E=="object"&&E!==null){switch(E.$$typeof){case Fl:e:{for(var U=E.key,B=v;B!==null;){if(B.key===U){if(U=E.type,U===Cs){if(B.tag===7){n(_,B.sibling),v=i(B,E.props.children),v.return=_,_=v;break e}}else if(B.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===Vr&&Ag(U)===B.type){n(_,B.sibling),v=i(B,E.props),v.ref=Ho(_,B,E),v.return=_,_=v;break e}n(_,B);break}else e(_,B);B=B.sibling}E.type===Cs?(v=ji(E.props.children,_.mode,O,E.key),v.return=_,_=v):(O=yu(E.type,E.key,E.props,null,_.mode,O),O.ref=Ho(_,v,E),O.return=_,_=O)}return o(_);case Ps:e:{for(B=E.key;v!==null;){if(v.key===B)if(v.tag===4&&v.stateNode.containerInfo===E.containerInfo&&v.stateNode.implementation===E.implementation){n(_,v.sibling),v=i(v,E.children||[]),v.return=_,_=v;break e}else{n(_,v);break}else e(_,v);v=v.sibling}v=Fh(E,_.mode,O),v.return=_,_=v}return o(_);case Vr:return B=E._init,M(_,v,B(E._payload),O)}if(ia(E))return R(_,v,E,O);if(qo(E))return C(_,v,E,O);Wl(_,E)}return typeof E=="string"&&E!==""||typeof E=="number"?(E=""+E,v!==null&&v.tag===6?(n(_,v.sibling),v=i(v,E),v.return=_,_=v):(n(_,v),v=Oh(E,_.mode,O),v.return=_,_=v),o(_)):n(_,v)}return M}var Js=Ov(!0),Fv=Ov(!1),ju=ai(null),zu=null,Fs=null,Of=null;function Ff(){Of=Fs=zu=null}function Lf(t){var e=ju.current;Le(ju),t._currentValue=e}function Sd(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function qs(t,e){zu=t,Of=Fs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Jt=!0),t.firstContext=null)}function Tn(t){var e=t._currentValue;if(Of!==t)if(t={context:t,memoizedValue:e,next:null},Fs===null){if(zu===null)throw Error($(308));Fs=t,zu.dependencies={lanes:0,firstContext:t}}else Fs=Fs.next=t;return e}var Oi=null;function Bf(t){Oi===null?Oi=[t]:Oi.push(t)}function Lv(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Bf(e)):(n.next=i.next,i.next=n),e.interleaved=n,hr(t,r)}function hr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Dr=!1;function jf(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bv(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function lr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Kr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ie&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,hr(t,n)}return i=r.interleaved,i===null?(e.next=e,Bf(r)):(e.next=i.next,i.next=e),r.interleaved=e,hr(t,n)}function hu(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Af(t,n)}}function xg(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Uu(t,e,n,r){var i=t.updateQueue;Dr=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,l=i.shared.pending;if(l!==null){i.shared.pending=null;var u=l,c=u.next;u.next=null,o===null?s=c:o.next=c,o=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(s!==null){var p=i.baseState;o=0,d=c=u=null,l=s;do{var m=l.lane,I=l.eventTime;if((r&m)===m){d!==null&&(d=d.next={eventTime:I,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var R=t,C=l;switch(m=e,I=n,C.tag){case 1:if(R=C.payload,typeof R=="function"){p=R.call(I,p,m);break e}p=R;break e;case 3:R.flags=R.flags&-65537|128;case 0:if(R=C.payload,m=typeof R=="function"?R.call(I,p,m):R,m==null)break e;p=Je({},p,m);break e;case 2:Dr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=i.effects,m===null?i.effects=[l]:m.push(l))}else I={eventTime:I,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=I,u=p):d=d.next=I,o|=m;if(l=l.next,l===null){if(l=i.shared.pending,l===null)break;m=l,l=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);if(d===null&&(u=p),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Gi|=o,t.lanes=o,t.memoizedState=p}}function Rg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error($(191,i));i.call(r)}}}var sl={},Gn=ai(sl),Oa=ai(sl),Fa=ai(sl);function Fi(t){if(t===sl)throw Error($(174));return t}function zf(t,e){switch(De(Fa,e),De(Oa,t),De(Gn,sl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:id(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=id(e,t)}Le(Gn),De(Gn,e)}function Zs(){Le(Gn),Le(Oa),Le(Fa)}function jv(t){Fi(Fa.current);var e=Fi(Gn.current),n=id(e,t.type);e!==n&&(De(Oa,t),De(Gn,n))}function Uf(t){Oa.current===t&&(Le(Gn),Le(Oa))}var He=ai(0);function $u(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var kh=[];function $f(){for(var t=0;t<kh.length;t++)kh[t]._workInProgressVersionPrimary=null;kh.length=0}var du=gr.ReactCurrentDispatcher,Vh=gr.ReactCurrentBatchConfig,Ki=0,Ye=null,pt=null,wt=null,qu=!1,ga=!1,La=0,R1=0;function Ot(){throw Error($(321))}function qf(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Fn(t[n],e[n]))return!1;return!0}function Kf(t,e,n,r,i,s){if(Ki=s,Ye=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,du.current=t===null||t.memoizedState===null?V1:D1,t=n(r,i),ga){s=0;do{if(ga=!1,La=0,25<=s)throw Error($(301));s+=1,wt=pt=null,e.updateQueue=null,du.current=N1,t=n(r,i)}while(ga)}if(du.current=Ku,e=pt!==null&&pt.next!==null,Ki=0,wt=pt=Ye=null,qu=!1,e)throw Error($(300));return t}function Gf(){var t=La!==0;return La=0,t}function zn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wt===null?Ye.memoizedState=wt=t:wt=wt.next=t,wt}function In(){if(pt===null){var t=Ye.alternate;t=t!==null?t.memoizedState:null}else t=pt.next;var e=wt===null?Ye.memoizedState:wt.next;if(e!==null)wt=e,pt=t;else{if(t===null)throw Error($(310));pt=t,t={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},wt===null?Ye.memoizedState=wt=t:wt=wt.next=t}return wt}function Ba(t,e){return typeof e=="function"?e(t):e}function Dh(t){var e=In(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=pt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var l=o=null,u=null,c=s;do{var d=c.lane;if((Ki&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var p={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,Ye.lanes|=d,Gi|=d}c=c.next}while(c!==null&&c!==s);u===null?o=r:u.next=l,Fn(r,e.memoizedState)||(Jt=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,Ye.lanes|=s,Gi|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Nh(t){var e=In(),n=e.queue;if(n===null)throw Error($(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Fn(s,e.memoizedState)||(Jt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function zv(){}function Uv(t,e){var n=Ye,r=In(),i=e(),s=!Fn(r.memoizedState,i);if(s&&(r.memoizedState=i,Jt=!0),r=r.queue,Qf(Kv.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||wt!==null&&wt.memoizedState.tag&1){if(n.flags|=2048,ja(9,qv.bind(null,n,r,i,e),void 0,null),Tt===null)throw Error($(349));Ki&30||$v(n,e,i)}return i}function $v(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function qv(t,e,n,r){e.value=n,e.getSnapshot=r,Gv(e)&&Qv(t)}function Kv(t,e,n){return n(function(){Gv(e)&&Qv(t)})}function Gv(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Fn(t,n)}catch{return!0}}function Qv(t){var e=hr(t,1);e!==null&&On(e,t,1,-1)}function Pg(t){var e=zn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ba,lastRenderedState:t},e.queue=t,t=t.dispatch=k1.bind(null,Ye,t),[e.memoizedState,t]}function ja(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ye.updateQueue,e===null?(e={lastEffect:null,stores:null},Ye.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Wv(){return In().memoizedState}function fu(t,e,n,r){var i=zn();Ye.flags|=t,i.memoizedState=ja(1|e,n,void 0,r===void 0?null:r)}function Tc(t,e,n,r){var i=In();r=r===void 0?null:r;var s=void 0;if(pt!==null){var o=pt.memoizedState;if(s=o.destroy,r!==null&&qf(r,o.deps)){i.memoizedState=ja(e,n,s,r);return}}Ye.flags|=t,i.memoizedState=ja(1|e,n,s,r)}function Cg(t,e){return fu(8390656,8,t,e)}function Qf(t,e){return Tc(2048,8,t,e)}function Hv(t,e){return Tc(4,2,t,e)}function Yv(t,e){return Tc(4,4,t,e)}function Xv(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Jv(t,e,n){return n=n!=null?n.concat([t]):null,Tc(4,4,Xv.bind(null,e,t),n)}function Wf(){}function Zv(t,e){var n=In();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qf(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function e0(t,e){var n=In();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&qf(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function t0(t,e,n){return Ki&21?(Fn(n,e)||(n=ov(),Ye.lanes|=n,Gi|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Jt=!0),t.memoizedState=n)}function P1(t,e){var n=Re;Re=n!==0&&4>n?n:4,t(!0);var r=Vh.transition;Vh.transition={};try{t(!1),e()}finally{Re=n,Vh.transition=r}}function n0(){return In().memoizedState}function C1(t,e,n){var r=Qr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},r0(t))i0(e,n);else if(n=Lv(t,e,n,r),n!==null){var i=Qt();On(n,t,r,i),s0(n,e,r)}}function k1(t,e,n){var r=Qr(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(r0(t))i0(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,l=s(o,n);if(i.hasEagerState=!0,i.eagerState=l,Fn(l,o)){var u=e.interleaved;u===null?(i.next=i,Bf(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=Lv(t,e,i,r),n!==null&&(i=Qt(),On(n,t,r,i),s0(n,e,r))}}function r0(t){var e=t.alternate;return t===Ye||e!==null&&e===Ye}function i0(t,e){ga=qu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function s0(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Af(t,n)}}var Ku={readContext:Tn,useCallback:Ot,useContext:Ot,useEffect:Ot,useImperativeHandle:Ot,useInsertionEffect:Ot,useLayoutEffect:Ot,useMemo:Ot,useReducer:Ot,useRef:Ot,useState:Ot,useDebugValue:Ot,useDeferredValue:Ot,useTransition:Ot,useMutableSource:Ot,useSyncExternalStore:Ot,useId:Ot,unstable_isNewReconciler:!1},V1={readContext:Tn,useCallback:function(t,e){return zn().memoizedState=[t,e===void 0?null:e],t},useContext:Tn,useEffect:Cg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,fu(4194308,4,Xv.bind(null,e,t),n)},useLayoutEffect:function(t,e){return fu(4194308,4,t,e)},useInsertionEffect:function(t,e){return fu(4,2,t,e)},useMemo:function(t,e){var n=zn();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=zn();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=C1.bind(null,Ye,t),[r.memoizedState,t]},useRef:function(t){var e=zn();return t={current:t},e.memoizedState=t},useState:Pg,useDebugValue:Wf,useDeferredValue:function(t){return zn().memoizedState=t},useTransition:function(){var t=Pg(!1),e=t[0];return t=P1.bind(null,t[1]),zn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ye,i=zn();if(ze){if(n===void 0)throw Error($(407));n=n()}else{if(n=e(),Tt===null)throw Error($(349));Ki&30||$v(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,Cg(Kv.bind(null,r,s,t),[t]),r.flags|=2048,ja(9,qv.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=zn(),e=Tt.identifierPrefix;if(ze){var n=or,r=sr;n=(r&~(1<<32-Mn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=La++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=R1++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},D1={readContext:Tn,useCallback:Zv,useContext:Tn,useEffect:Qf,useImperativeHandle:Jv,useInsertionEffect:Hv,useLayoutEffect:Yv,useMemo:e0,useReducer:Dh,useRef:Wv,useState:function(){return Dh(Ba)},useDebugValue:Wf,useDeferredValue:function(t){var e=In();return t0(e,pt.memoizedState,t)},useTransition:function(){var t=Dh(Ba)[0],e=In().memoizedState;return[t,e]},useMutableSource:zv,useSyncExternalStore:Uv,useId:n0,unstable_isNewReconciler:!1},N1={readContext:Tn,useCallback:Zv,useContext:Tn,useEffect:Qf,useImperativeHandle:Jv,useInsertionEffect:Hv,useLayoutEffect:Yv,useMemo:e0,useReducer:Nh,useRef:Wv,useState:function(){return Nh(Ba)},useDebugValue:Wf,useDeferredValue:function(t){var e=In();return pt===null?e.memoizedState=t:t0(e,pt.memoizedState,t)},useTransition:function(){var t=Nh(Ba)[0],e=In().memoizedState;return[t,e]},useMutableSource:zv,useSyncExternalStore:Uv,useId:n0,unstable_isNewReconciler:!1};function Dn(t,e){if(t&&t.defaultProps){e=Je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Ad(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ic={isMounted:function(t){return(t=t._reactInternals)?ss(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Qt(),i=Qr(t),s=lr(r,i);s.payload=e,n!=null&&(s.callback=n),e=Kr(t,s,i),e!==null&&(On(e,t,i,r),hu(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Qt(),i=Qr(t),s=lr(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Kr(t,s,i),e!==null&&(On(e,t,i,r),hu(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Qt(),r=Qr(t),i=lr(n,r);i.tag=2,e!=null&&(i.callback=e),e=Kr(t,i,r),e!==null&&(On(e,t,r,n),hu(e,t,r))}};function kg(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Da(n,r)||!Da(i,s):!0}function o0(t,e,n){var r=!1,i=Jr,s=e.contextType;return typeof s=="object"&&s!==null?s=Tn(s):(i=rn(e)?$i:$t.current,r=e.contextTypes,s=(r=r!=null)?Ys(t,i):Jr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ic,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function Vg(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ic.enqueueReplaceState(e,e.state,null)}function xd(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},jf(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Tn(s):(s=rn(e)?$i:$t.current,i.context=Ys(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Ad(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Ic.enqueueReplaceState(i,i.state,null),Uu(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function eo(t,e){try{var n="",r=e;do n+=aI(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function bh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Rd(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var b1=typeof WeakMap=="function"?WeakMap:Map;function a0(t,e,n){n=lr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qu||(Qu=!0,Fd=r),Rd(t,e)},n}function l0(t,e,n){n=lr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Rd(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Rd(t,e),typeof r!="function"&&(Gr===null?Gr=new Set([this]):Gr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Dg(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new b1;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=W1.bind(null,t,e,n),e.then(t,t))}function Ng(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function bg(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=lr(-1,1),e.tag=2,Kr(n,e,1))),n.lanes|=1),t)}var M1=gr.ReactCurrentOwner,Jt=!1;function Gt(t,e,n,r){e.child=t===null?Fv(e,null,n,r):Js(e,t.child,n,r)}function Mg(t,e,n,r,i){n=n.render;var s=e.ref;return qs(e,i),r=Kf(t,e,n,r,s,i),n=Gf(),t!==null&&!Jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,dr(t,e,i)):(ze&&n&&Nf(e),e.flags|=1,Gt(t,e,r,i),e.child)}function Og(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!np(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,u0(t,e,s,r,i)):(t=yu(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Da,n(o,r)&&t.ref===e.ref)return dr(t,e,i)}return e.flags|=1,t=Wr(s,r),t.ref=e.ref,t.return=e,e.child=t}function u0(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Da(s,r)&&t.ref===e.ref)if(Jt=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(Jt=!0);else return e.lanes=t.lanes,dr(t,e,i)}return Pd(t,e,n,r,i)}function c0(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(Bs,un),un|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,De(Bs,un),un|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,De(Bs,un),un|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,De(Bs,un),un|=r;return Gt(t,e,i,n),e.child}function h0(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Pd(t,e,n,r,i){var s=rn(n)?$i:$t.current;return s=Ys(e,s),qs(e,i),n=Kf(t,e,n,r,s,i),r=Gf(),t!==null&&!Jt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,dr(t,e,i)):(ze&&r&&Nf(e),e.flags|=1,Gt(t,e,n,i),e.child)}function Fg(t,e,n,r,i){if(rn(n)){var s=!0;Fu(e)}else s=!1;if(qs(e,i),e.stateNode===null)pu(t,e),o0(e,n,r),xd(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Tn(c):(c=rn(n)?$i:$t.current,c=Ys(e,c));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Vg(e,o,r,c),Dr=!1;var m=e.memoizedState;o.state=m,Uu(e,r,o,i),u=e.memoizedState,l!==r||m!==u||nn.current||Dr?(typeof d=="function"&&(Ad(e,n,d,r),u=e.memoizedState),(l=Dr||kg(e,n,l,r,m,u,c))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=c,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,Bv(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:Dn(e.type,l),o.props=c,p=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Tn(u):(u=rn(n)?$i:$t.current,u=Ys(e,u));var I=n.getDerivedStateFromProps;(d=typeof I=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||m!==u)&&Vg(e,o,r,u),Dr=!1,m=e.memoizedState,o.state=m,Uu(e,r,o,i);var R=e.memoizedState;l!==p||m!==R||nn.current||Dr?(typeof I=="function"&&(Ad(e,n,I,r),R=e.memoizedState),(c=Dr||kg(e,n,c,r,m,R,u)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,R,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,R,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=R),o.props=r,o.state=R,o.context=u,r=c):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Cd(t,e,n,r,s,i)}function Cd(t,e,n,r,i,s){h0(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&Tg(e,n,!1),dr(t,e,s);r=e.stateNode,M1.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Js(e,t.child,null,s),e.child=Js(e,null,l,s)):Gt(t,e,l,s),e.memoizedState=r.state,i&&Tg(e,n,!0),e.child}function d0(t){var e=t.stateNode;e.pendingContext?Eg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Eg(t,e.context,!1),zf(t,e.containerInfo)}function Lg(t,e,n,r,i){return Xs(),Mf(i),e.flags|=256,Gt(t,e,n,r),e.child}var kd={dehydrated:null,treeContext:null,retryLane:0};function Vd(t){return{baseLanes:t,cachePool:null,transitions:null}}function f0(t,e,n){var r=e.pendingProps,i=He.current,s=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(i&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),De(He,i&1),t===null)return Id(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=xc(o,r,0,null),t=ji(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Vd(n),e.memoizedState=kd,t):Hf(e,o));if(i=t.memoizedState,i!==null&&(l=i.dehydrated,l!==null))return O1(t,e,o,r,l,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,l=i.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Wr(i,u),r.subtreeFlags=i.subtreeFlags&14680064),l!==null?s=Wr(l,s):(s=ji(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Vd(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=kd,r}return s=t.child,t=s.sibling,r=Wr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hf(t,e){return e=xc({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Hl(t,e,n,r){return r!==null&&Mf(r),Js(e,t.child,null,n),t=Hf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function O1(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=bh(Error($(422))),Hl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=xc({mode:"visible",children:r.children},i,0,null),s=ji(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Js(e,t.child,null,o),e.child.memoizedState=Vd(o),e.memoizedState=kd,s);if(!(e.mode&1))return Hl(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error($(419)),r=bh(s,r,void 0),Hl(t,e,o,r)}if(l=(o&t.childLanes)!==0,Jt||l){if(r=Tt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,hr(t,i),On(r,t,i,-1))}return tp(),r=bh(Error($(421))),Hl(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=H1.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,cn=qr(i.nextSibling),hn=e,ze=!0,bn=null,t!==null&&(_n[vn++]=sr,_n[vn++]=or,_n[vn++]=qi,sr=t.id,or=t.overflow,qi=e),e=Hf(e,r.children),e.flags|=4096,e)}function Bg(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Sd(t.return,e,n)}function Mh(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function p0(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Gt(t,e,r.children,n),r=He.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Bg(t,n,e);else if(t.tag===19)Bg(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(De(He,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&$u(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Mh(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&$u(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Mh(e,!0,n,null,s);break;case"together":Mh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function pu(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function dr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Gi|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,n=Wr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Wr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function F1(t,e,n){switch(e.tag){case 3:d0(e),Xs();break;case 5:jv(e);break;case 1:rn(e.type)&&Fu(e);break;case 4:zf(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;De(ju,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(De(He,He.current&1),e.flags|=128,null):n&e.child.childLanes?f0(t,e,n):(De(He,He.current&1),t=dr(t,e,n),t!==null?t.sibling:null);De(He,He.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return p0(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),De(He,He.current),r)break;return null;case 22:case 23:return e.lanes=0,c0(t,e,n)}return dr(t,e,n)}var m0,Dd,g0,y0;m0=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Dd=function(){};g0=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Fi(Gn.current);var s=null;switch(n){case"input":i=ed(t,i),r=ed(t,r),s=[];break;case"select":i=Je({},i,{value:void 0}),r=Je({},r,{value:void 0}),s=[];break;case"textarea":i=rd(t,i),r=rd(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Mu)}sd(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var l=i[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Aa.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(l=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Aa.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&Oe("scroll",t),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};y0=function(t,e,n,r){n!==r&&(e.flags|=4)};function Yo(t,e){if(!ze)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function L1(t,e,n){var r=e.pendingProps;switch(bf(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return rn(e.type)&&Ou(),Ft(e),null;case 3:return r=e.stateNode,Zs(),Le(nn),Le($t),$f(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ql(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bn!==null&&(jd(bn),bn=null))),Dd(t,e),Ft(e),null;case 5:Uf(e);var i=Fi(Fa.current);if(n=e.type,t!==null&&e.stateNode!=null)g0(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error($(166));return Ft(e),null}if(t=Fi(Gn.current),Ql(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Un]=e,r[Ma]=s,t=(e.mode&1)!==0,n){case"dialog":Oe("cancel",r),Oe("close",r);break;case"iframe":case"object":case"embed":Oe("load",r);break;case"video":case"audio":for(i=0;i<oa.length;i++)Oe(oa[i],r);break;case"source":Oe("error",r);break;case"img":case"image":case"link":Oe("error",r),Oe("load",r);break;case"details":Oe("toggle",r);break;case"input":Wm(r,s),Oe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Oe("invalid",r);break;case"textarea":Ym(r,s),Oe("invalid",r)}sd(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var l=s[o];o==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Gl(r.textContent,l,t),i=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Gl(r.textContent,l,t),i=["children",""+l]):Aa.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Oe("scroll",r)}switch(n){case"input":Ll(r),Hm(r,s,!0);break;case"textarea":Ll(r),Xm(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Mu)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=K_(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Un]=e,t[Ma]=r,m0(t,e,!1,!1),e.stateNode=t;e:{switch(o=od(n,r),n){case"dialog":Oe("cancel",t),Oe("close",t),i=r;break;case"iframe":case"object":case"embed":Oe("load",t),i=r;break;case"video":case"audio":for(i=0;i<oa.length;i++)Oe(oa[i],t);i=r;break;case"source":Oe("error",t),i=r;break;case"img":case"image":case"link":Oe("error",t),Oe("load",t),i=r;break;case"details":Oe("toggle",t),i=r;break;case"input":Wm(t,r),i=ed(t,r),Oe("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=Je({},r,{value:void 0}),Oe("invalid",t);break;case"textarea":Ym(t,r),i=rd(t,r),Oe("invalid",t);break;default:i=r}sd(n,i),l=i;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?W_(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&G_(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&xa(t,u):typeof u=="number"&&xa(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Aa.hasOwnProperty(s)?u!=null&&s==="onScroll"&&Oe("scroll",t):u!=null&&vf(t,s,u,o))}switch(n){case"input":Ll(t),Hm(t,r,!1);break;case"textarea":Ll(t),Xm(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?js(t,!!r.multiple,s,!1):r.defaultValue!=null&&js(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Mu)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(t&&e.stateNode!=null)y0(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error($(166));if(n=Fi(Fa.current),Fi(Gn.current),Ql(e)){if(r=e.stateNode,n=e.memoizedProps,r[Un]=e,(s=r.nodeValue!==n)&&(t=hn,t!==null))switch(t.tag){case 3:Gl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gl(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Un]=e,e.stateNode=r}return Ft(e),null;case 13:if(Le(He),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ze&&cn!==null&&e.mode&1&&!(e.flags&128))Mv(),Xs(),e.flags|=98560,s=!1;else if(s=Ql(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error($(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error($(317));s[Un]=e}else Xs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),s=!1}else bn!==null&&(jd(bn),bn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||He.current&1?mt===0&&(mt=3):tp())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return Zs(),Dd(t,e),t===null&&Na(e.stateNode.containerInfo),Ft(e),null;case 10:return Lf(e.type._context),Ft(e),null;case 17:return rn(e.type)&&Ou(),Ft(e),null;case 19:if(Le(He),s=e.memoizedState,s===null)return Ft(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Yo(s,!1);else{if(mt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=$u(t),o!==null){for(e.flags|=128,Yo(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return De(He,He.current&1|2),e.child}t=t.sibling}s.tail!==null&&ot()>to&&(e.flags|=128,r=!0,Yo(s,!1),e.lanes=4194304)}else{if(!r)if(t=$u(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Yo(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ze)return Ft(e),null}else 2*ot()-s.renderingStartTime>to&&n!==1073741824&&(e.flags|=128,r=!0,Yo(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ot(),e.sibling=null,n=He.current,De(He,r?n&1|2:n&1),e):(Ft(e),null);case 22:case 23:return ep(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?un&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function B1(t,e){switch(bf(e),e.tag){case 1:return rn(e.type)&&Ou(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Zs(),Le(nn),Le($t),$f(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Uf(e),null;case 13:if(Le(He),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));Xs()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Le(He),null;case 4:return Zs(),null;case 10:return Lf(e.type._context),null;case 22:case 23:return ep(),null;case 24:return null;default:return null}}var Yl=!1,jt=!1,j1=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Ls(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){rt(t,e,r)}else n.current=null}function Nd(t,e,n){try{n()}catch(r){rt(t,e,r)}}var jg=!1;function z1(t,e){if(gd=Du,t=Tv(),Df(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,c=0,d=0,p=t,m=null;t:for(;;){for(var I;p!==n||i!==0&&p.nodeType!==3||(l=o+i),p!==s||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(I=p.firstChild)!==null;)m=p,p=I;for(;;){if(p===t)break t;if(m===n&&++c===i&&(l=o),m===s&&++d===r&&(u=o),(I=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=I}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(yd={focusedElem:t,selectionRange:n},Du=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var R=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(R!==null){var C=R.memoizedProps,M=R.memoizedState,_=e.stateNode,v=_.getSnapshotBeforeUpdate(e.elementType===e.type?C:Dn(e.type,C),M);_.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var E=e.stateNode.containerInfo;E.nodeType===1?E.textContent="":E.nodeType===9&&E.documentElement&&E.removeChild(E.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(O){rt(e,e.return,O)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return R=jg,jg=!1,R}function ya(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Nd(e,n,s)}i=i.next}while(i!==r)}}function Sc(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function bd(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function _0(t){var e=t.alternate;e!==null&&(t.alternate=null,_0(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Un],delete e[Ma],delete e[wd],delete e[I1],delete e[S1])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function v0(t){return t.tag===5||t.tag===3||t.tag===4}function zg(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||v0(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Md(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Mu));else if(r!==4&&(t=t.child,t!==null))for(Md(t,e,n),t=t.sibling;t!==null;)Md(t,e,n),t=t.sibling}function Od(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Od(t,e,n),t=t.sibling;t!==null;)Od(t,e,n),t=t.sibling}var xt=null,Nn=!1;function Pr(t,e,n){for(n=n.child;n!==null;)w0(t,e,n),n=n.sibling}function w0(t,e,n){if(Kn&&typeof Kn.onCommitFiberUnmount=="function")try{Kn.onCommitFiberUnmount(gc,n)}catch{}switch(n.tag){case 5:jt||Ls(n,e);case 6:var r=xt,i=Nn;xt=null,Pr(t,e,n),xt=r,Nn=i,xt!==null&&(Nn?(t=xt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):xt.removeChild(n.stateNode));break;case 18:xt!==null&&(Nn?(t=xt,n=n.stateNode,t.nodeType===8?Ph(t.parentNode,n):t.nodeType===1&&Ph(t,n),ka(t)):Ph(xt,n.stateNode));break;case 4:r=xt,i=Nn,xt=n.stateNode.containerInfo,Nn=!0,Pr(t,e,n),xt=r,Nn=i;break;case 0:case 11:case 14:case 15:if(!jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Nd(n,e,o),i=i.next}while(i!==r)}Pr(t,e,n);break;case 1:if(!jt&&(Ls(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){rt(n,e,l)}Pr(t,e,n);break;case 21:Pr(t,e,n);break;case 22:n.mode&1?(jt=(r=jt)||n.memoizedState!==null,Pr(t,e,n),jt=r):Pr(t,e,n);break;default:Pr(t,e,n)}}function Ug(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new j1),e.forEach(function(r){var i=Y1.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:xt=l.stateNode,Nn=!1;break e;case 3:xt=l.stateNode.containerInfo,Nn=!0;break e;case 4:xt=l.stateNode.containerInfo,Nn=!0;break e}l=l.return}if(xt===null)throw Error($(160));w0(s,o,i),xt=null,Nn=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(c){rt(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)E0(e,t),e=e.sibling}function E0(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),jn(t),r&4){try{ya(3,t,t.return),Sc(3,t)}catch(C){rt(t,t.return,C)}try{ya(5,t,t.return)}catch(C){rt(t,t.return,C)}}break;case 1:Vn(e,t),jn(t),r&512&&n!==null&&Ls(n,n.return);break;case 5:if(Vn(e,t),jn(t),r&512&&n!==null&&Ls(n,n.return),t.flags&32){var i=t.stateNode;try{xa(i,"")}catch(C){rt(t,t.return,C)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&$_(i,s),od(l,o);var c=od(l,s);for(o=0;o<u.length;o+=2){var d=u[o],p=u[o+1];d==="style"?W_(i,p):d==="dangerouslySetInnerHTML"?G_(i,p):d==="children"?xa(i,p):vf(i,d,p,c)}switch(l){case"input":td(i,s);break;case"textarea":q_(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var I=s.value;I!=null?js(i,!!s.multiple,I,!1):m!==!!s.multiple&&(s.defaultValue!=null?js(i,!!s.multiple,s.defaultValue,!0):js(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ma]=s}catch(C){rt(t,t.return,C)}}break;case 6:if(Vn(e,t),jn(t),r&4){if(t.stateNode===null)throw Error($(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(C){rt(t,t.return,C)}}break;case 3:if(Vn(e,t),jn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ka(e.containerInfo)}catch(C){rt(t,t.return,C)}break;case 4:Vn(e,t),jn(t);break;case 13:Vn(e,t),jn(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Jf=ot())),r&4&&Ug(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(jt=(c=jt)||d,Vn(e,t),jt=c):Vn(e,t),jn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(Z=t,d=t.child;d!==null;){for(p=Z=d;Z!==null;){switch(m=Z,I=m.child,m.tag){case 0:case 11:case 14:case 15:ya(4,m,m.return);break;case 1:Ls(m,m.return);var R=m.stateNode;if(typeof R.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,R.props=e.memoizedProps,R.state=e.memoizedState,R.componentWillUnmount()}catch(C){rt(r,n,C)}}break;case 5:Ls(m,m.return);break;case 22:if(m.memoizedState!==null){qg(p);continue}}I!==null?(I.return=m,Z=I):qg(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{i=p.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Q_("display",o))}catch(C){rt(t,t.return,C)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(C){rt(t,t.return,C)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Vn(e,t),jn(t),r&4&&Ug(t);break;case 21:break;default:Vn(e,t),jn(t)}}function jn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(v0(n)){var r=n;break e}n=n.return}throw Error($(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(xa(i,""),r.flags&=-33);var s=zg(t);Od(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,l=zg(t);Md(t,l,o);break;default:throw Error($(161))}}catch(u){rt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function U1(t,e,n){Z=t,T0(t)}function T0(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var i=Z,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Yl;if(!o){var l=i.alternate,u=l!==null&&l.memoizedState!==null||jt;l=Yl;var c=jt;if(Yl=o,(jt=u)&&!c)for(Z=i;Z!==null;)o=Z,u=o.child,o.tag===22&&o.memoizedState!==null?Kg(i):u!==null?(u.return=o,Z=u):Kg(i);for(;s!==null;)Z=s,T0(s),s=s.sibling;Z=i,Yl=l,jt=c}$g(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,Z=s):$g(t)}}function $g(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jt||Sc(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:Dn(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Rg(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Rg(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&ka(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}jt||e.flags&512&&bd(e)}catch(m){rt(e,e.return,m)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function qg(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Kg(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Sc(4,e)}catch(u){rt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){rt(e,i,u)}}var s=e.return;try{bd(e)}catch(u){rt(e,s,u)}break;case 5:var o=e.return;try{bd(e)}catch(u){rt(e,o,u)}}}catch(u){rt(e,e.return,u)}if(e===t){Z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Z=l;break}Z=e.return}}var $1=Math.ceil,Gu=gr.ReactCurrentDispatcher,Yf=gr.ReactCurrentOwner,En=gr.ReactCurrentBatchConfig,Ie=0,Tt=null,dt=null,Ct=0,un=0,Bs=ai(0),mt=0,za=null,Gi=0,Ac=0,Xf=0,_a=null,Xt=null,Jf=0,to=1/0,rr=null,Qu=!1,Fd=null,Gr=null,Xl=!1,Br=null,Wu=0,va=0,Ld=null,mu=-1,gu=0;function Qt(){return Ie&6?ot():mu!==-1?mu:mu=ot()}function Qr(t){return t.mode&1?Ie&2&&Ct!==0?Ct&-Ct:x1.transition!==null?(gu===0&&(gu=ov()),gu):(t=Re,t!==0||(t=window.event,t=t===void 0?16:fv(t.type)),t):1}function On(t,e,n,r){if(50<va)throw va=0,Ld=null,Error($(185));nl(t,n,r),(!(Ie&2)||t!==Tt)&&(t===Tt&&(!(Ie&2)&&(Ac|=n),mt===4&&br(t,Ct)),sn(t,r),n===1&&Ie===0&&!(e.mode&1)&&(to=ot()+500,Ec&&li()))}function sn(t,e){var n=t.callbackNode;xI(t,e);var r=Vu(t,t===Tt?Ct:0);if(r===0)n!==null&&eg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&eg(n),e===1)t.tag===0?A1(Gg.bind(null,t)):Dv(Gg.bind(null,t)),E1(function(){!(Ie&6)&&li()}),n=null;else{switch(av(r)){case 1:n=Sf;break;case 4:n=iv;break;case 16:n=ku;break;case 536870912:n=sv;break;default:n=ku}n=k0(n,I0.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function I0(t,e){if(mu=-1,gu=0,Ie&6)throw Error($(327));var n=t.callbackNode;if(Ks()&&t.callbackNode!==n)return null;var r=Vu(t,t===Tt?Ct:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hu(t,r);else{e=r;var i=Ie;Ie|=2;var s=A0();(Tt!==t||Ct!==e)&&(rr=null,to=ot()+500,Bi(t,e));do try{G1();break}catch(l){S0(t,l)}while(1);Ff(),Gu.current=s,Ie=i,dt!==null?e=0:(Tt=null,Ct=0,e=mt)}if(e!==0){if(e===2&&(i=hd(t),i!==0&&(r=i,e=Bd(t,i))),e===1)throw n=za,Bi(t,0),br(t,r),sn(t,ot()),n;if(e===6)br(t,r);else{if(i=t.current.alternate,!(r&30)&&!q1(i)&&(e=Hu(t,r),e===2&&(s=hd(t),s!==0&&(r=s,e=Bd(t,s))),e===1))throw n=za,Bi(t,0),br(t,r),sn(t,ot()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error($(345));case 2:Pi(t,Xt,rr);break;case 3:if(br(t,r),(r&130023424)===r&&(e=Jf+500-ot(),10<e)){if(Vu(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Qt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=vd(Pi.bind(null,t,Xt,rr),e);break}Pi(t,Xt,rr);break;case 4:if(br(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Mn(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ot()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*$1(r/1960))-r,10<r){t.timeoutHandle=vd(Pi.bind(null,t,Xt,rr),r);break}Pi(t,Xt,rr);break;case 5:Pi(t,Xt,rr);break;default:throw Error($(329))}}}return sn(t,ot()),t.callbackNode===n?I0.bind(null,t):null}function Bd(t,e){var n=_a;return t.current.memoizedState.isDehydrated&&(Bi(t,e).flags|=256),t=Hu(t,e),t!==2&&(e=Xt,Xt=n,e!==null&&jd(e)),t}function jd(t){Xt===null?Xt=t:Xt.push.apply(Xt,t)}function q1(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Fn(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function br(t,e){for(e&=~Xf,e&=~Ac,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Mn(e),r=1<<n;t[n]=-1,e&=~r}}function Gg(t){if(Ie&6)throw Error($(327));Ks();var e=Vu(t,0);if(!(e&1))return sn(t,ot()),null;var n=Hu(t,e);if(t.tag!==0&&n===2){var r=hd(t);r!==0&&(e=r,n=Bd(t,r))}if(n===1)throw n=za,Bi(t,0),br(t,e),sn(t,ot()),n;if(n===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Pi(t,Xt,rr),sn(t,ot()),null}function Zf(t,e){var n=Ie;Ie|=1;try{return t(e)}finally{Ie=n,Ie===0&&(to=ot()+500,Ec&&li())}}function Qi(t){Br!==null&&Br.tag===0&&!(Ie&6)&&Ks();var e=Ie;Ie|=1;var n=En.transition,r=Re;try{if(En.transition=null,Re=1,t)return t()}finally{Re=r,En.transition=n,Ie=e,!(Ie&6)&&li()}}function ep(){un=Bs.current,Le(Bs)}function Bi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,w1(n)),dt!==null)for(n=dt.return;n!==null;){var r=n;switch(bf(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ou();break;case 3:Zs(),Le(nn),Le($t),$f();break;case 5:Uf(r);break;case 4:Zs();break;case 13:Le(He);break;case 19:Le(He);break;case 10:Lf(r.type._context);break;case 22:case 23:ep()}n=n.return}if(Tt=t,dt=t=Wr(t.current,null),Ct=un=e,mt=0,za=null,Xf=Ac=Gi=0,Xt=_a=null,Oi!==null){for(e=0;e<Oi.length;e++)if(n=Oi[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Oi=null}return t}function S0(t,e){do{var n=dt;try{if(Ff(),du.current=Ku,qu){for(var r=Ye.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}qu=!1}if(Ki=0,wt=pt=Ye=null,ga=!1,La=0,Yf.current=null,n===null||n.return===null){mt=1,za=e,dt=null;break}e:{var s=t,o=n.return,l=n,u=e;if(e=Ct,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var I=Ng(o);if(I!==null){I.flags&=-257,bg(I,o,l,s,e),I.mode&1&&Dg(s,c,e),e=I,u=c;var R=e.updateQueue;if(R===null){var C=new Set;C.add(u),e.updateQueue=C}else R.add(u);break e}else{if(!(e&1)){Dg(s,c,e),tp();break e}u=Error($(426))}}else if(ze&&l.mode&1){var M=Ng(o);if(M!==null){!(M.flags&65536)&&(M.flags|=256),bg(M,o,l,s,e),Mf(eo(u,l));break e}}s=u=eo(u,l),mt!==4&&(mt=2),_a===null?_a=[s]:_a.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var _=a0(s,u,e);xg(s,_);break e;case 1:l=u;var v=s.type,E=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||E!==null&&typeof E.componentDidCatch=="function"&&(Gr===null||!Gr.has(E)))){s.flags|=65536,e&=-e,s.lanes|=e;var O=l0(s,l,e);xg(s,O);break e}}s=s.return}while(s!==null)}R0(n)}catch(U){e=U,dt===n&&n!==null&&(dt=n=n.return);continue}break}while(1)}function A0(){var t=Gu.current;return Gu.current=Ku,t===null?Ku:t}function tp(){(mt===0||mt===3||mt===2)&&(mt=4),Tt===null||!(Gi&268435455)&&!(Ac&268435455)||br(Tt,Ct)}function Hu(t,e){var n=Ie;Ie|=2;var r=A0();(Tt!==t||Ct!==e)&&(rr=null,Bi(t,e));do try{K1();break}catch(i){S0(t,i)}while(1);if(Ff(),Ie=n,Gu.current=r,dt!==null)throw Error($(261));return Tt=null,Ct=0,mt}function K1(){for(;dt!==null;)x0(dt)}function G1(){for(;dt!==null&&!yI();)x0(dt)}function x0(t){var e=C0(t.alternate,t,un);t.memoizedProps=t.pendingProps,e===null?R0(t):dt=e,Yf.current=null}function R0(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=B1(n,e),n!==null){n.flags&=32767,dt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{mt=6,dt=null;return}}else if(n=L1(n,e,un),n!==null){dt=n;return}if(e=e.sibling,e!==null){dt=e;return}dt=e=t}while(e!==null);mt===0&&(mt=5)}function Pi(t,e,n){var r=Re,i=En.transition;try{En.transition=null,Re=1,Q1(t,e,n,r)}finally{En.transition=i,Re=r}return null}function Q1(t,e,n,r){do Ks();while(Br!==null);if(Ie&6)throw Error($(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(RI(t,s),t===Tt&&(dt=Tt=null,Ct=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xl||(Xl=!0,k0(ku,function(){return Ks(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=En.transition,En.transition=null;var o=Re;Re=1;var l=Ie;Ie|=4,Yf.current=null,z1(t,n),E0(n,t),f1(yd),Du=!!gd,yd=gd=null,t.current=n,U1(n),_I(),Ie=l,Re=o,En.transition=s}else t.current=n;if(Xl&&(Xl=!1,Br=t,Wu=i),s=t.pendingLanes,s===0&&(Gr=null),EI(n.stateNode),sn(t,ot()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Qu)throw Qu=!1,t=Fd,Fd=null,t;return Wu&1&&t.tag!==0&&Ks(),s=t.pendingLanes,s&1?t===Ld?va++:(va=0,Ld=t):va=0,li(),null}function Ks(){if(Br!==null){var t=av(Wu),e=En.transition,n=Re;try{if(En.transition=null,Re=16>t?16:t,Br===null)var r=!1;else{if(t=Br,Br=null,Wu=0,Ie&6)throw Error($(331));var i=Ie;for(Ie|=4,Z=t.current;Z!==null;){var s=Z,o=s.child;if(Z.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(Z=c;Z!==null;){var d=Z;switch(d.tag){case 0:case 11:case 15:ya(8,d,s)}var p=d.child;if(p!==null)p.return=d,Z=p;else for(;Z!==null;){d=Z;var m=d.sibling,I=d.return;if(_0(d),d===c){Z=null;break}if(m!==null){m.return=I,Z=m;break}Z=I}}}var R=s.alternate;if(R!==null){var C=R.child;if(C!==null){R.child=null;do{var M=C.sibling;C.sibling=null,C=M}while(C!==null)}}Z=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,Z=o;else e:for(;Z!==null;){if(s=Z,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ya(9,s,s.return)}var _=s.sibling;if(_!==null){_.return=s.return,Z=_;break e}Z=s.return}}var v=t.current;for(Z=v;Z!==null;){o=Z;var E=o.child;if(o.subtreeFlags&2064&&E!==null)E.return=o,Z=E;else e:for(o=v;Z!==null;){if(l=Z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Sc(9,l)}}catch(U){rt(l,l.return,U)}if(l===o){Z=null;break e}var O=l.sibling;if(O!==null){O.return=l.return,Z=O;break e}Z=l.return}}if(Ie=i,li(),Kn&&typeof Kn.onPostCommitFiberRoot=="function")try{Kn.onPostCommitFiberRoot(gc,t)}catch{}r=!0}return r}finally{Re=n,En.transition=e}}return!1}function Qg(t,e,n){e=eo(n,e),e=a0(t,e,1),t=Kr(t,e,1),e=Qt(),t!==null&&(nl(t,1,e),sn(t,e))}function rt(t,e,n){if(t.tag===3)Qg(t,t,n);else for(;e!==null;){if(e.tag===3){Qg(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Gr===null||!Gr.has(r))){t=eo(n,t),t=l0(e,t,1),e=Kr(e,t,1),t=Qt(),e!==null&&(nl(e,1,t),sn(e,t));break}}e=e.return}}function W1(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Qt(),t.pingedLanes|=t.suspendedLanes&n,Tt===t&&(Ct&n)===n&&(mt===4||mt===3&&(Ct&130023424)===Ct&&500>ot()-Jf?Bi(t,0):Xf|=n),sn(t,e)}function P0(t,e){e===0&&(t.mode&1?(e=zl,zl<<=1,!(zl&130023424)&&(zl=4194304)):e=1);var n=Qt();t=hr(t,e),t!==null&&(nl(t,e,n),sn(t,n))}function H1(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),P0(t,n)}function Y1(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error($(314))}r!==null&&r.delete(e),P0(t,n)}var C0;C0=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||nn.current)Jt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Jt=!1,F1(t,e,n);Jt=!!(t.flags&131072)}else Jt=!1,ze&&e.flags&1048576&&Nv(e,Bu,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;pu(t,e),t=e.pendingProps;var i=Ys(e,$t.current);qs(e,n),i=Kf(null,e,r,t,i,n);var s=Gf();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,rn(r)?(s=!0,Fu(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,jf(e),i.updater=Ic,e.stateNode=i,i._reactInternals=e,xd(e,r,t,n),e=Cd(null,e,r,!0,s,n)):(e.tag=0,ze&&s&&Nf(e),Gt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(pu(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=J1(r),t=Dn(r,t),i){case 0:e=Pd(null,e,r,t,n);break e;case 1:e=Fg(null,e,r,t,n);break e;case 11:e=Mg(null,e,r,t,n);break e;case 14:e=Og(null,e,r,Dn(r.type,t),n);break e}throw Error($(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dn(r,i),Pd(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dn(r,i),Fg(t,e,r,i,n);case 3:e:{if(d0(e),t===null)throw Error($(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Bv(t,e),Uu(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=eo(Error($(423)),e),e=Lg(t,e,r,n,i);break e}else if(r!==i){i=eo(Error($(424)),e),e=Lg(t,e,r,n,i);break e}else for(cn=qr(e.stateNode.containerInfo.firstChild),hn=e,ze=!0,bn=null,n=Fv(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Xs(),r===i){e=dr(t,e,n);break e}Gt(t,e,r,n)}e=e.child}return e;case 5:return jv(e),t===null&&Id(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,_d(r,i)?o=null:s!==null&&_d(r,s)&&(e.flags|=32),h0(t,e),Gt(t,e,o,n),e.child;case 6:return t===null&&Id(e),null;case 13:return f0(t,e,n);case 4:return zf(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Js(e,null,r,n):Gt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dn(r,i),Mg(t,e,r,i,n);case 7:return Gt(t,e,e.pendingProps,n),e.child;case 8:return Gt(t,e,e.pendingProps.children,n),e.child;case 12:return Gt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,De(ju,r._currentValue),r._currentValue=o,s!==null)if(Fn(s.value,o)){if(s.children===i.children&&!nn.current){e=dr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){o=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=lr(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Sd(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error($(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Sd(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Gt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,qs(e,n),i=Tn(i),r=r(i),e.flags|=1,Gt(t,e,r,n),e.child;case 14:return r=e.type,i=Dn(r,e.pendingProps),i=Dn(r.type,i),Og(t,e,r,i,n);case 15:return u0(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:Dn(r,i),pu(t,e),e.tag=1,rn(r)?(t=!0,Fu(e)):t=!1,qs(e,n),o0(e,r,i),xd(e,r,i,n),Cd(null,e,r,!0,t,n);case 19:return p0(t,e,n);case 22:return c0(t,e,n)}throw Error($(156,e.tag))};function k0(t,e){return rv(t,e)}function X1(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wn(t,e,n,r){return new X1(t,e,n,r)}function np(t){return t=t.prototype,!(!t||!t.isReactComponent)}function J1(t){if(typeof t=="function")return np(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ef)return 11;if(t===Tf)return 14}return 2}function Wr(t,e){var n=t.alternate;return n===null?(n=wn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function yu(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")np(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Cs:return ji(n.children,i,s,e);case wf:o=8,i|=8;break;case Yh:return t=wn(12,n,e,i|2),t.elementType=Yh,t.lanes=s,t;case Xh:return t=wn(13,n,e,i),t.elementType=Xh,t.lanes=s,t;case Jh:return t=wn(19,n,e,i),t.elementType=Jh,t.lanes=s,t;case j_:return xc(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case L_:o=10;break e;case B_:o=9;break e;case Ef:o=11;break e;case Tf:o=14;break e;case Vr:o=16,r=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=wn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function ji(t,e,n,r){return t=wn(7,t,r,e),t.lanes=n,t}function xc(t,e,n,r){return t=wn(22,t,r,e),t.elementType=j_,t.lanes=n,t.stateNode={isHidden:!1},t}function Oh(t,e,n){return t=wn(6,t,null,e),t.lanes=n,t}function Fh(t,e,n){return e=wn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Z1(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yh(0),this.expirationTimes=yh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function rp(t,e,n,r,i,s,o,l,u){return t=new Z1(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=wn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},jf(s),t}function eS(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ps,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function V0(t){if(!t)return Jr;t=t._reactInternals;e:{if(ss(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(rn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var n=t.type;if(rn(n))return Vv(t,n,e)}return e}function D0(t,e,n,r,i,s,o,l,u){return t=rp(n,r,!0,t,i,s,o,l,u),t.context=V0(null),n=t.current,r=Qt(),i=Qr(n),s=lr(r,i),s.callback=e??null,Kr(n,s,i),t.current.lanes=i,nl(t,i,r),sn(t,r),t}function Rc(t,e,n,r){var i=e.current,s=Qt(),o=Qr(i);return n=V0(n),e.context===null?e.context=n:e.pendingContext=n,e=lr(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Kr(i,e,o),t!==null&&(On(t,i,o,s),hu(t,i,o)),o}function Yu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Wg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function ip(t,e){Wg(t,e),(t=t.alternate)&&Wg(t,e)}function tS(){return null}var N0=typeof reportError=="function"?reportError:function(t){console.error(t)};function sp(t){this._internalRoot=t}Pc.prototype.render=sp.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));Rc(t,e,null,null)};Pc.prototype.unmount=sp.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Qi(function(){Rc(null,t,null,null)}),e[cr]=null}};function Pc(t){this._internalRoot=t}Pc.prototype.unstable_scheduleHydration=function(t){if(t){var e=cv();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Nr.length&&e!==0&&e<Nr[n].priority;n++);Nr.splice(n,0,t),n===0&&dv(t)}};function op(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Hg(){}function nS(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=Yu(o);s.call(c)}}var o=D0(e,r,t,0,null,!1,!1,"",Hg);return t._reactRootContainer=o,t[cr]=o.current,Na(t.nodeType===8?t.parentNode:t),Qi(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var l=r;r=function(){var c=Yu(u);l.call(c)}}var u=rp(t,0,!1,null,null,!1,!1,"",Hg);return t._reactRootContainer=u,t[cr]=u.current,Na(t.nodeType===8?t.parentNode:t),Qi(function(){Rc(e,u,n,r)}),u}function kc(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var l=i;i=function(){var u=Yu(o);l.call(u)}}Rc(e,o,t,i)}else o=nS(n,e,t,i,r);return Yu(o)}lv=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=sa(e.pendingLanes);n!==0&&(Af(e,n|1),sn(e,ot()),!(Ie&6)&&(to=ot()+500,li()))}break;case 13:Qi(function(){var r=hr(t,1);if(r!==null){var i=Qt();On(r,t,1,i)}}),ip(t,1)}};xf=function(t){if(t.tag===13){var e=hr(t,134217728);if(e!==null){var n=Qt();On(e,t,134217728,n)}ip(t,134217728)}};uv=function(t){if(t.tag===13){var e=Qr(t),n=hr(t,e);if(n!==null){var r=Qt();On(n,t,e,r)}ip(t,e)}};cv=function(){return Re};hv=function(t,e){var n=Re;try{return Re=t,e()}finally{Re=n}};ld=function(t,e,n){switch(e){case"input":if(td(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=wc(r);if(!i)throw Error($(90));U_(r),td(r,i)}}}break;case"textarea":q_(t,n);break;case"select":e=n.value,e!=null&&js(t,!!n.multiple,e,!1)}};X_=Zf;J_=Qi;var rS={usingClientEntryPoint:!1,Events:[il,Ns,wc,H_,Y_,Zf]},Xo={findFiberByHostInstance:Mi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iS={bundleType:Xo.bundleType,version:Xo.version,rendererPackageName:Xo.rendererPackageName,rendererConfig:Xo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tv(t),t===null?null:t.stateNode},findFiberByHostInstance:Xo.findFiberByHostInstance||tS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jl.isDisabled&&Jl.supportsFiber)try{gc=Jl.inject(iS),Kn=Jl}catch{}}pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rS;pn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!op(e))throw Error($(200));return eS(t,e,null,n)};pn.createRoot=function(t,e){if(!op(t))throw Error($(299));var n=!1,r="",i=N0;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=rp(t,1,!1,null,null,n,!1,r,i),t[cr]=e.current,Na(t.nodeType===8?t.parentNode:t),new sp(e)};pn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=tv(e),t=t===null?null:t.stateNode,t};pn.flushSync=function(t){return Qi(t)};pn.hydrate=function(t,e,n){if(!Cc(e))throw Error($(200));return kc(null,t,e,!0,n)};pn.hydrateRoot=function(t,e,n){if(!op(t))throw Error($(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=N0;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=D0(e,null,t,1,n??null,i,!1,s,o),t[cr]=e.current,Na(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Pc(e)};pn.render=function(t,e,n){if(!Cc(e))throw Error($(200));return kc(null,t,e,!1,n)};pn.unmountComponentAtNode=function(t){if(!Cc(t))throw Error($(40));return t._reactRootContainer?(Qi(function(){kc(null,null,t,!1,function(){t._reactRootContainer=null,t[cr]=null})}),!0):!1};pn.unstable_batchedUpdates=Zf;pn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Cc(n))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return kc(t,e,n,!1,r)};pn.version="18.3.1-next-f1338f8080-20240426";function b0(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(b0)}catch(t){console.error(t)}}b0(),b_.exports=pn;var sS=b_.exports,Yg=sS;Wh.createRoot=Yg.createRoot,Wh.hydrateRoot=Yg.hydrateRoot;const oS=({onConsent:t,onDecline:e})=>k.jsxs("div",{className:"consent-container",children:[k.jsx("h1",{children:k.jsx("b",{children:k.jsx("u",{children:"Welcome"})})}),k.jsx("h2",{children:"but first, we need your consent to proceed..."}),k.jsx("hr",{}),k.jsxs("div",{className:"legal well",children:[k.jsx("p",{children:'We would like to invite you to take part in the following study named "Click Speed Study"'}),k.jsxs("p",{children:["This will take approximately XX minutes, and you will be compensated $X.XX upon completion.",k.jsx("br",{}),"Please understand that we ",k.jsx("em",{children:"reserve the right to not compensate entries"})," that fail to follow instructions."]}),k.jsx("div",{className:"consent-form",children:k.jsx("iframe",{frameBorder:"1",src:"https://drive.google.com/file/d/1_jkO8vZMrpOrZMgEhpZuFgGcBjGE72Yg/preview",title:"Consent Form"})})]}),k.jsx("h4",{children:'If you agree and consent to these terms, please click "I Agree" to continue.'}),k.jsxs("div",{className:"button-container",children:[k.jsx("button",{className:"btn btn-danger",onClick:e,children:"I do NOT consent"}),k.jsx("button",{className:"btn btn-primary",onClick:t,children:"I Agree"})]})]});function aS({onSubmit:t}){const[e,n]=q.useState({workerId:"",name:"",age:"",gender:"",handedness:"",repeat:"",ethnicity:"",race:""}),r=s=>{const{name:o,value:l}=s.target;n(u=>({...u,[o]:l}))},i=async s=>{s.preventDefault();try{t(e)}catch(o){console.error("Error handling form submission:",o)}};return k.jsxs("div",{className:"survey-container",children:[k.jsx("h1",{children:"Participant Information"}),k.jsxs("form",{onSubmit:i,children:[k.jsxs("div",{children:[k.jsx("label",{children:"Worker ID: "}),k.jsx("input",{type:"text",required:!0,name:"workerId",value:e.workerId,onChange:r})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Name: "}),k.jsx("input",{type:"text",required:!0,name:"name",value:e.name,onChange:r})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Age: "}),k.jsx("input",{type:"number",required:!0,name:"age",value:e.age,onChange:r})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Gender: "}),k.jsxs("select",{required:!0,name:"gender",value:e.gender,onChange:r,children:[k.jsx("option",{value:"",children:"Select an option"}),k.jsx("option",{value:"male",children:"Male"}),k.jsx("option",{value:"female",children:"Female"}),k.jsx("option",{value:"other",children:"Other"})]})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Handedness: "}),k.jsxs("select",{required:!0,name:"handedness",value:e.handedness,onChange:r,children:[k.jsx("option",{value:"",children:"Select an option"}),k.jsx("option",{value:"right",children:"Right Handed"}),k.jsx("option",{value:"left",children:"Left Handed"})]})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Have you done our experiments before? "}),k.jsxs("select",{required:!0,name:"repeat",value:e.repeat,onChange:r,children:[k.jsx("option",{value:"",children:"Select an option"}),k.jsx("option",{value:"yes",children:"Yes"}),k.jsx("option",{value:"no",children:"No"}),k.jsx("option",{value:"idk",children:"I don't remember"})]})]}),k.jsx("h2",{children:"Optional Information"}),k.jsxs("div",{children:[k.jsx("label",{children:"Ethnicity: "}),k.jsxs("select",{name:"ethnicity",value:e.ethnicity,onChange:r,children:[k.jsx("option",{value:"",children:"Select an option"}),k.jsx("option",{value:"hispanic",children:"Hispanic/Latinx"}),k.jsx("option",{value:"other",children:"Other"})]})]}),k.jsxs("div",{children:[k.jsx("label",{children:"Race: "}),k.jsxs("select",{name:"race",value:e.race,onChange:r,children:[k.jsx("option",{value:"",children:"Select an option"}),k.jsx("option",{value:"white",children:"White"}),k.jsx("option",{value:"black",children:"Black"}),k.jsx("option",{value:"asian",children:"Asian"}),k.jsx("option",{value:"native",children:"Native American"}),k.jsx("option",{value:"other",children:"Other"})]})]}),k.jsx("button",{type:"submit",className:"submit-button",children:"Submit"})]})]})}const lS=({onStart:t,onPractice:e,currentPage:n=0,setCurrentPage:r})=>{const[i,s]=q.useState(0),o=n!==void 0?n:i,l=r||s,u=[{title:"Game Overview",content:k.jsxs("div",{className:"instructions-content",children:[k.jsx("h2",{children:"Welcome to the Movement and Reward Game!"}),k.jsxs("p",{children:["You will play a game with ",k.jsx("strong",{children:"two phases"}),". Your goal is to earn as many points as possible by following the on-screen instructions."]}),k.jsxs("div",{className:"overview-phases",children:[k.jsxs("div",{className:"phase-preview",children:[k.jsx("h3",{children:"Phase 1: Movement Task"}),k.jsx("p",{children:"Move your cursor between bars at a steady pace"})]}),k.jsxs("div",{className:"phase-preview",children:[k.jsx("h3",{children:"Phase 2: Reward Collection"}),k.jsx("p",{children:"Press the keys in the sequence to collect your reward"})]})]}),k.jsx("p",{children:"Let's learn about each phase in detail..."})]})},{title:"Phase 1: Movement Task",content:k.jsxs("div",{className:"instructions-content",children:[k.jsx("h2",{children:"Movement Phase Details"}),k.jsx("div",{className:"phase-visual",children:k.jsxs("div",{className:"visual-description",children:[k.jsx("h3",{children:"What you'll see:"}),k.jsxs("ul",{children:[k.jsxs("li",{children:[k.jsx("strong",{children:"Blue bars"})," on the left and right sides of the screen"]}),k.jsxs("li",{children:["Your ",k.jsx("strong",{children:"score"})," will be displayed in the top right corner"]})]})]})}),k.jsx("h3",{children:"What to do:"}),k.jsxs("ul",{children:[k.jsxs("li",{children:[k.jsx("strong",{children:"Move your cursor"})," back and forth between the bars at a steady pace"]}),k.jsxs("li",{children:["The bars will turn ",k.jsx("strong",{children:"green"})," when you hover over them"]}),k.jsx("li",{children:"Keep moving at a steady pace - don't stay on one side too long!"}),k.jsxs("li",{children:["If you move too slowly, you'll see a ",k.jsx("strong",{children:'"Move Faster!"'})," warning"]})]})]})},{title:"Phase 2: Reward Collection",content:k.jsxs("div",{className:"instructions-content",children:[k.jsx("h2",{children:"Reward Collection Details"}),k.jsx("div",{className:"phase-visual",children:k.jsxs("div",{className:"visual-description",children:[k.jsx("h3",{children:"What happens:"}),k.jsxs("ul",{children:[k.jsxs("li",{children:["After an unknown amount of time, the ",k.jsx("strong",{children:"bars disappear"})]}),k.jsxs("li",{children:["An ",k.jsx("strong",{children:"item"})," appears in the center of the screen"]}),k.jsx("li",{children:"You will need to collect your reward"})]})]})}),k.jsx("h3",{children:"What to do:"}),k.jsxs("ul",{children:[k.jsxs("li",{children:["Follow the ",k.jsx("strong",{children:"key sequence"})," displayed on screen to collect the reward"]}),k.jsxs("li",{children:["Press the keys ",k.jsx("strong",{children:"A, S, D, F"})," in the exact order shown"]}),k.jsx("li",{children:"Watch as your progress is displayed with the sequence"}),k.jsx("li",{children:"Complete the entire sequence to receive your reward"})]})]})},{title:"Ready to Start?",content:k.jsxs("div",{className:"instructions-content",children:[k.jsx("h2",{children:"You're Ready to Start!"}),k.jsx("p",{children:"You now know everything you need to participate in the study. Remember: move between the bars, then collect the reward by following the key sequence."}),k.jsxs("div",{className:"final-reminder",children:[k.jsx("h3",{children:"Quick Reminder:"}),k.jsxs("ol",{children:[k.jsxs("li",{children:[k.jsx("strong",{children:"Phase 1:"})," Move cursor between blue bars"]}),k.jsxs("li",{children:[k.jsx("strong",{children:"Phase 2:"})," Follow the key sequence to collect the reward"]})]})]})]})}],c=()=>{o<u.length-1&&l(o+1)},d=()=>{o>0&&l(o-1)},p=o===u.length-1,m=o===0;return k.jsx("div",{className:"instructions-container",children:k.jsxs("div",{className:"instructions",children:[k.jsx("h1",{children:u[o].title}),k.jsxs("div",{className:"page-indicator",children:["Page ",o+1," of ",u.length]}),u[o].content,k.jsxs("div",{className:"navigation-container",children:[!p&&k.jsxs("div",{className:"page-navigation",children:[k.jsx("button",{onClick:d,className:"nav-button prev-button",disabled:m,children:" Previous"}),k.jsx("button",{onClick:c,className:"nav-button next-button",children:"Next "})]}),p&&k.jsxs("div",{className:"button-container",children:[k.jsx("button",{onClick:d,className:"nav-button prev-button",children:" Previous"}),k.jsx("button",{onClick:e,className:"practice-button",children:"Practice"}),k.jsx("button",{onClick:t,className:"start-button",children:"Start Game"})]})]})]})})},uS="modulepreload",cS=function(t){return"/"+t},Xg={},Jg=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(s=>{if(s=cS(s),s in Xg)return;Xg[s]=!0;const o=s.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=i.length-1;d>=0;d--){const p=i[d];if(p.href===s&&(!o||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${l}`))return;const c=document.createElement("link");if(c.rel=o?"stylesheet":uS,o||(c.as="script",c.crossOrigin=""),c.href=s,document.head.appendChild(c),o)return new Promise((d,p)=>{c.addEventListener("load",d),c.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s})};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M0=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},hS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],l=t[n++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},O0={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,l=o?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,d=s>>2,p=(s&3)<<4|l>>4;let m=(l&15)<<2|c>>6,I=c&63;u||(I=64,o||(m=64)),r.push(n[d],n[p],n[m],n[I])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(M0(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):hS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],l=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const p=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||l==null||c==null||p==null)throw new dS;const m=s<<2|l>>4;if(r.push(m),c!==64){const I=l<<4&240|c>>2;if(r.push(I),p!==64){const R=c<<6&192|p;r.push(R)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class dS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fS=function(t){const e=M0(t);return O0.encodeByteArray(e,!0)},Xu=function(t){return fS(t).replace(/\./g,"")},pS=function(t){try{return O0.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS=()=>mS().__FIREBASE_DEFAULTS__,yS=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},_S=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&pS(t[1]);return e&&JSON.parse(e)},ap=()=>{try{return gS()||yS()||_S()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},vS=t=>{var e,n;return(n=(e=ap())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},wS=t=>{const e=vS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},F0=()=>{var t;return(t=ap())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ES{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TS(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[Xu(JSON.stringify(n)),Xu(JSON.stringify(o)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function IS(){var t;const e=(t=ap())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function L0(){return!IS()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function B0(){try{return typeof indexedDB=="object"}catch{return!1}}function SS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AS="FirebaseError";class To extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=AS,Object.setPrototypeOf(this,To.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,j0.prototype.create)}}class j0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?xS(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new To(i,l,r)}}function xS(t,e){return t.replace(RS,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const RS=/\{\$([^}]+)}/g;function Wi(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Zg(s)&&Zg(o)){if(!Wi(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Zg(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(t){return t&&t._delegate?t._delegate:t}class Ua{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ci="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PS{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new ES;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(kS(e))try{this.getOrInitializeService({instanceIdentifier:Ci})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ci){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ci){return this.instances.has(e)}getOptions(e=Ci){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:CS(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ci){return this.component?this.component.multipleInstances?e:Ci:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function CS(t){return t===Ci?void 0:t}function kS(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new PS(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ee;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ee||(Ee={}));const DS={debug:Ee.DEBUG,verbose:Ee.VERBOSE,info:Ee.INFO,warn:Ee.WARN,error:Ee.ERROR,silent:Ee.SILENT},NS=Ee.INFO,bS={[Ee.DEBUG]:"log",[Ee.VERBOSE]:"log",[Ee.INFO]:"info",[Ee.WARN]:"warn",[Ee.ERROR]:"error"},MS=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=bS[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class z0{constructor(e){this.name=e,this._logLevel=NS,this._logHandler=MS,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ee))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?DS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ee.DEBUG,...e),this._logHandler(this,Ee.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ee.VERBOSE,...e),this._logHandler(this,Ee.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ee.INFO,...e),this._logHandler(this,Ee.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ee.WARN,...e),this._logHandler(this,Ee.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ee.ERROR,...e),this._logHandler(this,Ee.ERROR,...e)}}const OS=(t,e)=>e.some(n=>t instanceof n);let ey,ty;function FS(){return ey||(ey=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function LS(){return ty||(ty=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const U0=new WeakMap,zd=new WeakMap,$0=new WeakMap,Lh=new WeakMap,lp=new WeakMap;function BS(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(Hr(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&U0.set(n,t)}).catch(()=>{}),lp.set(e,t),e}function jS(t){if(zd.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});zd.set(t,e)}let Ud={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return zd.get(t);if(e==="objectStoreNames")return t.objectStoreNames||$0.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Hr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function zS(t){Ud=t(Ud)}function US(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Bh(this),e,...n);return $0.set(r,e.sort?e.sort():[e]),Hr(r)}:LS().includes(t)?function(...e){return t.apply(Bh(this),e),Hr(U0.get(this))}:function(...e){return Hr(t.apply(Bh(this),e))}}function $S(t){return typeof t=="function"?US(t):(t instanceof IDBTransaction&&jS(t),OS(t,FS())?new Proxy(t,Ud):t)}function Hr(t){if(t instanceof IDBRequest)return BS(t);if(Lh.has(t))return Lh.get(t);const e=$S(t);return e!==t&&(Lh.set(t,e),lp.set(e,t)),e}const Bh=t=>lp.get(t);function qS(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),l=Hr(o);return r&&o.addEventListener("upgradeneeded",u=>{r(Hr(o.result),u.oldVersion,u.newVersion,Hr(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),l}const KS=["get","getKey","getAll","getAllKeys","count"],GS=["put","add","delete","clear"],jh=new Map;function ny(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jh.get(e))return jh.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=GS.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||KS.includes(n)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let c=u.store;return r&&(c=c.index(l.shift())),(await Promise.all([c[n](...l),i&&u.done]))[0]};return jh.set(e,s),s}zS(t=>({...t,get:(e,n,r)=>ny(e,n)||t.get(e,n,r),has:(e,n)=>!!ny(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(WS(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function WS(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const $d="@firebase/app",ry="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fr=new z0("@firebase/app"),HS="@firebase/app-compat",YS="@firebase/analytics-compat",XS="@firebase/analytics",JS="@firebase/app-check-compat",ZS="@firebase/app-check",eA="@firebase/auth",tA="@firebase/auth-compat",nA="@firebase/database",rA="@firebase/data-connect",iA="@firebase/database-compat",sA="@firebase/functions",oA="@firebase/functions-compat",aA="@firebase/installations",lA="@firebase/installations-compat",uA="@firebase/messaging",cA="@firebase/messaging-compat",hA="@firebase/performance",dA="@firebase/performance-compat",fA="@firebase/remote-config",pA="@firebase/remote-config-compat",mA="@firebase/storage",gA="@firebase/storage-compat",yA="@firebase/firestore",_A="@firebase/vertexai-preview",vA="@firebase/firestore-compat",wA="firebase",EA="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zu="[DEFAULT]",TA={[$d]:"fire-core",[HS]:"fire-core-compat",[XS]:"fire-analytics",[YS]:"fire-analytics-compat",[ZS]:"fire-app-check",[JS]:"fire-app-check-compat",[eA]:"fire-auth",[tA]:"fire-auth-compat",[nA]:"fire-rtdb",[rA]:"fire-data-connect",[iA]:"fire-rtdb-compat",[sA]:"fire-fn",[oA]:"fire-fn-compat",[aA]:"fire-iid",[lA]:"fire-iid-compat",[uA]:"fire-fcm",[cA]:"fire-fcm-compat",[hA]:"fire-perf",[dA]:"fire-perf-compat",[fA]:"fire-rc",[pA]:"fire-rc-compat",[mA]:"fire-gcs",[gA]:"fire-gcs-compat",[yA]:"fire-fst",[vA]:"fire-fst-compat",[_A]:"fire-vertex","fire-js":"fire-js",[wA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ec=new Map,IA=new Map,qd=new Map;function iy(t,e){try{t.container.addComponent(e)}catch(n){fr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function tc(t){const e=t.name;if(qd.has(e))return fr.debug(`There were multiple attempts to register component ${e}.`),!1;qd.set(e,t);for(const n of ec.values())iy(n,t);for(const n of IA.values())iy(n,t);return!0}function up(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function SA(t,e,n=Zu){up(t,e).clearInstance(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Yr=new j0("app","Firebase",AA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xA{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ua("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Yr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RA=EA;function q0(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Zu,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Yr.create("bad-app-name",{appName:String(i)});if(n||(n=F0()),!n)throw Yr.create("no-options");const s=ec.get(i);if(s){if(Wi(n,s.options)&&Wi(r,s.config))return s;throw Yr.create("duplicate-app",{appName:i})}const o=new VS(i);for(const u of qd.values())o.addComponent(u);const l=new xA(n,r,o);return ec.set(i,l),l}function PA(t=Zu){const e=ec.get(t);if(!e&&t===Zu&&F0())return q0();if(!e)throw Yr.create("no-app",{appName:t});return e}function Gs(t,e,n){var r;let i=(r=TA[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fr.warn(l.join(" "));return}tc(new Ua(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA="firebase-heartbeat-database",kA=1,$a="firebase-heartbeat-store";let zh=null;function K0(){return zh||(zh=qS(CA,kA,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore($a)}catch(n){console.warn(n)}}}}).catch(t=>{throw Yr.create("idb-open",{originalErrorMessage:t.message})})),zh}async function VA(t){try{const n=(await K0()).transaction($a),r=await n.objectStore($a).get(G0(t));return await n.done,r}catch(e){if(e instanceof To)fr.warn(e.message);else{const n=Yr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fr.warn(n.message)}}}async function sy(t,e){try{const r=(await K0()).transaction($a,"readwrite");await r.objectStore($a).put(e,G0(t)),await r.done}catch(n){if(n instanceof To)fr.warn(n.message);else{const r=Yr.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});fr.warn(r.message)}}}function G0(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=1024,NA=30*24*60*60*1e3;class bA{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new OA(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=oy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=NA}),this._storage.overwrite(this._heartbeatsCache))}catch(r){fr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=oy(),{heartbeatsToSend:r,unsentEntries:i}=MA(this._heartbeatsCache.heartbeats),s=Xu(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return fr.warn(n),""}}}function oy(){return new Date().toISOString().substring(0,10)}function MA(t,e=DA){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),ay(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ay(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class OA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return B0()?SS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await VA(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return sy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return sy(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ay(t){return Xu(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FA(t){tc(new Ua("platform-logger",e=>new QS(e),"PRIVATE")),tc(new Ua("heartbeat",e=>new bA(e),"PRIVATE")),Gs($d,ry,t),Gs($d,ry,"esm2017"),Gs("fire-js","")}FA("");var LA="firebase",BA="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gs(LA,BA,"app");var ly=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zi,Q0;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(w,y){function T(){}T.prototype=y.prototype,w.D=y.prototype,w.prototype=new T,w.prototype.constructor=w,w.C=function(A,x,V){for(var S=Array(arguments.length-2),be=2;be<arguments.length;be++)S[be-2]=arguments[be];return y.prototype[x].apply(A,S)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,y,T){T||(T=0);var A=Array(16);if(typeof y=="string")for(var x=0;16>x;++x)A[x]=y.charCodeAt(T++)|y.charCodeAt(T++)<<8|y.charCodeAt(T++)<<16|y.charCodeAt(T++)<<24;else for(x=0;16>x;++x)A[x]=y[T++]|y[T++]<<8|y[T++]<<16|y[T++]<<24;y=w.g[0],T=w.g[1],x=w.g[2];var V=w.g[3],S=y+(V^T&(x^V))+A[0]+3614090360&4294967295;y=T+(S<<7&4294967295|S>>>25),S=V+(x^y&(T^x))+A[1]+3905402710&4294967295,V=y+(S<<12&4294967295|S>>>20),S=x+(T^V&(y^T))+A[2]+606105819&4294967295,x=V+(S<<17&4294967295|S>>>15),S=T+(y^x&(V^y))+A[3]+3250441966&4294967295,T=x+(S<<22&4294967295|S>>>10),S=y+(V^T&(x^V))+A[4]+4118548399&4294967295,y=T+(S<<7&4294967295|S>>>25),S=V+(x^y&(T^x))+A[5]+1200080426&4294967295,V=y+(S<<12&4294967295|S>>>20),S=x+(T^V&(y^T))+A[6]+2821735955&4294967295,x=V+(S<<17&4294967295|S>>>15),S=T+(y^x&(V^y))+A[7]+4249261313&4294967295,T=x+(S<<22&4294967295|S>>>10),S=y+(V^T&(x^V))+A[8]+1770035416&4294967295,y=T+(S<<7&4294967295|S>>>25),S=V+(x^y&(T^x))+A[9]+2336552879&4294967295,V=y+(S<<12&4294967295|S>>>20),S=x+(T^V&(y^T))+A[10]+4294925233&4294967295,x=V+(S<<17&4294967295|S>>>15),S=T+(y^x&(V^y))+A[11]+2304563134&4294967295,T=x+(S<<22&4294967295|S>>>10),S=y+(V^T&(x^V))+A[12]+1804603682&4294967295,y=T+(S<<7&4294967295|S>>>25),S=V+(x^y&(T^x))+A[13]+4254626195&4294967295,V=y+(S<<12&4294967295|S>>>20),S=x+(T^V&(y^T))+A[14]+2792965006&4294967295,x=V+(S<<17&4294967295|S>>>15),S=T+(y^x&(V^y))+A[15]+1236535329&4294967295,T=x+(S<<22&4294967295|S>>>10),S=y+(x^V&(T^x))+A[1]+4129170786&4294967295,y=T+(S<<5&4294967295|S>>>27),S=V+(T^x&(y^T))+A[6]+3225465664&4294967295,V=y+(S<<9&4294967295|S>>>23),S=x+(y^T&(V^y))+A[11]+643717713&4294967295,x=V+(S<<14&4294967295|S>>>18),S=T+(V^y&(x^V))+A[0]+3921069994&4294967295,T=x+(S<<20&4294967295|S>>>12),S=y+(x^V&(T^x))+A[5]+3593408605&4294967295,y=T+(S<<5&4294967295|S>>>27),S=V+(T^x&(y^T))+A[10]+38016083&4294967295,V=y+(S<<9&4294967295|S>>>23),S=x+(y^T&(V^y))+A[15]+3634488961&4294967295,x=V+(S<<14&4294967295|S>>>18),S=T+(V^y&(x^V))+A[4]+3889429448&4294967295,T=x+(S<<20&4294967295|S>>>12),S=y+(x^V&(T^x))+A[9]+568446438&4294967295,y=T+(S<<5&4294967295|S>>>27),S=V+(T^x&(y^T))+A[14]+3275163606&4294967295,V=y+(S<<9&4294967295|S>>>23),S=x+(y^T&(V^y))+A[3]+4107603335&4294967295,x=V+(S<<14&4294967295|S>>>18),S=T+(V^y&(x^V))+A[8]+1163531501&4294967295,T=x+(S<<20&4294967295|S>>>12),S=y+(x^V&(T^x))+A[13]+2850285829&4294967295,y=T+(S<<5&4294967295|S>>>27),S=V+(T^x&(y^T))+A[2]+4243563512&4294967295,V=y+(S<<9&4294967295|S>>>23),S=x+(y^T&(V^y))+A[7]+1735328473&4294967295,x=V+(S<<14&4294967295|S>>>18),S=T+(V^y&(x^V))+A[12]+2368359562&4294967295,T=x+(S<<20&4294967295|S>>>12),S=y+(T^x^V)+A[5]+4294588738&4294967295,y=T+(S<<4&4294967295|S>>>28),S=V+(y^T^x)+A[8]+2272392833&4294967295,V=y+(S<<11&4294967295|S>>>21),S=x+(V^y^T)+A[11]+1839030562&4294967295,x=V+(S<<16&4294967295|S>>>16),S=T+(x^V^y)+A[14]+4259657740&4294967295,T=x+(S<<23&4294967295|S>>>9),S=y+(T^x^V)+A[1]+2763975236&4294967295,y=T+(S<<4&4294967295|S>>>28),S=V+(y^T^x)+A[4]+1272893353&4294967295,V=y+(S<<11&4294967295|S>>>21),S=x+(V^y^T)+A[7]+4139469664&4294967295,x=V+(S<<16&4294967295|S>>>16),S=T+(x^V^y)+A[10]+3200236656&4294967295,T=x+(S<<23&4294967295|S>>>9),S=y+(T^x^V)+A[13]+681279174&4294967295,y=T+(S<<4&4294967295|S>>>28),S=V+(y^T^x)+A[0]+3936430074&4294967295,V=y+(S<<11&4294967295|S>>>21),S=x+(V^y^T)+A[3]+3572445317&4294967295,x=V+(S<<16&4294967295|S>>>16),S=T+(x^V^y)+A[6]+76029189&4294967295,T=x+(S<<23&4294967295|S>>>9),S=y+(T^x^V)+A[9]+3654602809&4294967295,y=T+(S<<4&4294967295|S>>>28),S=V+(y^T^x)+A[12]+3873151461&4294967295,V=y+(S<<11&4294967295|S>>>21),S=x+(V^y^T)+A[15]+530742520&4294967295,x=V+(S<<16&4294967295|S>>>16),S=T+(x^V^y)+A[2]+3299628645&4294967295,T=x+(S<<23&4294967295|S>>>9),S=y+(x^(T|~V))+A[0]+4096336452&4294967295,y=T+(S<<6&4294967295|S>>>26),S=V+(T^(y|~x))+A[7]+1126891415&4294967295,V=y+(S<<10&4294967295|S>>>22),S=x+(y^(V|~T))+A[14]+2878612391&4294967295,x=V+(S<<15&4294967295|S>>>17),S=T+(V^(x|~y))+A[5]+4237533241&4294967295,T=x+(S<<21&4294967295|S>>>11),S=y+(x^(T|~V))+A[12]+1700485571&4294967295,y=T+(S<<6&4294967295|S>>>26),S=V+(T^(y|~x))+A[3]+2399980690&4294967295,V=y+(S<<10&4294967295|S>>>22),S=x+(y^(V|~T))+A[10]+4293915773&4294967295,x=V+(S<<15&4294967295|S>>>17),S=T+(V^(x|~y))+A[1]+2240044497&4294967295,T=x+(S<<21&4294967295|S>>>11),S=y+(x^(T|~V))+A[8]+1873313359&4294967295,y=T+(S<<6&4294967295|S>>>26),S=V+(T^(y|~x))+A[15]+4264355552&4294967295,V=y+(S<<10&4294967295|S>>>22),S=x+(y^(V|~T))+A[6]+2734768916&4294967295,x=V+(S<<15&4294967295|S>>>17),S=T+(V^(x|~y))+A[13]+1309151649&4294967295,T=x+(S<<21&4294967295|S>>>11),S=y+(x^(T|~V))+A[4]+4149444226&4294967295,y=T+(S<<6&4294967295|S>>>26),S=V+(T^(y|~x))+A[11]+3174756917&4294967295,V=y+(S<<10&4294967295|S>>>22),S=x+(y^(V|~T))+A[2]+718787259&4294967295,x=V+(S<<15&4294967295|S>>>17),S=T+(V^(x|~y))+A[9]+3951481745&4294967295,w.g[0]=w.g[0]+y&4294967295,w.g[1]=w.g[1]+(x+(S<<21&4294967295|S>>>11))&4294967295,w.g[2]=w.g[2]+x&4294967295,w.g[3]=w.g[3]+V&4294967295}r.prototype.u=function(w,y){y===void 0&&(y=w.length);for(var T=y-this.blockSize,A=this.B,x=this.h,V=0;V<y;){if(x==0)for(;V<=T;)i(this,w,V),V+=this.blockSize;if(typeof w=="string"){for(;V<y;)if(A[x++]=w.charCodeAt(V++),x==this.blockSize){i(this,A),x=0;break}}else for(;V<y;)if(A[x++]=w[V++],x==this.blockSize){i(this,A),x=0;break}}this.h=x,this.o+=y},r.prototype.v=function(){var w=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);w[0]=128;for(var y=1;y<w.length-8;++y)w[y]=0;var T=8*this.o;for(y=w.length-8;y<w.length;++y)w[y]=T&255,T/=256;for(this.u(w),w=Array(16),y=T=0;4>y;++y)for(var A=0;32>A;A+=8)w[T++]=this.g[y]>>>A&255;return w};function s(w,y){var T=l;return Object.prototype.hasOwnProperty.call(T,w)?T[w]:T[w]=y(w)}function o(w,y){this.h=y;for(var T=[],A=!0,x=w.length-1;0<=x;x--){var V=w[x]|0;A&&V==y||(T[x]=V,A=!1)}this.g=T}var l={};function u(w){return-128<=w&&128>w?s(w,function(y){return new o([y|0],0>y?-1:0)}):new o([w|0],0>w?-1:0)}function c(w){if(isNaN(w)||!isFinite(w))return p;if(0>w)return M(c(-w));for(var y=[],T=1,A=0;w>=T;A++)y[A]=w/T|0,T*=4294967296;return new o(y,0)}function d(w,y){if(w.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(w.charAt(0)=="-")return M(d(w.substring(1),y));if(0<=w.indexOf("-"))throw Error('number format error: interior "-" character');for(var T=c(Math.pow(y,8)),A=p,x=0;x<w.length;x+=8){var V=Math.min(8,w.length-x),S=parseInt(w.substring(x,x+V),y);8>V?(V=c(Math.pow(y,V)),A=A.j(V).add(c(S))):(A=A.j(T),A=A.add(c(S)))}return A}var p=u(0),m=u(1),I=u(16777216);t=o.prototype,t.m=function(){if(C(this))return-M(this).m();for(var w=0,y=1,T=0;T<this.g.length;T++){var A=this.i(T);w+=(0<=A?A:4294967296+A)*y,y*=4294967296}return w},t.toString=function(w){if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(R(this))return"0";if(C(this))return"-"+M(this).toString(w);for(var y=c(Math.pow(w,6)),T=this,A="";;){var x=O(T,y).g;T=_(T,x.j(y));var V=((0<T.g.length?T.g[0]:T.h)>>>0).toString(w);if(T=x,R(T))return V+A;for(;6>V.length;)V="0"+V;A=V+A}},t.i=function(w){return 0>w?0:w<this.g.length?this.g[w]:this.h};function R(w){if(w.h!=0)return!1;for(var y=0;y<w.g.length;y++)if(w.g[y]!=0)return!1;return!0}function C(w){return w.h==-1}t.l=function(w){return w=_(this,w),C(w)?-1:R(w)?0:1};function M(w){for(var y=w.g.length,T=[],A=0;A<y;A++)T[A]=~w.g[A];return new o(T,~w.h).add(m)}t.abs=function(){return C(this)?M(this):this},t.add=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],A=0,x=0;x<=y;x++){var V=A+(this.i(x)&65535)+(w.i(x)&65535),S=(V>>>16)+(this.i(x)>>>16)+(w.i(x)>>>16);A=S>>>16,V&=65535,S&=65535,T[x]=S<<16|V}return new o(T,T[T.length-1]&-2147483648?-1:0)};function _(w,y){return w.add(M(y))}t.j=function(w){if(R(this)||R(w))return p;if(C(this))return C(w)?M(this).j(M(w)):M(M(this).j(w));if(C(w))return M(this.j(M(w)));if(0>this.l(I)&&0>w.l(I))return c(this.m()*w.m());for(var y=this.g.length+w.g.length,T=[],A=0;A<2*y;A++)T[A]=0;for(A=0;A<this.g.length;A++)for(var x=0;x<w.g.length;x++){var V=this.i(A)>>>16,S=this.i(A)&65535,be=w.i(x)>>>16,oe=w.i(x)&65535;T[2*A+2*x]+=S*oe,v(T,2*A+2*x),T[2*A+2*x+1]+=V*oe,v(T,2*A+2*x+1),T[2*A+2*x+1]+=S*be,v(T,2*A+2*x+1),T[2*A+2*x+2]+=V*be,v(T,2*A+2*x+2)}for(A=0;A<y;A++)T[A]=T[2*A+1]<<16|T[2*A];for(A=y;A<2*y;A++)T[A]=0;return new o(T,0)};function v(w,y){for(;(w[y]&65535)!=w[y];)w[y+1]+=w[y]>>>16,w[y]&=65535,y++}function E(w,y){this.g=w,this.h=y}function O(w,y){if(R(y))throw Error("division by zero");if(R(w))return new E(p,p);if(C(w))return y=O(M(w),y),new E(M(y.g),M(y.h));if(C(y))return y=O(w,M(y)),new E(M(y.g),y.h);if(30<w.g.length){if(C(w)||C(y))throw Error("slowDivide_ only works with positive integers.");for(var T=m,A=y;0>=A.l(w);)T=U(T),A=U(A);var x=B(T,1),V=B(A,1);for(A=B(A,2),T=B(T,2);!R(A);){var S=V.add(A);0>=S.l(w)&&(x=x.add(T),V=S),A=B(A,1),T=B(T,1)}return y=_(w,x.j(y)),new E(x,y)}for(x=p;0<=w.l(y);){for(T=Math.max(1,Math.floor(w.m()/y.m())),A=Math.ceil(Math.log(T)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),V=c(T),S=V.j(y);C(S)||0<S.l(w);)T-=A,V=c(T),S=V.j(y);R(V)&&(V=m),x=x.add(V),w=_(w,S)}return new E(x,w)}t.A=function(w){return O(this,w).h},t.and=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],A=0;A<y;A++)T[A]=this.i(A)&w.i(A);return new o(T,this.h&w.h)},t.or=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],A=0;A<y;A++)T[A]=this.i(A)|w.i(A);return new o(T,this.h|w.h)},t.xor=function(w){for(var y=Math.max(this.g.length,w.g.length),T=[],A=0;A<y;A++)T[A]=this.i(A)^w.i(A);return new o(T,this.h^w.h)};function U(w){for(var y=w.g.length+1,T=[],A=0;A<y;A++)T[A]=w.i(A)<<1|w.i(A-1)>>>31;return new o(T,w.h)}function B(w,y){var T=y>>5;y%=32;for(var A=w.g.length-T,x=[],V=0;V<A;V++)x[V]=0<y?w.i(V+T)>>>y|w.i(V+T+1)<<32-y:w.i(V+T);return new o(x,w.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Q0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,zi=o}).apply(typeof ly<"u"?ly:typeof self<"u"?self:typeof window<"u"?window:{});var Zl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var W0,aa,H0,_u,Kd,Y0,X0,J0;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,h,f){return a==Array.prototype||a==Object.prototype||(a[h]=f.value),a};function n(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zl=="object"&&Zl];for(var h=0;h<a.length;++h){var f=a[h];if(f&&f.Math==Math)return f}throw Error("Cannot find global object")}var r=n(this);function i(a,h){if(h)e:{var f=r;a=a.split(".");for(var g=0;g<a.length-1;g++){var D=a[g];if(!(D in f))break e;f=f[D]}a=a[a.length-1],g=f[a],h=h(g),h!=g&&h!=null&&e(f,a,{configurable:!0,writable:!0,value:h})}}function s(a,h){a instanceof String&&(a+="");var f=0,g=!1,D={next:function(){if(!g&&f<a.length){var F=f++;return{value:h(F,a[F]),done:!1}}return g=!0,{done:!0,value:void 0}}};return D[Symbol.iterator]=function(){return D},D}i("Array.prototype.values",function(a){return a||function(){return s(this,function(h,f){return f})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(a){var h=typeof a;return h=h!="object"?h:a?Array.isArray(a)?"array":h:"null",h=="array"||h=="object"&&typeof a.length=="number"}function c(a){var h=typeof a;return h=="object"&&a!=null||h=="function"}function d(a,h,f){return a.call.apply(a.bind,arguments)}function p(a,h,f){if(!a)throw Error();if(2<arguments.length){var g=Array.prototype.slice.call(arguments,2);return function(){var D=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(D,g),a.apply(h,D)}}return function(){return a.apply(h,arguments)}}function m(a,h,f){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:p,m.apply(null,arguments)}function I(a,h){var f=Array.prototype.slice.call(arguments,1);return function(){var g=f.slice();return g.push.apply(g,arguments),a.apply(this,g)}}function R(a,h){function f(){}f.prototype=h.prototype,a.aa=h.prototype,a.prototype=new f,a.prototype.constructor=a,a.Qb=function(g,D,F){for(var Q=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)Q[ke-2]=arguments[ke];return h.prototype[D].apply(g,Q)}}function C(a){const h=a.length;if(0<h){const f=Array(h);for(let g=0;g<h;g++)f[g]=a[g];return f}return[]}function M(a,h){for(let f=1;f<arguments.length;f++){const g=arguments[f];if(u(g)){const D=a.length||0,F=g.length||0;a.length=D+F;for(let Q=0;Q<F;Q++)a[D+Q]=g[Q]}else a.push(g)}}class _{constructor(h,f){this.i=h,this.j=f,this.h=0,this.g=null}get(){let h;return 0<this.h?(this.h--,h=this.g,this.g=h.next,h.next=null):h=this.i(),h}}function v(a){return/^[\s\xa0]*$/.test(a)}function E(){var a=l.navigator;return a&&(a=a.userAgent)?a:""}function O(a){return O[" "](a),a}O[" "]=function(){};var U=E().indexOf("Gecko")!=-1&&!(E().toLowerCase().indexOf("webkit")!=-1&&E().indexOf("Edge")==-1)&&!(E().indexOf("Trident")!=-1||E().indexOf("MSIE")!=-1)&&E().indexOf("Edge")==-1;function B(a,h,f){for(const g in a)h.call(f,a[g],g,a)}function w(a,h){for(const f in a)h.call(void 0,a[f],f,a)}function y(a){const h={};for(const f in a)h[f]=a[f];return h}const T="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(a,h){let f,g;for(let D=1;D<arguments.length;D++){g=arguments[D];for(f in g)a[f]=g[f];for(let F=0;F<T.length;F++)f=T[F],Object.prototype.hasOwnProperty.call(g,f)&&(a[f]=g[f])}}function x(a){var h=1;a=a.split(":");const f=[];for(;0<h&&a.length;)f.push(a.shift()),h--;return a.length&&f.push(a.join(":")),f}function V(a){l.setTimeout(()=>{throw a},0)}function S(){var a=re;let h=null;return a.g&&(h=a.g,a.g=a.g.next,a.g||(a.h=null),h.next=null),h}class be{constructor(){this.h=this.g=null}add(h,f){const g=oe.get();g.set(h,f),this.h?this.h.next=g:this.g=g,this.h=g}}var oe=new _(()=>new gn,a=>a.reset());class gn{constructor(){this.next=this.g=this.h=null}set(h,f){this.h=h,this.g=f,this.next=null}reset(){this.next=this.g=this.h=null}}let he,G=!1,re=new be,ae=()=>{const a=l.Promise.resolve(void 0);he=()=>{a.then(Ae)}};var Ae=()=>{for(var a;a=S();){try{a.h.call(a.g)}catch(f){V(f)}var h=oe;h.j(a),100>h.h&&(h.h++,a.next=h.g,h.g=a)}G=!1};function ve(){this.s=this.s,this.C=this.C}ve.prototype.s=!1,ve.prototype.ma=function(){this.s||(this.s=!0,this.N())},ve.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Pe(a,h){this.type=a,this.g=this.target=h,this.defaultPrevented=!1}Pe.prototype.h=function(){this.defaultPrevented=!0};var et=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var a=!1,h=Object.defineProperty({},"passive",{get:function(){a=!0}});try{const f=()=>{};l.addEventListener("test",f,h),l.removeEventListener("test",f,h)}catch{}return a}();function tt(a,h){if(Pe.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var f=this.type=a.type,g=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=h,h=a.relatedTarget){if(U){e:{try{O(h.nodeName);var D=!0;break e}catch{}D=!1}D||(h=null)}}else f=="mouseover"?h=a.fromElement:f=="mouseout"&&(h=a.toElement);this.relatedTarget=h,g?(this.clientX=g.clientX!==void 0?g.clientX:g.pageX,this.clientY=g.clientY!==void 0?g.clientY:g.pageY,this.screenX=g.screenX||0,this.screenY=g.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=typeof a.pointerType=="string"?a.pointerType:_e[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&tt.aa.h.call(this)}}R(tt,Pe);var _e={2:"touch",3:"pen",4:"mouse"};tt.prototype.h=function(){tt.aa.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ue="closure_listenable_"+(1e6*Math.random()|0),st=0;function fe(a,h,f,g,D){this.listener=a,this.proxy=null,this.src=h,this.type=f,this.capture=!!g,this.ha=D,this.key=++st,this.da=this.fa=!1}function L(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function yt(a){this.src=a,this.g={},this.h=0}yt.prototype.add=function(a,h,f,g,D){var F=a.toString();a=this.g[F],a||(a=this.g[F]=[],this.h++);var Q=qe(a,h,g,D);return-1<Q?(h=a[Q],f||(h.fa=!1)):(h=new fe(h,this.src,F,!!g,D),h.fa=f,a.push(h)),h};function Be(a,h){var f=h.type;if(f in a.g){var g=a.g[f],D=Array.prototype.indexOf.call(g,h,void 0),F;(F=0<=D)&&Array.prototype.splice.call(g,D,1),F&&(L(h),a.g[f].length==0&&(delete a.g[f],a.h--))}}function qe(a,h,f,g){for(var D=0;D<a.length;++D){var F=a[D];if(!F.da&&F.listener==h&&F.capture==!!f&&F.ha==g)return D}return-1}var Ke="closure_lm_"+(1e6*Math.random()|0),Dt={};function yn(a,h,f,g,D){if(g&&g.once)return mi(a,h,f,g,D);if(Array.isArray(h)){for(var F=0;F<h.length;F++)yn(a,h[F],f,g,D);return null}return f=yi(f),a&&a[ue]?a.K(h,f,c(g)?!!g.capture:!!g,D):An(a,h,f,!1,g,D)}function An(a,h,f,g,D,F){if(!h)throw Error("Invalid event type");var Q=c(D)?!!D.capture:!!D,ke=Xn(a);if(ke||(a[Ke]=ke=new yt(a)),f=ke.add(h,f,g,Q,F),f.proxy)return f;if(g=Er(),f.proxy=g,g.src=a,g.listener=f,a.addEventListener)et||(D=Q),D===void 0&&(D=!1),a.addEventListener(h.toString(),g,D);else if(a.attachEvent)a.attachEvent(Ln(h.toString()),g);else if(a.addListener&&a.removeListener)a.addListener(g);else throw Error("addEventListener and attachEvent are unavailable.");return f}function Er(){function a(f){return h.call(a.src,a.listener,f)}const h=gi;return a}function mi(a,h,f,g,D){if(Array.isArray(h)){for(var F=0;F<h.length;F++)mi(a,h[F],f,g,D);return null}return f=yi(f),a&&a[ue]?a.L(h,f,c(g)?!!g.capture:!!g,D):An(a,h,f,!0,g,D)}function Tr(a,h,f,g,D){if(Array.isArray(h))for(var F=0;F<h.length;F++)Tr(a,h[F],f,g,D);else g=c(g)?!!g.capture:!!g,f=yi(f),a&&a[ue]?(a=a.i,h=String(h).toString(),h in a.g&&(F=a.g[h],f=qe(F,f,g,D),-1<f&&(L(F[f]),Array.prototype.splice.call(F,f,1),F.length==0&&(delete a.g[h],a.h--)))):a&&(a=Xn(a))&&(h=a.g[h.toString()],a=-1,h&&(a=qe(h,f,g,D)),(f=-1<a?h[a]:null)&&on(f))}function on(a){if(typeof a!="number"&&a&&!a.da){var h=a.src;if(h&&h[ue])Be(h.i,a);else{var f=a.type,g=a.proxy;h.removeEventListener?h.removeEventListener(f,g,a.capture):h.detachEvent?h.detachEvent(Ln(f),g):h.addListener&&h.removeListener&&h.removeListener(g),(f=Xn(h))?(Be(f,a),f.h==0&&(f.src=null,h[Ke]=null)):L(a)}}}function Ln(a){return a in Dt?Dt[a]:Dt[a]="on"+a}function gi(a,h){if(a.da)a=!0;else{h=new tt(h,this);var f=a.listener,g=a.ha||a.src;a.fa&&on(a),a=f.call(g,h)}return a}function Xn(a){return a=a[Ke],a instanceof yt?a:null}var hs="__closure_events_fn_"+(1e9*Math.random()>>>0);function yi(a){return typeof a=="function"?a:(a[hs]||(a[hs]=function(h){return a.handleEvent(h)}),a[hs])}function ct(){ve.call(this),this.i=new yt(this),this.M=this,this.F=null}R(ct,ve),ct.prototype[ue]=!0,ct.prototype.removeEventListener=function(a,h,f,g){Tr(this,a,h,f,g)};function ft(a,h){var f,g=a.F;if(g)for(f=[];g;g=g.F)f.push(g);if(a=a.M,g=h.type||h,typeof h=="string")h=new Pe(h,a);else if(h instanceof Pe)h.target=h.target||a;else{var D=h;h=new Pe(g,a),A(h,D)}if(D=!0,f)for(var F=f.length-1;0<=F;F--){var Q=h.g=f[F];D=Jn(Q,g,!0,h)&&D}if(Q=h.g=a,D=Jn(Q,g,!0,h)&&D,D=Jn(Q,g,!1,h)&&D,f)for(F=0;F<f.length;F++)Q=h.g=f[F],D=Jn(Q,g,!1,h)&&D}ct.prototype.N=function(){if(ct.aa.N.call(this),this.i){var a=this.i,h;for(h in a.g){for(var f=a.g[h],g=0;g<f.length;g++)L(f[g]);delete a.g[h],a.h--}}this.F=null},ct.prototype.K=function(a,h,f,g){return this.i.add(String(a),h,!1,f,g)},ct.prototype.L=function(a,h,f,g){return this.i.add(String(a),h,!0,f,g)};function Jn(a,h,f,g){if(h=a.i.g[String(h)],!h)return!0;h=h.concat();for(var D=!0,F=0;F<h.length;++F){var Q=h[F];if(Q&&!Q.da&&Q.capture==f){var ke=Q.listener,At=Q.ha||Q.src;Q.fa&&Be(a.i,Q),D=ke.call(At,g)!==!1&&D}}return D&&!g.defaultPrevented}function ds(a,h,f){if(typeof a=="function")f&&(a=m(a,f));else if(a&&typeof a.handleEvent=="function")a=m(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(h)?-1:l.setTimeout(a,h||0)}function fs(a){a.g=ds(()=>{a.g=null,a.i&&(a.i=!1,fs(a))},a.l);const h=a.h;a.h=null,a.m.apply(null,h)}class No extends ve{constructor(h,f){super(),this.m=h,this.l=f,this.h=null,this.i=!1,this.g=null}j(h){this.h=arguments,this.g?this.i=!0:fs(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ir(a){ve.call(this),this.h=a,this.g={}}R(Ir,ve);var _i=[];function ps(a){B(a.g,function(h,f){this.g.hasOwnProperty(f)&&on(h)},a),a.g={}}Ir.prototype.N=function(){Ir.aa.N.call(this),ps(this)},Ir.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var vi=l.JSON.stringify,nh=l.JSON.parse,wl=class{stringify(a){return l.JSON.stringify(a,void 0)}parse(a){return l.JSON.parse(a,void 0)}};function ms(){}ms.prototype.h=null;function bo(a){return a.h||(a.h=a.i())}function El(){}var Sr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function wi(){Pe.call(this,"d")}R(wi,Pe);function Ei(){Pe.call(this,"c")}R(Ei,Pe);var Zn={},Tl=null;function Ti(){return Tl=Tl||new ct}Zn.La="serverreachability";function Mo(a){Pe.call(this,Zn.La,a)}R(Mo,Pe);function er(a){const h=Ti();ft(h,new Mo(h))}Zn.STAT_EVENT="statevent";function Oo(a,h){Pe.call(this,Zn.STAT_EVENT,a),this.stat=h}R(Oo,Pe);function _t(a){const h=Ti();ft(h,new Oo(h,a))}Zn.Ma="timingevent";function Il(a,h){Pe.call(this,Zn.Ma,a),this.size=h}R(Il,Pe);function Bn(a,h){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){a()},h)}function Ar(){this.g=!0}Ar.prototype.xa=function(){this.g=!1};function Ge(a,h,f,g,D,F){a.info(function(){if(a.g)if(F)for(var Q="",ke=F.split("&"),At=0;At<ke.length;At++){var Se=ke[At].split("=");if(1<Se.length){var bt=Se[0];Se=Se[1];var Mt=bt.split("_");Q=2<=Mt.length&&Mt[1]=="type"?Q+(bt+"="+Se+"&"):Q+(bt+"=redacted&")}}else Q=null;else Q=F;return"XMLHTTP REQ ("+g+") [attempt "+D+"]: "+h+`
`+f+`
`+Q})}function Qe(a,h,f,g,D,F,Q){a.info(function(){return"XMLHTTP RESP ("+g+") [ attempt "+D+"]: "+h+`
`+f+`
`+F+" "+Q})}function Te(a,h,f,g){a.info(function(){return"XMLHTTP TEXT ("+h+"): "+rh(a,f)+(g?" "+g:"")})}function We(a,h){a.info(function(){return"TIMEOUT: "+h})}Ar.prototype.info=function(){};function rh(a,h){if(!a.g)return h;if(!h)return null;try{var f=JSON.parse(h);if(f){for(a=0;a<f.length;a++)if(Array.isArray(f[a])){var g=f[a];if(!(2>g.length)){var D=g[1];if(Array.isArray(D)&&!(1>D.length)){var F=D[0];if(F!="noop"&&F!="stop"&&F!="close")for(var Q=1;Q<D.length;Q++)D[Q]=""}}}}return vi(f)}catch{return h}}var Ii={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ie={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},P;function J(){}R(J,ms),J.prototype.g=function(){return new XMLHttpRequest},J.prototype.i=function(){return{}},P=new J;function H(a,h,f,g){this.j=a,this.i=h,this.l=f,this.R=g||1,this.U=new Ir(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Y}function Y(){this.i=null,this.g="",this.h=!1}var te={},de={};function se(a,h,f){a.L=1,a.v=Rl(tr(h)),a.m=f,a.P=!0,Nt(a,null)}function Nt(a,h){a.F=Date.now(),xn(a),a.A=tr(a.v);var f=a.A,g=a.R;Array.isArray(g)||(g=[String(g)]),wm(f.i,"t",g),a.C=0,f=a.j.J,a.h=new Y,a.g=Lm(a.j,f?h:null,!a.m),0<a.O&&(a.M=new No(m(a.Y,a,a.g),a.O)),h=a.U,f=a.g,g=a.ca;var D="readystatechange";Array.isArray(D)||(D&&(_i[0]=D.toString()),D=_i);for(var F=0;F<D.length;F++){var Q=yn(f,D[F],g||h.handleEvent,!1,h.h||h);if(!Q)break;h.g[Q.key]=Q}h=a.H?y(a.H):{},a.m?(a.u||(a.u="POST"),h["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.m,h)):(a.u="GET",a.g.ea(a.A,a.u,null,h)),er(),Ge(a.i,a.u,a.A,a.l,a.R,a.m)}H.prototype.ca=function(a){a=a.target;const h=this.M;h&&nr(a)==3?h.j():this.Y(a)},H.prototype.Y=function(a){try{if(a==this.g)e:{const Mt=nr(this.g);var h=this.g.Ba();const _s=this.g.Z();if(!(3>Mt)&&(Mt!=3||this.g&&(this.h.h||this.g.oa()||Rm(this.g)))){this.J||Mt!=4||h==7||(h==8||0>=_s?er(3):er(2)),Pn(this);var f=this.g.Z();this.X=f;t:if(an(this)){var g=Rm(this.g);a="";var D=g.length,F=nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qt(this),Cn(this);var Q="";break t}this.h.i=new l.TextDecoder}for(h=0;h<D;h++)this.h.h=!0,a+=this.h.i.decode(g[h],{stream:!(F&&h==D-1)});g.length=0,this.h.g+=a,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=f==200,Qe(this.i,this.u,this.A,this.l,this.R,Mt,f),this.o){if(this.T&&!this.K){t:{if(this.g){var ke,At=this.g;if((ke=At.g?At.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ke)){var Se=ke;break t}}Se=null}if(f=Se)Te(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Kt(this,f);else{this.o=!1,this.s=3,_t(12),qt(this),Cn(this);break e}}if(this.P){f=!0;let kn;for(;!this.J&&this.C<Q.length;)if(kn=Yt(this,Q),kn==de){Mt==4&&(this.s=4,_t(14),f=!1),Te(this.i,this.l,null,"[Incomplete Response]");break}else if(kn==te){this.s=4,_t(15),Te(this.i,this.l,Q,"[Invalid Chunk]"),f=!1;break}else Te(this.i,this.l,kn,null),Kt(this,kn);if(an(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||Q.length!=0||this.h.h||(this.s=1,_t(16),f=!1),this.o=this.o&&f,!f)Te(this.i,this.l,Q,"[Invalid Chunked Response]"),qt(this),Cn(this);else if(0<Q.length&&!this.W){this.W=!0;var bt=this.j;bt.g==this&&bt.ba&&!bt.M&&(bt.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),ch(bt),bt.M=!0,_t(11))}}else Te(this.i,this.l,Q,null),Kt(this,Q);Mt==4&&qt(this),this.o&&!this.J&&(Mt==4?bm(this.j,this):(this.o=!1,xn(this)))}else kT(this.g),f==400&&0<Q.indexOf("Unknown SID")?(this.s=3,_t(12)):(this.s=0,_t(13)),qt(this),Cn(this)}}}catch{}finally{}};function an(a){return a.g?a.u=="GET"&&a.L!=2&&a.j.Ca:!1}function Yt(a,h){var f=a.C,g=h.indexOf(`
`,f);return g==-1?de:(f=Number(h.substring(f,g)),isNaN(f)?te:(g+=1,g+f>h.length?de:(h=h.slice(g,g+f),a.C=g+f,h)))}H.prototype.cancel=function(){this.J=!0,qt(this)};function xn(a){a.S=Date.now()+a.I,Rn(a,a.I)}function Rn(a,h){if(a.B!=null)throw Error("WatchDog timer not null");a.B=Bn(m(a.ba,a),h)}function Pn(a){a.B&&(l.clearTimeout(a.B),a.B=null)}H.prototype.ba=function(){this.B=null;const a=Date.now();0<=a-this.S?(We(this.i,this.A),this.L!=2&&(er(),_t(17)),qt(this),this.s=2,Cn(this)):Rn(this,this.S-a)};function Cn(a){a.j.G==0||a.J||bm(a.j,a)}function qt(a){Pn(a);var h=a.M;h&&typeof h.ma=="function"&&h.ma(),a.M=null,ps(a.U),a.g&&(h=a.g,a.g=null,h.abort(),h.ma())}function Kt(a,h){try{var f=a.j;if(f.G!=0&&(f.g==a||sh(f.h,a))){if(!a.K&&sh(f.h,a)&&f.G==3){try{var g=f.Da.g.parse(h)}catch{g=null}if(Array.isArray(g)&&g.length==3){var D=g;if(D[0]==0){e:if(!f.u){if(f.g)if(f.g.F+3e3<a.F)Nl(f),Vl(f);else break e;uh(f),_t(18)}}else f.za=D[1],0<f.za-f.T&&37500>D[2]&&f.F&&f.v==0&&!f.C&&(f.C=Bn(m(f.Za,f),6e3));if(1>=hm(f.h)&&f.ca){try{f.ca()}catch{}f.ca=void 0}}else Ai(f,11)}else if((a.K||f.g==a)&&Nl(f),!v(h))for(D=f.Da.g.parse(h),h=0;h<D.length;h++){let Se=D[h];if(f.T=Se[0],Se=Se[1],f.G==2)if(Se[0]=="c"){f.K=Se[1],f.ia=Se[2];const bt=Se[3];bt!=null&&(f.la=bt,f.j.info("VER="+f.la));const Mt=Se[4];Mt!=null&&(f.Aa=Mt,f.j.info("SVER="+f.Aa));const _s=Se[5];_s!=null&&typeof _s=="number"&&0<_s&&(g=1.5*_s,f.L=g,f.j.info("backChannelRequestTimeoutMs_="+g)),g=f;const kn=a.g;if(kn){const Ml=kn.g?kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ml){var F=g.h;F.g||Ml.indexOf("spdy")==-1&&Ml.indexOf("quic")==-1&&Ml.indexOf("h2")==-1||(F.j=F.l,F.g=new Set,F.h&&(oh(F,F.h),F.h=null))}if(g.D){const hh=kn.g?kn.g.getResponseHeader("X-HTTP-Session-Id"):null;hh&&(g.ya=hh,Me(g.I,g.D,hh))}}f.G=3,f.l&&f.l.ua(),f.ba&&(f.R=Date.now()-a.F,f.j.info("Handshake RTT: "+f.R+"ms")),g=f;var Q=a;if(g.qa=Fm(g,g.J?g.ia:null,g.W),Q.K){dm(g.h,Q);var ke=Q,At=g.L;At&&(ke.I=At),ke.B&&(Pn(ke),xn(ke)),g.g=Q}else Dm(g);0<f.i.length&&Dl(f)}else Se[0]!="stop"&&Se[0]!="close"||Ai(f,7);else f.G==3&&(Se[0]=="stop"||Se[0]=="close"?Se[0]=="stop"?Ai(f,7):lh(f):Se[0]!="noop"&&f.l&&f.l.ta(Se),f.v=0)}}er(4)}catch{}}var ih=class{constructor(a,h){this.g=a,this.map=h}};function Sl(a){this.l=a||10,l.PerformanceNavigationTiming?(a=l.performance.getEntriesByType("navigation"),a=0<a.length&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function cm(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function hm(a){return a.h?1:a.g?a.g.size:0}function sh(a,h){return a.h?a.h==h:a.g?a.g.has(h):!1}function oh(a,h){a.g?a.g.add(h):a.h=h}function dm(a,h){a.h&&a.h==h?a.h=null:a.g&&a.g.has(h)&&a.g.delete(h)}Sl.prototype.cancel=function(){if(this.i=fm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const a of this.g.values())a.cancel();this.g.clear()}};function fm(a){if(a.h!=null)return a.i.concat(a.h.D);if(a.g!=null&&a.g.size!==0){let h=a.i;for(const f of a.g.values())h=h.concat(f.D);return h}return C(a.i)}function mT(a){if(a.V&&typeof a.V=="function")return a.V();if(typeof Map<"u"&&a instanceof Map||typeof Set<"u"&&a instanceof Set)return Array.from(a.values());if(typeof a=="string")return a.split("");if(u(a)){for(var h=[],f=a.length,g=0;g<f;g++)h.push(a[g]);return h}h=[],f=0;for(g in a)h[f++]=a[g];return h}function gT(a){if(a.na&&typeof a.na=="function")return a.na();if(!a.V||typeof a.V!="function"){if(typeof Map<"u"&&a instanceof Map)return Array.from(a.keys());if(!(typeof Set<"u"&&a instanceof Set)){if(u(a)||typeof a=="string"){var h=[];a=a.length;for(var f=0;f<a;f++)h.push(f);return h}h=[],f=0;for(const g in a)h[f++]=g;return h}}}function pm(a,h){if(a.forEach&&typeof a.forEach=="function")a.forEach(h,void 0);else if(u(a)||typeof a=="string")Array.prototype.forEach.call(a,h,void 0);else for(var f=gT(a),g=mT(a),D=g.length,F=0;F<D;F++)h.call(void 0,g[F],f&&f[F],a)}var mm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yT(a,h){if(a){a=a.split("&");for(var f=0;f<a.length;f++){var g=a[f].indexOf("="),D=null;if(0<=g){var F=a[f].substring(0,g);D=a[f].substring(g+1)}else F=a[f];h(F,D?decodeURIComponent(D.replace(/\+/g," ")):"")}}}function Si(a){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,a instanceof Si){this.h=a.h,Al(this,a.j),this.o=a.o,this.g=a.g,xl(this,a.s),this.l=a.l;var h=a.i,f=new Bo;f.i=h.i,h.g&&(f.g=new Map(h.g),f.h=h.h),gm(this,f),this.m=a.m}else a&&(h=String(a).match(mm))?(this.h=!1,Al(this,h[1]||"",!0),this.o=Fo(h[2]||""),this.g=Fo(h[3]||"",!0),xl(this,h[4]),this.l=Fo(h[5]||"",!0),gm(this,h[6]||"",!0),this.m=Fo(h[7]||"")):(this.h=!1,this.i=new Bo(null,this.h))}Si.prototype.toString=function(){var a=[],h=this.j;h&&a.push(Lo(h,ym,!0),":");var f=this.g;return(f||h=="file")&&(a.push("//"),(h=this.o)&&a.push(Lo(h,ym,!0),"@"),a.push(encodeURIComponent(String(f)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f=this.s,f!=null&&a.push(":",String(f))),(f=this.l)&&(this.g&&f.charAt(0)!="/"&&a.push("/"),a.push(Lo(f,f.charAt(0)=="/"?wT:vT,!0))),(f=this.i.toString())&&a.push("?",f),(f=this.m)&&a.push("#",Lo(f,TT)),a.join("")};function tr(a){return new Si(a)}function Al(a,h,f){a.j=f?Fo(h,!0):h,a.j&&(a.j=a.j.replace(/:$/,""))}function xl(a,h){if(h){if(h=Number(h),isNaN(h)||0>h)throw Error("Bad port number "+h);a.s=h}else a.s=null}function gm(a,h,f){h instanceof Bo?(a.i=h,IT(a.i,a.h)):(f||(h=Lo(h,ET)),a.i=new Bo(h,a.h))}function Me(a,h,f){a.i.set(h,f)}function Rl(a){return Me(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function Fo(a,h){return a?h?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Lo(a,h,f){return typeof a=="string"?(a=encodeURI(a).replace(h,_T),f&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function _T(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var ym=/[#\/\?@]/g,vT=/[#\?:]/g,wT=/[#\?]/g,ET=/[#\?@]/g,TT=/#/g;function Bo(a,h){this.h=this.g=null,this.i=a||null,this.j=!!h}function xr(a){a.g||(a.g=new Map,a.h=0,a.i&&yT(a.i,function(h,f){a.add(decodeURIComponent(h.replace(/\+/g," ")),f)}))}t=Bo.prototype,t.add=function(a,h){xr(this),this.i=null,a=gs(this,a);var f=this.g.get(a);return f||this.g.set(a,f=[]),f.push(h),this.h+=1,this};function _m(a,h){xr(a),h=gs(a,h),a.g.has(h)&&(a.i=null,a.h-=a.g.get(h).length,a.g.delete(h))}function vm(a,h){return xr(a),h=gs(a,h),a.g.has(h)}t.forEach=function(a,h){xr(this),this.g.forEach(function(f,g){f.forEach(function(D){a.call(h,D,g,this)},this)},this)},t.na=function(){xr(this);const a=Array.from(this.g.values()),h=Array.from(this.g.keys()),f=[];for(let g=0;g<h.length;g++){const D=a[g];for(let F=0;F<D.length;F++)f.push(h[g])}return f},t.V=function(a){xr(this);let h=[];if(typeof a=="string")vm(this,a)&&(h=h.concat(this.g.get(gs(this,a))));else{a=Array.from(this.g.values());for(let f=0;f<a.length;f++)h=h.concat(a[f])}return h},t.set=function(a,h){return xr(this),this.i=null,a=gs(this,a),vm(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[h]),this.h+=1,this},t.get=function(a,h){return a?(a=this.V(a),0<a.length?String(a[0]):h):h};function wm(a,h,f){_m(a,h),0<f.length&&(a.i=null,a.g.set(gs(a,h),C(f)),a.h+=f.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const a=[],h=Array.from(this.g.keys());for(var f=0;f<h.length;f++){var g=h[f];const F=encodeURIComponent(String(g)),Q=this.V(g);for(g=0;g<Q.length;g++){var D=F;Q[g]!==""&&(D+="="+encodeURIComponent(String(Q[g]))),a.push(D)}}return this.i=a.join("&")};function gs(a,h){return h=String(h),a.j&&(h=h.toLowerCase()),h}function IT(a,h){h&&!a.j&&(xr(a),a.i=null,a.g.forEach(function(f,g){var D=g.toLowerCase();g!=D&&(_m(this,g),wm(this,D,f))},a)),a.j=h}function ST(a,h){const f=new Ar;if(l.Image){const g=new Image;g.onload=I(Rr,f,"TestLoadImage: loaded",!0,h,g),g.onerror=I(Rr,f,"TestLoadImage: error",!1,h,g),g.onabort=I(Rr,f,"TestLoadImage: abort",!1,h,g),g.ontimeout=I(Rr,f,"TestLoadImage: timeout",!1,h,g),l.setTimeout(function(){g.ontimeout&&g.ontimeout()},1e4),g.src=a}else h(!1)}function AT(a,h){const f=new Ar,g=new AbortController,D=setTimeout(()=>{g.abort(),Rr(f,"TestPingServer: timeout",!1,h)},1e4);fetch(a,{signal:g.signal}).then(F=>{clearTimeout(D),F.ok?Rr(f,"TestPingServer: ok",!0,h):Rr(f,"TestPingServer: server error",!1,h)}).catch(()=>{clearTimeout(D),Rr(f,"TestPingServer: error",!1,h)})}function Rr(a,h,f,g,D){try{D&&(D.onload=null,D.onerror=null,D.onabort=null,D.ontimeout=null),g(f)}catch{}}function xT(){this.g=new wl}function RT(a,h,f){const g=f||"";try{pm(a,function(D,F){let Q=D;c(D)&&(Q=vi(D)),h.push(g+F+"="+encodeURIComponent(Q))})}catch(D){throw h.push(g+"type="+encodeURIComponent("_badmap")),D}}function Pl(a){this.l=a.Ub||null,this.j=a.eb||!1}R(Pl,ms),Pl.prototype.g=function(){return new Cl(this.l,this.j)},Pl.prototype.i=function(a){return function(){return a}}({});function Cl(a,h){ct.call(this),this.D=a,this.o=h,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}R(Cl,ct),t=Cl.prototype,t.open=function(a,h){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=a,this.A=h,this.readyState=1,zo(this)},t.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const h={headers:this.u,method:this.B,credentials:this.m,cache:void 0};a&&(h.body=a),(this.D||l).fetch(new Request(this.A,h)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,jo(this)),this.readyState=0},t.Sa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,zo(this)),this.g&&(this.readyState=3,zo(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Em(this)}else a.text().then(this.Ra.bind(this),this.ga.bind(this))};function Em(a){a.j.read().then(a.Pa.bind(a)).catch(a.ga.bind(a))}t.Pa=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var h=a.value?a.value:new Uint8Array(0);(h=this.v.decode(h,{stream:!a.done}))&&(this.response=this.responseText+=h)}a.done?jo(this):zo(this),this.readyState==3&&Em(this)}},t.Ra=function(a){this.g&&(this.response=this.responseText=a,jo(this))},t.Qa=function(a){this.g&&(this.response=a,jo(this))},t.ga=function(){this.g&&jo(this)};function jo(a){a.readyState=4,a.l=null,a.j=null,a.v=null,zo(a)}t.setRequestHeader=function(a,h){this.u.append(a,h)},t.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],h=this.h.entries();for(var f=h.next();!f.done;)f=f.value,a.push(f[0]+": "+f[1]),f=h.next();return a.join(`\r
`)};function zo(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(Cl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Tm(a){let h="";return B(a,function(f,g){h+=g,h+=":",h+=f,h+=`\r
`}),h}function ah(a,h,f){e:{for(g in f){var g=!1;break e}g=!0}g||(f=Tm(f),typeof a=="string"?f!=null&&encodeURIComponent(String(f)):Me(a,h,f))}function nt(a){ct.call(this),this.headers=new Map,this.o=a||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}R(nt,ct);var PT=/^https?$/i,CT=["POST","PUT"];t=nt.prototype,t.Ha=function(a){this.J=a},t.ea=function(a,h,f,g){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);h=h?h.toUpperCase():"GET",this.D=a,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():P.g(),this.v=this.o?bo(this.o):bo(P),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(h,String(a),!0),this.B=!1}catch(F){Im(this,F);return}if(a=f||"",f=new Map(this.headers),g)if(Object.getPrototypeOf(g)===Object.prototype)for(var D in g)f.set(D,g[D]);else if(typeof g.keys=="function"&&typeof g.get=="function")for(const F of g.keys())f.set(F,g.get(F));else throw Error("Unknown input type for opt_headers: "+String(g));g=Array.from(f.keys()).find(F=>F.toLowerCase()=="content-type"),D=l.FormData&&a instanceof l.FormData,!(0<=Array.prototype.indexOf.call(CT,h,void 0))||g||D||f.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[F,Q]of f)this.g.setRequestHeader(F,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xm(this),this.u=!0,this.g.send(a),this.u=!1}catch(F){Im(this,F)}};function Im(a,h){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=h,a.m=5,Sm(a),kl(a)}function Sm(a){a.A||(a.A=!0,ft(a,"complete"),ft(a,"error"))}t.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=a||7,ft(this,"complete"),ft(this,"abort"),kl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),kl(this,!0)),nt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Am(this):this.bb())},t.bb=function(){Am(this)};function Am(a){if(a.h&&typeof o<"u"&&(!a.v[1]||nr(a)!=4||a.Z()!=2)){if(a.u&&nr(a)==4)ds(a.Ea,0,a);else if(ft(a,"readystatechange"),nr(a)==4){a.h=!1;try{const Q=a.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var h=!0;break e;default:h=!1}var f;if(!(f=h)){var g;if(g=Q===0){var D=String(a.D).match(mm)[1]||null;!D&&l.self&&l.self.location&&(D=l.self.location.protocol.slice(0,-1)),g=!PT.test(D?D.toLowerCase():"")}f=g}if(f)ft(a,"complete"),ft(a,"success");else{a.m=6;try{var F=2<nr(a)?a.g.statusText:""}catch{F=""}a.l=F+" ["+a.Z()+"]",Sm(a)}}finally{kl(a)}}}}function kl(a,h){if(a.g){xm(a);const f=a.g,g=a.v[0]?()=>{}:null;a.g=null,a.v=null,h||ft(a,"ready");try{f.onreadystatechange=g}catch{}}}function xm(a){a.I&&(l.clearTimeout(a.I),a.I=null)}t.isActive=function(){return!!this.g};function nr(a){return a.g?a.g.readyState:0}t.Z=function(){try{return 2<nr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(a){if(this.g){var h=this.g.responseText;return a&&h.indexOf(a)==0&&(h=h.substring(a.length)),nh(h)}};function Rm(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.H){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function kT(a){const h={};a=(a.g&&2<=nr(a)&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let g=0;g<a.length;g++){if(v(a[g]))continue;var f=x(a[g]);const D=f[0];if(f=f[1],typeof f!="string")continue;f=f.trim();const F=h[D]||[];h[D]=F,F.push(f)}w(h,function(g){return g.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Uo(a,h,f){return f&&f.internalChannelParams&&f.internalChannelParams[a]||h}function Pm(a){this.Aa=0,this.i=[],this.j=new Ar,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Uo("failFast",!1,a),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Uo("baseRetryDelayMs",5e3,a),this.cb=Uo("retryDelaySeedMs",1e4,a),this.Wa=Uo("forwardChannelMaxRetries",2,a),this.wa=Uo("forwardChannelRequestTimeoutMs",2e4,a),this.pa=a&&a.xmlHttpFactory||void 0,this.Xa=a&&a.Tb||void 0,this.Ca=a&&a.useFetchStreams||!1,this.L=void 0,this.J=a&&a.supportsCrossDomainXhr||!1,this.K="",this.h=new Sl(a&&a.concurrentRequestLimit),this.Da=new xT,this.P=a&&a.fastHandshake||!1,this.O=a&&a.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=a&&a.Rb||!1,a&&a.xa&&this.j.xa(),a&&a.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&a&&a.detectBufferingProxy||!1,this.ja=void 0,a&&a.longPollingTimeout&&0<a.longPollingTimeout&&(this.ja=a.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Pm.prototype,t.la=8,t.G=1,t.connect=function(a,h,f,g){_t(0),this.W=a,this.H=h||{},f&&g!==void 0&&(this.H.OSID=f,this.H.OAID=g),this.F=this.X,this.I=Fm(this,null,this.W),Dl(this)};function lh(a){if(Cm(a),a.G==3){var h=a.U++,f=tr(a.I);if(Me(f,"SID",a.K),Me(f,"RID",h),Me(f,"TYPE","terminate"),$o(a,f),h=new H(a,a.j,h),h.L=2,h.v=Rl(tr(f)),f=!1,l.navigator&&l.navigator.sendBeacon)try{f=l.navigator.sendBeacon(h.v.toString(),"")}catch{}!f&&l.Image&&(new Image().src=h.v,f=!0),f||(h.g=Lm(h.j,null),h.g.ea(h.v)),h.F=Date.now(),xn(h)}Om(a)}function Vl(a){a.g&&(ch(a),a.g.cancel(),a.g=null)}function Cm(a){Vl(a),a.u&&(l.clearTimeout(a.u),a.u=null),Nl(a),a.h.cancel(),a.s&&(typeof a.s=="number"&&l.clearTimeout(a.s),a.s=null)}function Dl(a){if(!cm(a.h)&&!a.s){a.s=!0;var h=a.Ga;he||ae(),G||(he(),G=!0),re.add(h,a),a.B=0}}function VT(a,h){return hm(a.h)>=a.h.j-(a.s?1:0)?!1:a.s?(a.i=h.D.concat(a.i),!0):a.G==1||a.G==2||a.B>=(a.Va?0:a.Wa)?!1:(a.s=Bn(m(a.Ga,a,h),Mm(a,a.B)),a.B++,!0)}t.Ga=function(a){if(this.s)if(this.s=null,this.G==1){if(!a){this.U=Math.floor(1e5*Math.random()),a=this.U++;const D=new H(this,this.j,a);let F=this.o;if(this.S&&(F?(F=y(F),A(F,this.S)):F=this.S),this.m!==null||this.O||(D.H=F,F=null),this.P)e:{for(var h=0,f=0;f<this.i.length;f++){t:{var g=this.i[f];if("__data__"in g.map&&(g=g.map.__data__,typeof g=="string")){g=g.length;break t}g=void 0}if(g===void 0)break;if(h+=g,4096<h){h=f;break e}if(h===4096||f===this.i.length-1){h=f+1;break e}}h=1e3}else h=1e3;h=Vm(this,D,h),f=tr(this.I),Me(f,"RID",a),Me(f,"CVER",22),this.D&&Me(f,"X-HTTP-Session-Id",this.D),$o(this,f),F&&(this.O?h="headers="+encodeURIComponent(String(Tm(F)))+"&"+h:this.m&&ah(f,this.m,F)),oh(this.h,D),this.Ua&&Me(f,"TYPE","init"),this.P?(Me(f,"$req",h),Me(f,"SID","null"),D.T=!0,se(D,f,null)):se(D,f,h),this.G=2}}else this.G==3&&(a?km(this,a):this.i.length==0||cm(this.h)||km(this))};function km(a,h){var f;h?f=h.l:f=a.U++;const g=tr(a.I);Me(g,"SID",a.K),Me(g,"RID",f),Me(g,"AID",a.T),$o(a,g),a.m&&a.o&&ah(g,a.m,a.o),f=new H(a,a.j,f,a.B+1),a.m===null&&(f.H=a.o),h&&(a.i=h.D.concat(a.i)),h=Vm(a,f,1e3),f.I=Math.round(.5*a.wa)+Math.round(.5*a.wa*Math.random()),oh(a.h,f),se(f,g,h)}function $o(a,h){a.H&&B(a.H,function(f,g){Me(h,g,f)}),a.l&&pm({},function(f,g){Me(h,g,f)})}function Vm(a,h,f){f=Math.min(a.i.length,f);var g=a.l?m(a.l.Na,a.l,a):null;e:{var D=a.i;let F=-1;for(;;){const Q=["count="+f];F==-1?0<f?(F=D[0].g,Q.push("ofs="+F)):F=0:Q.push("ofs="+F);let ke=!0;for(let At=0;At<f;At++){let Se=D[At].g;const bt=D[At].map;if(Se-=F,0>Se)F=Math.max(0,D[At].g-100),ke=!1;else try{RT(bt,Q,"req"+Se+"_")}catch{g&&g(bt)}}if(ke){g=Q.join("&");break e}}}return a=a.i.splice(0,f),h.D=a,g}function Dm(a){if(!a.g&&!a.u){a.Y=1;var h=a.Fa;he||ae(),G||(he(),G=!0),re.add(h,a),a.v=0}}function uh(a){return a.g||a.u||3<=a.v?!1:(a.Y++,a.u=Bn(m(a.Fa,a),Mm(a,a.v)),a.v++,!0)}t.Fa=function(){if(this.u=null,Nm(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var a=2*this.R;this.j.info("BP detection timer enabled: "+a),this.A=Bn(m(this.ab,this),a)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,_t(10),Vl(this),Nm(this))};function ch(a){a.A!=null&&(l.clearTimeout(a.A),a.A=null)}function Nm(a){a.g=new H(a,a.j,"rpc",a.Y),a.m===null&&(a.g.H=a.o),a.g.O=0;var h=tr(a.qa);Me(h,"RID","rpc"),Me(h,"SID",a.K),Me(h,"AID",a.T),Me(h,"CI",a.F?"0":"1"),!a.F&&a.ja&&Me(h,"TO",a.ja),Me(h,"TYPE","xmlhttp"),$o(a,h),a.m&&a.o&&ah(h,a.m,a.o),a.L&&(a.g.I=a.L);var f=a.g;a=a.ia,f.L=1,f.v=Rl(tr(h)),f.m=null,f.P=!0,Nt(f,a)}t.Za=function(){this.C!=null&&(this.C=null,Vl(this),uh(this),_t(19))};function Nl(a){a.C!=null&&(l.clearTimeout(a.C),a.C=null)}function bm(a,h){var f=null;if(a.g==h){Nl(a),ch(a),a.g=null;var g=2}else if(sh(a.h,h))f=h.D,dm(a.h,h),g=1;else return;if(a.G!=0){if(h.o)if(g==1){f=h.m?h.m.length:0,h=Date.now()-h.F;var D=a.B;g=Ti(),ft(g,new Il(g,f)),Dl(a)}else Dm(a);else if(D=h.s,D==3||D==0&&0<h.X||!(g==1&&VT(a,h)||g==2&&uh(a)))switch(f&&0<f.length&&(h=a.h,h.i=h.i.concat(f)),D){case 1:Ai(a,5);break;case 4:Ai(a,10);break;case 3:Ai(a,6);break;default:Ai(a,2)}}}function Mm(a,h){let f=a.Ta+Math.floor(Math.random()*a.cb);return a.isActive()||(f*=2),f*h}function Ai(a,h){if(a.j.info("Error code "+h),h==2){var f=m(a.fb,a),g=a.Xa;const D=!g;g=new Si(g||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Al(g,"https"),Rl(g),D?ST(g.toString(),f):AT(g.toString(),f)}else _t(2);a.G=0,a.l&&a.l.sa(h),Om(a),Cm(a)}t.fb=function(a){a?(this.j.info("Successfully pinged google.com"),_t(2)):(this.j.info("Failed to ping google.com"),_t(1))};function Om(a){if(a.G=0,a.ka=[],a.l){const h=fm(a.h);(h.length!=0||a.i.length!=0)&&(M(a.ka,h),M(a.ka,a.i),a.h.i.length=0,C(a.i),a.i.length=0),a.l.ra()}}function Fm(a,h,f){var g=f instanceof Si?tr(f):new Si(f);if(g.g!="")h&&(g.g=h+"."+g.g),xl(g,g.s);else{var D=l.location;g=D.protocol,h=h?h+"."+D.hostname:D.hostname,D=+D.port;var F=new Si(null);g&&Al(F,g),h&&(F.g=h),D&&xl(F,D),f&&(F.l=f),g=F}return f=a.D,h=a.ya,f&&h&&Me(g,f,h),Me(g,"VER",a.la),$o(a,g),g}function Lm(a,h,f){if(h&&!a.J)throw Error("Can't create secondary domain capable XhrIo object.");return h=a.Ca&&!a.pa?new nt(new Pl({eb:f})):new nt(a.pa),h.Ha(a.J),h}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Bm(){}t=Bm.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function bl(){}bl.prototype.g=function(a,h){return new ln(a,h)};function ln(a,h){ct.call(this),this.g=new Pm(h),this.l=a,this.h=h&&h.messageUrlParams||null,a=h&&h.messageHeaders||null,h&&h.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=h&&h.initMessageHeaders||null,h&&h.messageContentType&&(a?a["X-WebChannel-Content-Type"]=h.messageContentType:a={"X-WebChannel-Content-Type":h.messageContentType}),h&&h.va&&(a?a["X-WebChannel-Client-Profile"]=h.va:a={"X-WebChannel-Client-Profile":h.va}),this.g.S=a,(a=h&&h.Sb)&&!v(a)&&(this.g.m=a),this.v=h&&h.supportsCrossDomainXhr||!1,this.u=h&&h.sendRawJson||!1,(h=h&&h.httpSessionIdParam)&&!v(h)&&(this.g.D=h,a=this.h,a!==null&&h in a&&(a=this.h,h in a&&delete a[h])),this.j=new ys(this)}R(ln,ct),ln.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ln.prototype.close=function(){lh(this.g)},ln.prototype.o=function(a){var h=this.g;if(typeof a=="string"){var f={};f.__data__=a,a=f}else this.u&&(f={},f.__data__=vi(a),a=f);h.i.push(new ih(h.Ya++,a)),h.G==3&&Dl(h)},ln.prototype.N=function(){this.g.l=null,delete this.j,lh(this.g),delete this.g,ln.aa.N.call(this)};function jm(a){wi.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var h=a.__sm__;if(h){e:{for(const f in h){a=f;break e}a=void 0}(this.i=a)&&(a=this.i,h=h!==null&&a in h?h[a]:void 0),this.data=h}else this.data=a}R(jm,wi);function zm(){Ei.call(this),this.status=1}R(zm,Ei);function ys(a){this.g=a}R(ys,Bm),ys.prototype.ua=function(){ft(this.g,"a")},ys.prototype.ta=function(a){ft(this.g,new jm(a))},ys.prototype.sa=function(a){ft(this.g,new zm)},ys.prototype.ra=function(){ft(this.g,"b")},bl.prototype.createWebChannel=bl.prototype.g,ln.prototype.send=ln.prototype.o,ln.prototype.open=ln.prototype.m,ln.prototype.close=ln.prototype.close,J0=function(){return new bl},X0=function(){return Ti()},Y0=Zn,Kd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ii.NO_ERROR=0,Ii.TIMEOUT=8,Ii.HTTP_ERROR=6,_u=Ii,ie.COMPLETE="complete",H0=ie,El.EventType=Sr,Sr.OPEN="a",Sr.CLOSE="b",Sr.ERROR="c",Sr.MESSAGE="d",ct.prototype.listen=ct.prototype.K,aa=El,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,W0=nt}).apply(typeof Zl<"u"?Zl:typeof self<"u"?self:typeof window<"u"?window:{});const uy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Et.UNAUTHENTICATED=new Et(null),Et.GOOGLE_CREDENTIALS=new Et("google-credentials-uid"),Et.FIRST_PARTY=new Et("first-party-uid"),Et.MOCK_USER=new Et("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Io="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr=new z0("@firebase/firestore");function Ss(){return Zr.logLevel}function jC(t){Zr.setLogLevel(t)}function j(t,...e){if(Zr.logLevel<=Ee.DEBUG){const n=e.map(cp);Zr.debug(`Firestore (${Io}): ${t}`,...n)}}function at(t,...e){if(Zr.logLevel<=Ee.ERROR){const n=e.map(cp);Zr.error(`Firestore (${Io}): ${t}`,...n)}}function Sn(t,...e){if(Zr.logLevel<=Ee.WARN){const n=e.map(cp);Zr.warn(`Firestore (${Io}): ${t}`,...n)}}function cp(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X(t="Unexpected state"){const e=`FIRESTORE (${Io}) INTERNAL ASSERTION FAILED: `+t;throw at(e),new Error(e)}function ee(t,e){t||X()}function zC(t,e){t||X()}function K(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class z extends To{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class jA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Et.UNAUTHENTICATED))}shutdown(){}}class zA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class UA{constructor(e){this.t=e,this.currentUser=Et.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ee(this.o===void 0);let r=this.i;const i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let s=new It;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new It,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{j("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(j("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new It)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(j("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ee(typeof r.accessToken=="string"),new Z0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ee(e===null||typeof e=="string"),new Et(e)}}class $A{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Et.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class qA{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new $A(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Et.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ew{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class KA{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ee(this.o===void 0);const r=s=>{s.error!=null&&j("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,j("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{j("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):j("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ee(typeof n.token=="string"),this.R=n.token,new ew(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}class UC{getToken(){return Promise.resolve(new ew(""))}invalidateToken(){}start(e,n){}shutdown(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GA(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=GA(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function le(t,e){return t<e?-1:t>e?1:0}function no(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function nw(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new z(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new z(b.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new z(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new z(b.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Xe.fromMillis(Date.now())}static fromDate(e){return Xe.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Xe(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?le(this.nanoseconds,e.nanoseconds):le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.timestamp=e}static fromTimestamp(e){return new ne(e)}static min(){return new ne(new Xe(0,0))}static max(){return new ne(new Xe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n,r){n===void 0?n=0:n>e.length&&X(),r===void 0?r=e.length-n:r>e.length-n&&X(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return qa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof qa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class ge extends qa{construct(e,n,r){return new ge(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new z(b.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new ge(n)}static emptyPath(){return new ge([])}}const QA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ue extends qa{construct(e,n,r){return new Ue(e,n,r)}static isValidIdentifier(e){return QA.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ue.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ue(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new z(b.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new z(b.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new z(b.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new z(b.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ue(n)}static emptyPath(){return new Ue([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W{constructor(e){this.path=e}static fromPath(e){return new W(ge.fromString(e))}static fromName(e){return new W(ge.fromString(e).popFirst(5))}static empty(){return new W(ge.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ge.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ge.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new W(new ge(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Gd(t){return t.fields.find(e=>e.kind===2)}function ki(t){return t.fields.filter(e=>e.kind!==2)}function WA(t,e){let n=le(t.collectionGroup,e.collectionGroup);if(n!==0)return n;for(let r=0;r<Math.min(t.fields.length,e.fields.length);++r)if(n=HA(t.fields[r],e.fields[r]),n!==0)return n;return le(t.fields.length,e.fields.length)}ro.UNKNOWN_ID=-1;class Ui{constructor(e,n){this.fieldPath=e,this.kind=n}}function HA(t,e){const n=Ue.comparator(t.fieldPath,e.fieldPath);return n!==0?n:le(t.kind,e.kind)}class io{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new io(0,fn.min())}}function rw(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=ne.fromTimestamp(r===1e9?new Xe(n+1,0):new Xe(n,r));return new fn(i,W.empty(),e)}function iw(t){return new fn(t.readTime,t.key,-1)}class fn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new fn(ne.min(),W.empty(),-1)}static max(){return new fn(ne.max(),W.empty(),-1)}}function hp(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=W.comparator(t.documentKey,e.documentKey),n!==0?n:le(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ow{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ui(t){if(t.code!==b.FAILED_PRECONDITION||t.message!==sw)throw t;j("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&X(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new N((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof N?n:N.resolve(n)}catch(n){return N.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):N.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):N.reject(n)}static resolve(e){return new N((n,r)=>{n(e)})}static reject(e){return new N((n,r)=>{r(e)})}static waitFor(e){return new N((n,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=N.resolve(!1);for(const r of e)n=n.next(i=>i?N.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new N((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const c=u;n(e[c]).next(d=>{o[c]=d,++l,l===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new N((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new It,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new wa(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=dp(r.target.error);this.V.reject(new wa(e,i))}}static open(e,n,r,i){try{return new Vc(n,e.transaction(i,r))}catch(s){throw new wa(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(j("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new XA(n)}}class Qn{constructor(e,n,r){this.name=e,this.version=n,this.p=r,Qn.S(Ju())===12.2&&at("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return j("SimpleDb","Removing database:",e),Vi(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!B0())return!1;if(Qn.v())return!0;const e=Ju(),n=Qn.S(e),r=0<n&&n<10,i=aw(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(j("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new wa(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new z(b.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new z(b.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new wa(e,o))},i.onupgradeneeded=s=>{j("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{j("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=Vc.open(this.db,e,s?"readonly":"readwrite",r),u=i(l).next(c=>(l.g(),c)).catch(c=>(l.abort(c),N.reject(c))).toPromise();return u.catch(()=>{}),await l.m,u}catch(l){const u=l,c=u.name!=="FirebaseError"&&o<3;if(j("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function aw(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class YA{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Vi(this.B.delete())}}class wa extends z{constructor(e,n){super(b.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ci(t){return t.name==="IndexedDbTransactionError"}class XA{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(j("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(j("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Vi(r)}add(e){return j("SimpleDb","ADD",this.store.name,e,e),Vi(this.store.add(e))}get(e){return Vi(this.store.get(e)).next(n=>(n===void 0&&(n=null),j("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return j("SimpleDb","DELETE",this.store.name,e),Vi(this.store.delete(e))}count(){return j("SimpleDb","COUNT",this.store.name),Vi(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new N((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(l,u)=>{o.push(u)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new N((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){j("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,l)=>l.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new N((r,i)=>{n.onerror=s=>{const o=dp(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}W(e,n){const r=[];return new N((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const u=new YA(l),c=n(l.primaryKey,l.value,u);if(c instanceof N){const d=c.catch(p=>(u.done(),N.reject(p)));r.push(d)}u.isDone?i():u.K===null?l.continue():l.continue(u.K)}}).next(()=>N.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Vi(t){return new N((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=dp(r.target.error);n(i)}})}let cy=!1;function dp(t){const e=Qn.S(Ju());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new z("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return cy||(cy=!0,setTimeout(()=>{throw r},0)),r}}return t}class JA{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){j("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{j("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){ci(n)?j("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ui(n)}await this.X(6e4)})}}class ZA{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return N.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return j("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(l=>{i-=l,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(l=>(j("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=iw(s);hp(o,r)>0&&(r=o)}),new fn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Zt.oe=-1;function ol(t){return t==null}function Ka(t){return t===0&&1/t==-1/0}function lw(t){return typeof t=="number"&&Number.isInteger(t)&&!Ka(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=hy(e)),e=ex(t.get(n),e);return hy(e)}function ex(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function hy(t){return t+""}function $n(t){const e=t.length;if(ee(e>=2),e===2)return ee(t.charAt(0)===""&&t.charAt(1)===""),ge.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&X(),t.charAt(o+1)){case"":const l=t.substring(s,o);let u;i.length===0?u=l:(i+=l,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:X()}s=o+2}return new ge(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(t,e){return[t,zt(e)]}function uw(t,e,n){return[t,zt(e),n]}const tx={},nx=["prefixPath","collectionGroup","readTime","documentId"],rx=["prefixPath","collectionGroup","documentId"],ix=["collectionGroup","readTime","prefixPath","documentId"],sx=["canonicalId","targetId"],ox=["targetId","path"],ax=["path","targetId"],lx=["collectionId","parent"],ux=["indexId","uid"],cx=["uid","sequenceNumber"],hx=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],dx=["indexId","uid","orderedDocumentKey"],fx=["userId","collectionPath","documentId"],px=["userId","collectionPath","largestBatchId"],mx=["userId","collectionGroup","largestBatchId"],cw=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],gx=[...cw,"documentOverlays"],hw=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],dw=hw,fp=[...dw,"indexConfiguration","indexState","indexEntries"],yx=fp,_x=[...fp,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd extends ow{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function gt(t,e){const n=K(t);return Qn.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fy(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function hi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function fw(t,e){const n=[];for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.push(e(t[r],r,t));return n}function pw(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ne{constructor(e,n){this.comparator=e,this.root=n||Rt.EMPTY}insert(e,n){return new Ne(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new Ne(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eu(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eu(this.root,e,this.comparator,!1)}getReverseIterator(){return new eu(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eu(this.root,e,this.comparator,!0)}}class eu{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Rt.RED,this.left=i??Rt.EMPTY,this.right=s??Rt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Rt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Rt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Rt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw X();const e=this.left.check();if(e!==this.right.check())throw X();return e+(this.isRed()?0:1)}}Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw X()}get value(){throw X()}get color(){throw X()}get left(){throw X()}get right(){throw X()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Rt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.comparator=e,this.data=new Ne(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new py(this.data.getIterator())}getIteratorFrom(e){return new py(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ce)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ce(this.comparator);return n.data=e,n}}class py{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ws(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.fields=e,e.sort(Ue.comparator)}static empty(){return new en([])}unionWith(e){let n=new Ce(Ue.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new en(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return no(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(){return typeof atob<"u"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new mw("Invalid base64 string: "+s):s}}(e);return new it(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new it(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}it.EMPTY_BYTE_STRING=new it("");const vx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pr(t){if(ee(!!t),typeof t=="string"){let e=0;const n=vx.exec(t);if(ee(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:je(t.seconds),nanos:je(t.nanos)}}function je(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function mr(t){return typeof t=="string"?it.fromBase64String(t):it.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Nc(t){const e=t.mapValue.fields.__previous_value__;return Dc(e)?Nc(e):e}function Ga(t){const e=pr(t.mapValue.fields.__local_write_time__.timestampValue);return new Xe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e,n,r,i,s,o,l,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=c}}class Hi{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Hi("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Hi&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wu={nullValue:"NULL_VALUE"};function ei(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Dc(t)?4:gw(t)?9007199254740991:bc(t)?10:11:X()}function Yn(t,e){if(t===e)return!0;const n=ei(t);if(n!==ei(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ga(t).isEqual(Ga(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=pr(i.timestampValue),l=pr(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return mr(i.bytesValue).isEqual(mr(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return je(i.geoPointValue.latitude)===je(s.geoPointValue.latitude)&&je(i.geoPointValue.longitude)===je(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return je(i.integerValue)===je(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=je(i.doubleValue),l=je(s.doubleValue);return o===l?Ka(o)===Ka(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return no(t.arrayValue.values||[],e.arrayValue.values||[],Yn);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(fy(o)!==fy(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Yn(o[u],l[u])))return!1;return!0}(t,e);default:return X()}}function Qa(t,e){return(t.values||[]).find(n=>Yn(n,e))!==void 0}function ti(t,e){if(t===e)return 0;const n=ei(t),r=ei(e);if(n!==r)return le(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return le(t.booleanValue,e.booleanValue);case 2:return function(s,o){const l=je(s.integerValue||s.doubleValue),u=je(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return my(t.timestampValue,e.timestampValue);case 4:return my(Ga(t),Ga(e));case 5:return le(t.stringValue,e.stringValue);case 6:return function(s,o){const l=mr(s),u=mr(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let c=0;c<l.length&&c<u.length;c++){const d=le(l[c],u[c]);if(d!==0)return d}return le(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const l=le(je(s.latitude),je(o.latitude));return l!==0?l:le(je(s.longitude),je(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return gy(t.arrayValue,e.arrayValue);case 10:return function(s,o){var l,u,c,d;const p=s.fields||{},m=o.fields||{},I=(l=p.value)===null||l===void 0?void 0:l.arrayValue,R=(u=m.value)===null||u===void 0?void 0:u.arrayValue,C=le(((c=I==null?void 0:I.values)===null||c===void 0?void 0:c.length)||0,((d=R==null?void 0:R.values)===null||d===void 0?void 0:d.length)||0);return C!==0?C:gy(I,R)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===jr.mapValue&&o===jr.mapValue)return 0;if(s===jr.mapValue)return 1;if(o===jr.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),c=o.fields||{},d=Object.keys(c);u.sort(),d.sort();for(let p=0;p<u.length&&p<d.length;++p){const m=le(u[p],d[p]);if(m!==0)return m;const I=ti(l[u[p]],c[d[p]]);if(I!==0)return I}return le(u.length,d.length)}(t.mapValue,e.mapValue);default:throw X()}}function my(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return le(t,e);const n=pr(t),r=pr(e),i=le(n.seconds,r.seconds);return i!==0?i:le(n.nanos,r.nanos)}function gy(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ti(n[i],r[i]);if(s)return s}return le(n.length,r.length)}function so(t){return Wd(t)}function Wd(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=pr(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return mr(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return W.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Wd(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Wd(n.fields[o])}`;return i+"}"}(t.mapValue):X()}function Eu(t){switch(ei(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Nc(t);return e?16+Eu(e):16;case 5:return 2*t.stringValue.length;case 6:return mr(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+Eu(s),0)}(t.arrayValue);case 10:case 11:return function(r){let i=0;return hi(r.fields,(s,o)=>{i+=s.length+Eu(o)}),i}(t.mapValue);default:throw X()}}function Yi(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Hd(t){return!!t&&"integerValue"in t}function Wa(t){return!!t&&"arrayValue"in t}function yy(t){return!!t&&"nullValue"in t}function _y(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Tu(t){return!!t&&"mapValue"in t}function bc(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Ea(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return hi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Ea(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Ea(t.arrayValue.values[n]);return e}return Object.assign({},t)}function gw(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const yw={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Ex(t){return"nullValue"in t?wu:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Yi(Hi.empty(),W.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?bc(t)?yw:{mapValue:{}}:X()}function Tx(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Yi(Hi.empty(),W.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?yw:"mapValue"in t?bc(t)?{mapValue:{}}:jr:X()}function vy(t,e){const n=ti(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function wy(t,e){const n=ti(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e){this.value=e}static empty(){return new Pt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Tu(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ea(n)}setAll(e){let n=Ue.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=l.popLast()}o?r[l.lastSegment()]=Ea(o):i.push(l.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Tu(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Yn(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Tu(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){hi(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Pt(Ea(this.value))}}function _w(t){const e=[];return hi(t.fields,(n,r)=>{const i=new Ue([n]);if(Tu(r)){const s=_w(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new en(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fe{constructor(e,n,r,i,s,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Fe(e,0,ne.min(),ne.min(),ne.min(),Pt.empty(),0)}static newFoundDocument(e,n,r,i){return new Fe(e,1,n,ne.min(),r,i,0)}static newNoDocument(e,n){return new Fe(e,2,n,ne.min(),ne.min(),Pt.empty(),0)}static newUnknownDocument(e,n){return new Fe(e,3,n,ne.min(),ne.min(),Pt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(ne.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ne.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Fe&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Fe(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,n){this.position=e,this.inclusive=n}}function Ey(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=W.comparator(W.fromName(o.referenceValue),n.key):r=ti(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ty(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Yn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n="asc"){this.field=e,this.dir=n}}function Ix(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{}class ye extends vw{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Sx(e,n,r):n==="array-contains"?new Rx(e,r):n==="in"?new Aw(e,r):n==="not-in"?new Px(e,r):n==="array-contains-any"?new Cx(e,r):new ye(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Ax(e,r):new xx(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ti(n,this.value)):n!==null&&ei(this.value)===ei(n)&&this.matchesComparison(ti(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return X()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class xe extends vw{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new xe(e,n)}matches(e){return oo(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function oo(t){return t.op==="and"}function Yd(t){return t.op==="or"}function pp(t){return ww(t)&&oo(t)}function ww(t){for(const e of t.filters)if(e instanceof xe)return!1;return!0}function Xd(t){if(t instanceof ye)return t.field.canonicalString()+t.op.toString()+so(t.value);if(pp(t))return t.filters.map(e=>Xd(e)).join(",");{const e=t.filters.map(n=>Xd(n)).join(",");return`${t.op}(${e})`}}function Ew(t,e){return t instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&Yn(r.value,i.value)}(t,e):t instanceof xe?function(r,i){return i instanceof xe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&Ew(o,i.filters[l]),!0):!1}(t,e):void X()}function Tw(t,e){const n=t.filters.concat(e);return xe.create(n,t.op)}function Iw(t){return t instanceof ye?function(n){return`${n.field.canonicalString()} ${n.op} ${so(n.value)}`}(t):t instanceof xe?function(n){return n.op.toString()+" {"+n.getFilters().map(Iw).join(" ,")+"}"}(t):"Filter"}class Sx extends ye{constructor(e,n,r){super(e,n,r),this.key=W.fromName(r.referenceValue)}matches(e){const n=W.comparator(e.key,this.key);return this.matchesComparison(n)}}class Ax extends ye{constructor(e,n){super(e,"in",n),this.keys=Sw("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class xx extends ye{constructor(e,n){super(e,"not-in",n),this.keys=Sw("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function Sw(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>W.fromName(r.referenceValue))}class Rx extends ye{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Wa(n)&&Qa(n.arrayValue,this.value)}}class Aw extends ye{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Qa(this.value.arrayValue,n)}}class Px extends ye{constructor(e,n){super(e,"not-in",n)}matches(e){if(Qa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Qa(this.value.arrayValue,n)}}class Cx extends ye{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Wa(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Qa(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kx{constructor(e,n=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.ue=null}}function Jd(t,e=null,n=[],r=[],i=null,s=null,o=null){return new kx(t,e,n,r,i,s,o)}function Xi(t){const e=K(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Xd(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ol(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>so(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>so(r)).join(",")),e.ue=n}return e.ue}function al(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Ix(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!Ew(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ty(t.startAt,e.startAt)&&Ty(t.endAt,e.endAt)}function nc(t){return W.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function rc(t,e){return t.filters.filter(n=>n instanceof ye&&n.field.isEqual(e))}function Iy(t,e,n){let r=wu,i=!0;for(const s of rc(t,e)){let o=wu,l=!0;switch(s.op){case"<":case"<=":o=Ex(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=wu}vy({value:r,inclusive:i},{value:o,inclusive:l})<0&&(r=o,i=l)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];vy({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function Sy(t,e,n){let r=jr,i=!0;for(const s of rc(t,e)){let o=jr,l=!0;switch(s.op){case">=":case">":o=Tx(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=jr}wy({value:r,inclusive:i},{value:o,inclusive:l})>0&&(r=o,i=l)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];wy({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e,n=null,r=[],i=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function xw(t,e,n,r,i,s,o,l){return new yr(t,e,n,r,i,s,o,l)}function So(t){return new yr(t)}function Ay(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function mp(t){return t.collectionGroup!==null}function Qs(t){const e=K(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Ce(Ue.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(l=l.add(c.field))})}),l})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Ha(s,r))}),n.has(Ue.keyField().canonicalString())||e.ce.push(new Ha(Ue.keyField(),r))}return e.ce}function Ut(t){const e=K(t);return e.le||(e.le=Pw(e,Qs(t))),e.le}function Rw(t){const e=K(t);return e.he||(e.he=Pw(e,t.explicitOrderBy)),e.he}function Pw(t,e){if(t.limitType==="F")return Jd(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Ha(i.field,s)});const n=t.endAt?new ni(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new ni(t.startAt.position,t.startAt.inclusive):null;return Jd(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Zd(t,e){const n=t.filters.concat([e]);return new yr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ic(t,e,n){return new yr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ll(t,e){return al(Ut(t),Ut(e))&&t.limitType===e.limitType}function Cw(t){return`${Xi(Ut(t))}|lt:${t.limitType}`}function As(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>Iw(i)).join(", ")}]`),ol(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>so(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>so(i)).join(",")),`Target(${r})`}(Ut(t))}; limitType=${t.limitType})`}function ul(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):W.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Qs(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,l,u){const c=Ey(o,l,u);return o.inclusive?c<=0:c<0}(r.startAt,Qs(r),i)||r.endAt&&!function(o,l,u){const c=Ey(o,l,u);return o.inclusive?c>=0:c>0}(r.endAt,Qs(r),i))}(t,e)}function kw(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Vw(t){return(e,n)=>{let r=!1;for(const i of Qs(t)){const s=Vx(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Vx(t,e,n){const r=t.field.isKeyField()?W.comparator(e.key,n.key):function(s,o,l){const u=o.data.field(s),c=l.data.field(s);return u!==null&&c!==null?ti(u,c):X()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return X()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){hi(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return pw(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dx=new Ne(W.comparator);function tn(){return Dx}const Dw=new Ne(W.comparator);function la(...t){let e=Dw;for(const n of t)e=e.insert(n.key,n);return e}function Nw(t){let e=Dw;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function qn(){return Ta()}function bw(){return Ta()}function Ta(){return new _r(t=>t.toString(),(t,e)=>t.isEqual(e))}const Nx=new Ne(W.comparator),bx=new Ce(W.comparator);function ce(...t){let e=bx;for(const n of t)e=e.add(n);return e}const Mx=new Ce(le);function gp(){return Mx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ka(e)?"-0":e}}function Mw(t){return{integerValue:""+t}}function Ow(t,e){return lw(e)?Mw(e):yp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mc{constructor(){this._=void 0}}function Ox(t,e,n){return t instanceof ao?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Dc(s)&&(s=Nc(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ji?Lw(t,e):t instanceof Zi?Bw(t,e):function(i,s){const o=Fw(i,s),l=xy(o)+xy(i.Pe);return Hd(o)&&Hd(i.Pe)?Mw(l):yp(i.serializer,l)}(t,e)}function Fx(t,e,n){return t instanceof Ji?Lw(t,e):t instanceof Zi?Bw(t,e):n}function Fw(t,e){return t instanceof lo?function(r){return Hd(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class ao extends Mc{}class Ji extends Mc{constructor(e){super(),this.elements=e}}function Lw(t,e){const n=jw(e);for(const r of t.elements)n.some(i=>Yn(i,r))||n.push(r);return{arrayValue:{values:n}}}class Zi extends Mc{constructor(e){super(),this.elements=e}}function Bw(t,e){let n=jw(e);for(const r of t.elements)n=n.filter(i=>!Yn(i,r));return{arrayValue:{values:n}}}class lo extends Mc{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function xy(t){return je(t.integerValue||t.doubleValue)}function jw(t){return Wa(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e,n){this.field=e,this.transform=n}}function Lx(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ji&&i instanceof Ji||r instanceof Zi&&i instanceof Zi?no(r.elements,i.elements,Yn):r instanceof lo&&i instanceof lo?Yn(r.Pe,i.Pe):r instanceof ao&&i instanceof ao}(t.transform,e.transform)}class Bx{constructor(e,n){this.version=e,this.transformResults=n}}class $e{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new $e}static exists(e){return new $e(void 0,e)}static updateTime(e){return new $e(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Iu(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Oc{}function zw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xo(t.key,$e.none()):new Ao(t.key,t.data,$e.none());{const n=t.data,r=Pt.empty();let i=new Ce(Ue.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new vr(t.key,r,new en(i.toArray()),$e.none())}}function jx(t,e,n){t instanceof Ao?function(i,s,o){const l=i.value.clone(),u=Py(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof vr?function(i,s,o){if(!Iu(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=Py(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Uw(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Ia(t,e,n,r){return t instanceof Ao?function(s,o,l,u){if(!Iu(s.precondition,o))return l;const c=s.value.clone(),d=Cy(s.fieldTransforms,u,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof vr?function(s,o,l,u){if(!Iu(s.precondition,o))return l;const c=Cy(s.fieldTransforms,u,o),d=o.data;return d.setAll(Uw(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(s,o,l){return Iu(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function zx(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=Fw(r.transform,i||null);s!=null&&(n===null&&(n=Pt.empty()),n.set(r.field,s))}return n||null}function Ry(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&no(r,i,(s,o)=>Lx(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ao extends Oc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class vr extends Oc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Uw(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Py(t,e,n){const r=new Map;ee(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,Fx(o,l,n[i]))}return r}function Cy(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,Ox(s,o,e))}return r}class xo extends Oc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class _p extends Oc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&jx(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Ia(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Ia(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=bw();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=n.has(i.key)?null:l;const u=zw(o,l);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(ne.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ce())}isEqual(e){return this.batchId===e.batchId&&no(this.mutations,e.mutations,(n,r)=>Ry(n,r))&&no(this.baseMutations,e.baseMutations,(n,r)=>Ry(n,r))}}class wp{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){ee(e.mutations.length===r.length);let i=function(){return Nx}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new wp(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ep{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $w{constructor(e,n,r){this.alias=e,this.aggregateType=n,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ht,we;function qw(t){switch(t){default:return X();case b.CANCELLED:case b.UNKNOWN:case b.DEADLINE_EXCEEDED:case b.RESOURCE_EXHAUSTED:case b.INTERNAL:case b.UNAVAILABLE:case b.UNAUTHENTICATED:return!1;case b.INVALID_ARGUMENT:case b.NOT_FOUND:case b.ALREADY_EXISTS:case b.PERMISSION_DENIED:case b.FAILED_PRECONDITION:case b.ABORTED:case b.OUT_OF_RANGE:case b.UNIMPLEMENTED:case b.DATA_LOSS:return!0}}function Kw(t){if(t===void 0)return at("GRPC error has no .code"),b.UNKNOWN;switch(t){case ht.OK:return b.OK;case ht.CANCELLED:return b.CANCELLED;case ht.UNKNOWN:return b.UNKNOWN;case ht.DEADLINE_EXCEEDED:return b.DEADLINE_EXCEEDED;case ht.RESOURCE_EXHAUSTED:return b.RESOURCE_EXHAUSTED;case ht.INTERNAL:return b.INTERNAL;case ht.UNAVAILABLE:return b.UNAVAILABLE;case ht.UNAUTHENTICATED:return b.UNAUTHENTICATED;case ht.INVALID_ARGUMENT:return b.INVALID_ARGUMENT;case ht.NOT_FOUND:return b.NOT_FOUND;case ht.ALREADY_EXISTS:return b.ALREADY_EXISTS;case ht.PERMISSION_DENIED:return b.PERMISSION_DENIED;case ht.FAILED_PRECONDITION:return b.FAILED_PRECONDITION;case ht.ABORTED:return b.ABORTED;case ht.OUT_OF_RANGE:return b.OUT_OF_RANGE;case ht.UNIMPLEMENTED:return b.UNIMPLEMENTED;case ht.DATA_LOSS:return b.DATA_LOSS;default:return X()}}(we=ht||(ht={}))[we.OK=0]="OK",we[we.CANCELLED=1]="CANCELLED",we[we.UNKNOWN=2]="UNKNOWN",we[we.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",we[we.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",we[we.NOT_FOUND=5]="NOT_FOUND",we[we.ALREADY_EXISTS=6]="ALREADY_EXISTS",we[we.PERMISSION_DENIED=7]="PERMISSION_DENIED",we[we.UNAUTHENTICATED=16]="UNAUTHENTICATED",we[we.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",we[we.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",we[we.ABORTED=10]="ABORTED",we[we.OUT_OF_RANGE=11]="OUT_OF_RANGE",we[we.UNIMPLEMENTED=12]="UNIMPLEMENTED",we[we.INTERNAL=13]="INTERNAL",we[we.UNAVAILABLE=14]="UNAVAILABLE",we[we.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sc=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gw(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=new zi([4294967295,4294967295],0);function ky(t){const e=Gw().encode(t),n=new Q0;return n.update(e),new Uint8Array(n.digest())}function Vy(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new zi([n,r],0),new zi([i,s],0)]}class Tp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ua(`Invalid padding: ${n}`);if(r<0)throw new ua(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ua(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ua(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=zi.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(zi.fromNumber(r)));return i.compare($x)===1&&(i=new zi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=ky(e),[r,i]=Vy(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Tp(s,i,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=ky(e),[r,i]=Vy(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ua extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hl{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,dl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new hl(ne.min(),i,new Ne(le),tn(),ce())}}class dl{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new dl(r,n,ce(),ce(),ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Su{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class Qw{constructor(e,n){this.targetId=e,this.me=n}}class Ww{constructor(e,n,r=it.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class Dy{constructor(){this.fe=0,this.ge=by(),this.pe=it.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=ce(),n=ce(),r=ce();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:X()}}),new dl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=by()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ee(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class qx{constructor(e){this.Le=e,this.Be=new Map,this.ke=tn(),this.qe=Ny(),this.Qe=new Ne(le)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:X()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(nc(s))if(r===0){const o=new W(s.path);this.Ue(n,o,Fe.newNoDocument(o,ne.min()))}else ee(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}sc==null||sc.et(function(d,p,m,I,R){var C,M,_,v,E,O;const U={localCacheCount:d,existenceFilterCount:p.count,databaseId:m.database,projectId:m.projectId},B=p.unchangedNames;return B&&(U.bloomFilter={applied:R===0,hashCount:(C=B==null?void 0:B.hashCount)!==null&&C!==void 0?C:0,bitmapLength:(v=(_=(M=B==null?void 0:B.bits)===null||M===void 0?void 0:M.bitmap)===null||_===void 0?void 0:_.length)!==null&&v!==void 0?v:0,padding:(O=(E=B==null?void 0:B.bits)===null||E===void 0?void 0:E.padding)!==null&&O!==void 0?O:0,mightContain:w=>{var y;return(y=I==null?void 0:I.mightContain(w))!==null&&y!==void 0&&y}}),U}(o,e.me,this.Le.tt(),l,u))}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,l;try{o=mr(r).toUint8Array()}catch(u){if(u instanceof mw)return Sn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Tp(o,i,s)}catch(u){return Sn(u instanceof ua?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const l=this.Je(o);if(l){if(s.current&&nc(l.target)){const u=new W(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Fe.newNoDocument(u,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=ce();this.qe.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const c=this.Je(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new hl(e,n,this.Qe,this.ke,r);return this.ke=tn(),this.qe=Ny(),this.Qe=new Ne(le),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Dy,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ce(le),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||j("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Dy),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Ny(){return new Ne(W.comparator)}function by(){return new Ne(W.comparator)}const Kx=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Gx=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Qx=(()=>({and:"AND",or:"OR"}))();class Wx{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function ef(t,e){return t.useProto3Json||ol(e)?e:{value:e}}function uo(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Hw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Hx(t,e){return uo(t,e.toTimestamp())}function lt(t){return ee(!!t),ne.fromTimestamp(function(n){const r=pr(n);return new Xe(r.seconds,r.nanos)}(t))}function Ip(t,e){return tf(t,e).canonicalString()}function tf(t,e){const n=function(i){return new ge(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Yw(t){const e=ge.fromString(t);return ee(oE(e)),e}function Ya(t,e){return Ip(t.databaseId,e.path)}function Wn(t,e){const n=Yw(e);if(n.get(1)!==t.databaseId.projectId)throw new z(b.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new z(b.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new W(Zw(n))}function Xw(t,e){return Ip(t.databaseId,e)}function Jw(t){const e=Yw(t);return e.length===4?ge.emptyPath():Zw(e)}function nf(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Zw(t){return ee(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function My(t,e,n){return{name:Ya(t,e),fields:n.value.mapValue.fields}}function eE(t,e,n){const r=Wn(t,e.name),i=lt(e.updateTime),s=e.createTime?lt(e.createTime):ne.min(),o=new Pt({mapValue:{fields:e.fields}}),l=Fe.newFoundDocument(r,i,s,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function Yx(t,e){return"found"in e?function(r,i){ee(!!i.found),i.found.name,i.found.updateTime;const s=Wn(r,i.found.name),o=lt(i.found.updateTime),l=i.found.createTime?lt(i.found.createTime):ne.min(),u=new Pt({mapValue:{fields:i.found.fields}});return Fe.newFoundDocument(s,o,l,u)}(t,e):"missing"in e?function(r,i){ee(!!i.missing),ee(!!i.readTime);const s=Wn(r,i.missing),o=lt(i.readTime);return Fe.newNoDocument(s,o)}(t,e):X()}function Xx(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:X()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(ee(d===void 0||typeof d=="string"),it.fromBase64String(d||"")):(ee(d===void 0||d instanceof Buffer||d instanceof Uint8Array),it.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(c){const d=c.code===void 0?b.UNKNOWN:Kw(c.code);return new z(d,c.message||"")}(o);n=new Ww(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Wn(t,r.document.name),s=lt(r.document.updateTime),o=r.document.createTime?lt(r.document.createTime):ne.min(),l=new Pt({mapValue:{fields:r.document.fields}}),u=Fe.newFoundDocument(i,s,o,l),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Su(c,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Wn(t,r.document),s=r.readTime?lt(r.readTime):ne.min(),o=Fe.newNoDocument(i,s),l=r.removedTargetIds||[];n=new Su([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Wn(t,r.document),s=r.removedTargetIds||[];n=new Su([],s,i,null)}else{if(!("filter"in e))return X();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new Ux(i,s),l=r.targetId;n=new Qw(l,o)}}return n}function Xa(t,e){let n;if(e instanceof Ao)n={update:My(t,e.key,e.value)};else if(e instanceof xo)n={delete:Ya(t,e.key)};else if(e instanceof vr)n={update:My(t,e.key,e.data),updateMask:rR(e.fieldMask)};else{if(!(e instanceof _p))return X();n={verify:Ya(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof ao)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Ji)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Zi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof lo)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw X()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Hx(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:X()}(t,e.precondition)),n}function rf(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?$e.updateTime(lt(s.updateTime)):s.exists!==void 0?$e.exists(s.exists):$e.none()}(e.currentDocument):$e.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,l){let u=null;if("setToServerValue"in l)ee(l.setToServerValue==="REQUEST_TIME"),u=new ao;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];u=new Ji(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];u=new Zi(d)}else"increment"in l?u=new lo(o,l.increment):X();const c=Ue.fromServerFormat(l.fieldPath);return new cl(c,u)}(t,i)):[];if(e.update){e.update.name;const i=Wn(t,e.update.name),s=new Pt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const c=u.fieldPaths||[];return new en(c.map(d=>Ue.fromServerFormat(d)))}(e.updateMask);return new vr(i,s,o,n,r)}return new Ao(i,s,n,r)}if(e.delete){const i=Wn(t,e.delete);return new xo(i,n)}if(e.verify){const i=Wn(t,e.verify);return new _p(i,n)}return X()}function Jx(t,e){return t&&t.length>0?(ee(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?lt(i.updateTime):lt(s);return o.isEqual(ne.min())&&(o=lt(s)),new Bx(o,i.transformResults||[])}(n,e))):[]}function tE(t,e){return{documents:[Xw(t,e.path)]}}function Fc(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Xw(t,i);const s=function(c){if(c.length!==0)return sE(xe.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(m){return{field:Mr(m.field),direction:eR(m.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=ef(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function nE(t,e,n,r){const{_t:i,parent:s}=Fc(t,e),o={},l=[];let u=0;return n.forEach(c=>{const d=r?c.alias:"aggregate_"+u++;o[d]=c.alias,c.aggregateType==="count"?l.push({alias:d,count:{}}):c.aggregateType==="avg"?l.push({alias:d,avg:{field:Mr(c.fieldPath)}}):c.aggregateType==="sum"&&l.push({alias:d,sum:{field:Mr(c.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:i.structuredQuery},parent:i.parent},ut:o,parent:s}}function rE(t){let e=Jw(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){ee(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(p){const m=iE(p);return m instanceof xe&&pp(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(R){return new Ha(xs(R.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(R.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(p){let m;return m=typeof p=="object"?p.value:p,ol(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){const m=!!p.before,I=p.values||[];return new ni(I,m)}(n.startAt));let c=null;return n.endAt&&(c=function(p){const m=!p.before,I=p.values||[];return new ni(I,m)}(n.endAt)),xw(e,i,o,s,l,"F",u,c)}function Zx(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return X()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function iE(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=xs(n.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=xs(n.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=xs(n.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=xs(n.unaryFilter.field);return ye.create(o,"!=",{nullValue:"NULL_VALUE"});default:return X()}}(t):t.fieldFilter!==void 0?function(n){return ye.create(xs(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return X()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return xe.create(n.compositeFilter.filters.map(r=>iE(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return X()}}(n.compositeFilter.op))}(t):X()}function eR(t){return Kx[t]}function tR(t){return Gx[t]}function nR(t){return Qx[t]}function Mr(t){return{fieldPath:t.canonicalString()}}function xs(t){return Ue.fromServerFormat(t.fieldPath)}function sE(t){return t instanceof ye?function(n){if(n.op==="=="){if(_y(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NAN"}};if(yy(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(_y(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NOT_NAN"}};if(yy(n.value))return{unaryFilter:{field:Mr(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Mr(n.field),op:tR(n.op),value:n.value}}}(t):t instanceof xe?function(n){const r=n.getFilters().map(i=>sE(i));return r.length===1?r[0]:{compositeFilter:{op:nR(n.op),filters:r}}}(t):X()}function rR(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function oE(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(e,n,r,i,s=ne.min(),o=ne.min(),l=it.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new ar(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ar(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aE{constructor(e){this.ct=e}}function iR(t,e){let n;if(e.document)n=eE(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=W.fromSegments(e.noDocument.path),i=ts(e.noDocument.readTime);n=Fe.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return X();{const r=W.fromSegments(e.unknownDocument.path),i=ts(e.unknownDocument.version);n=Fe.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new Xe(i[0],i[1]);return ne.fromTimestamp(s)}(e.readTime)),n}function Oy(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:oc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Ya(s,o.key),fields:o.data.value.mapValue.fields,updateTime:uo(s,o.version.toTimestamp()),createTime:uo(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:es(e.version)};else{if(!e.isUnknownDocument())return X();r.unknownDocument={path:n.path.toArray(),version:es(e.version)}}return r}function oc(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function es(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ts(t){const e=new Xe(t.seconds,t.nanoseconds);return ne.fromTimestamp(e)}function Di(t,e){const n=(e.baseMutations||[]).map(s=>rf(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>rf(t.ct,s)),i=Xe.fromMillis(e.localWriteTimeMs);return new vp(e.batchId,i,n,r)}function ca(t){const e=ts(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ts(t.lastLimboFreeSnapshotVersion):ne.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return ee(s.documents.length===1),Ut(So(Jw(s.documents[0])))}(t.query):function(s){return Ut(rE(s))}(t.query),new ar(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,it.fromBase64String(t.resumeToken))}function lE(t,e){const n=es(e.snapshotVersion),r=es(e.lastLimboFreeSnapshotVersion);let i;i=nc(e.target)?tE(t.ct,e.target):Fc(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Xi(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Sp(t){const e=rE({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ic(e,e.limit,"L"):e}function Uh(t,e){return new Ep(e.largestBatchId,rf(t.ct,e.overlayMutation))}function Fy(t,e){const n=e.path.lastSegment();return[t,zt(e.path.popLast()),n]}function Ly(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:es(r.readTime),documentKey:zt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{getBundleMetadata(e,n){return By(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ts(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return By(e).put(function(i){return{bundleId:i.id,createTime:es(lt(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return jy(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:Sp(s.bundledQuery),readTime:ts(s.readTime)}}(r)})}saveNamedQuery(e,n){return jy(e).put(function(i){return{name:i.name,readTime:es(lt(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function By(t){return gt(t,"bundles")}function jy(t){return gt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lc{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Lc(e,r)}getOverlay(e,n){return Jo(e).get(Fy(this.userId,n)).next(r=>r?Uh(this.serializer,r):null)}getOverlays(e,n){const r=qn();return N.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const l=new Ep(n,o);i.push(this.ht(e,l))}),N.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(zt(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Jo(e).j("collectionPathOverlayIndex",l))}),N.waitFor(s)}getOverlaysForCollection(e,n,r){const i=qn(),s=zt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Jo(e).U("collectionPathOverlayIndex",o).next(l=>{for(const u of l){const c=Uh(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=qn();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Jo(e).J({index:"collectionGroupOverlayIndex",range:l},(u,c,d)=>{const p=Uh(this.serializer,c);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Jo(e).put(function(i,s,o){const[l,u,c]=Fy(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Xa(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Jo(t){return gt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{Pt(e){return gt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?it.fromUint8Array(r):it.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(je(e.integerValue));else if("doubleValue"in e){const r=je(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Ka(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=pr(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(mr(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?gw(e)?this.dt(n,Number.MAX_SAFE_INTEGER):bc(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):X()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",l=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(je(l)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),W.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Ni.vt=new Ni;function aR(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function zy(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=aR(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class lR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=zy(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=zy(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class uR{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class cR{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Zo{constructor(){this.jt=new lR,this.Ht=new uR(this.jt),this.Jt=new cR(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new bi(this.indexId,this.documentKey,this.arrayValue,r)}}function Cr(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=Uy(t.arrayValue,e.arrayValue),n!==0?n:(n=Uy(t.directionalValue,e.directionalValue),n!==0?n:W.comparator(t.documentKey,e.documentKey)))}function Uy(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e){this.Xt=new Ce((n,r)=>Ue.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(ee(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Gd(e);if(n!==void 0&&!this.sn(n))return!1;const r=ki(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!i.has(l.field.canonicalString())){const u=r[s];if(!this.on(l,u)||!this._n(this.en[o++],u))return!1}++s}for(;s<r.length;++s){const l=r[s];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new Ce(Ue.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Ui(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Ui(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Ui(r.field,r.dir==="asc"?0:1)));return new ro(ro.UNKNOWN_ID,this.collectionId,n,io.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(t){var e,n;if(ee(t instanceof ye||t instanceof xe),t instanceof ye){if(t instanceof Aw){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>ye.create(t.field,"==",s)))||[];return xe.create(i,"or")}return t}const r=t.filters.map(i=>uE(i));return xe.create(r,t.op)}function hR(t){if(t.getFilters().length===0)return[];const e=af(uE(t));return ee(cE(e)),sf(e)||of(e)?[e]:e.getFilters()}function sf(t){return t instanceof ye}function of(t){return t instanceof xe&&pp(t)}function cE(t){return sf(t)||of(t)||function(n){if(n instanceof xe&&Yd(n)){for(const r of n.getFilters())if(!sf(r)&&!of(r))return!1;return!0}return!1}(t)}function af(t){if(ee(t instanceof ye||t instanceof xe),t instanceof ye)return t;if(t.filters.length===1)return af(t.filters[0]);const e=t.filters.map(r=>af(r));let n=xe.create(e,t.op);return n=ac(n),cE(n)?n:(ee(n instanceof xe),ee(oo(n)),ee(n.filters.length>1),n.filters.reduce((r,i)=>Ap(r,i)))}function Ap(t,e){let n;return ee(t instanceof ye||t instanceof xe),ee(e instanceof ye||e instanceof xe),n=t instanceof ye?e instanceof ye?function(i,s){return xe.create([i,s],"and")}(t,e):qy(t,e):e instanceof ye?qy(e,t):function(i,s){if(ee(i.filters.length>0&&s.filters.length>0),oo(i)&&oo(s))return Tw(i,s.getFilters());const o=Yd(i)?i:s,l=Yd(i)?s:i,u=o.filters.map(c=>Ap(c,l));return xe.create(u,"or")}(t,e),ac(n)}function qy(t,e){if(oo(e))return Tw(e,t.getFilters());{const n=e.filters.map(r=>Ap(t,r));return xe.create(n,"or")}}function ac(t){if(ee(t instanceof ye||t instanceof xe),t instanceof ye)return t;const e=t.getFilters();if(e.length===1)return ac(e[0]);if(ww(t))return t;const n=e.map(i=>ac(i)),r=[];return n.forEach(i=>{i instanceof ye?r.push(i):i instanceof xe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:xe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dR{constructor(){this.un=new xp}addToCollectionParentIndex(e,n){return this.un.add(n),N.resolve()}getCollectionParents(e,n){return N.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return N.resolve()}deleteFieldIndex(e,n){return N.resolve()}deleteAllFieldIndexes(e){return N.resolve()}createTargetIndexes(e,n){return N.resolve()}getDocumentsMatchingTarget(e,n){return N.resolve(null)}getIndexType(e,n){return N.resolve(0)}getFieldIndexes(e,n){return N.resolve([])}getNextCollectionGroupToUpdate(e){return N.resolve(null)}getMinOffset(e,n){return N.resolve(fn.min())}getMinOffsetFromCollectionGroup(e,n){return N.resolve(fn.min())}updateCollectionGroup(e,n,r){return N.resolve()}updateIndexEntries(e,n){return N.resolve()}}class xp{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ce(ge.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ce(ge.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=new Uint8Array(0);class fR{constructor(e,n){this.databaseId=n,this.cn=new xp,this.ln=new _r(r=>Xi(r),(r,i)=>al(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:zt(i)};return Ky(e).put(s)}return N.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[nw(n),""],!1,!0);return Ky(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push($n(o.parent))}return r})}addFieldIndex(e,n){const r=ea(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Ts(e);return s.next(l=>{o.put(Ly(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=ea(e),i=Ts(e),s=Es(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ea(e),r=Es(e),i=Ts(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return N.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new $y(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Es(e);let i=!0;const s=new Map;return N.forEach(this.hn(n),o=>this.Pn(e,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=ce();const l=[];return N.forEach(s,(u,c)=>{j("IndexedDbIndexManager",`Using index ${function(E){return`id=${E.indexId}|cg=${E.collectionGroup}|f=${E.fields.map(O=>`${O.fieldPath}:${O.kind}`).join(",")}`}(u)} to execute ${Xi(n)}`);const d=function(E,O){const U=Gd(O);if(U===void 0)return null;for(const B of rc(E,U.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(c,u),p=function(E,O){const U=new Map;for(const B of ki(O))for(const w of rc(E,B.fieldPath))switch(w.op){case"==":case"in":U.set(B.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return U.set(B.fieldPath.canonicalString(),w.value),Array.from(U.values())}return null}(c,u),m=function(E,O){const U=[];let B=!0;for(const w of ki(O)){const y=w.kind===0?Iy(E,w.fieldPath,E.startAt):Sy(E,w.fieldPath,E.startAt);U.push(y.value),B&&(B=y.inclusive)}return new ni(U,B)}(c,u),I=function(E,O){const U=[];let B=!0;for(const w of ki(O)){const y=w.kind===0?Sy(E,w.fieldPath,E.endAt):Iy(E,w.fieldPath,E.endAt);U.push(y.value),B&&(B=y.inclusive)}return new ni(U,B)}(c,u),R=this.In(u,c,m),C=this.In(u,c,I),M=this.Tn(u,c,p),_=this.En(u.indexId,d,R,m.inclusive,C,I.inclusive,M);return N.forEach(_,v=>r.G(v,n.limit).next(E=>{E.forEach(O=>{const U=W.fromSegments(O.documentKey);o.has(U)||(o=o.add(U),l.push(U))})}))}).next(()=>l)}return N.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=hR(xe.create(e.filters,"and")).map(r=>Jd(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,l){const u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),d=[];for(let p=0;p<u;++p){const m=n?this.dn(n[p/c]):tu,I=this.An(e,m,r[p%c],i),R=this.Rn(e,m,s[p%c],o),C=l.map(M=>this.An(e,m,M,!0));d.push(...this.createRange(I,R,C))}return d}An(e,n,r,i){const s=new bi(e,W.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new bi(e,W.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new $y(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const l of s)r.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return N.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Ce(Ue.comparator),d=!1;for(const p of u.filters)for(const m of p.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?d=!0:c=c.add(m.field));for(const p of u.orderBy)p.field.isKeyField()||(c=c.add(p.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Zo;for(const i of ki(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Ni.vt.It(s,o)}return r.zt()}dn(e){const n=new Zo;return Ni.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Zo;return Ni.vt.It(Yi(this.databaseId,n),r.Yt(function(s){const o=ki(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Zo);let s=0;for(const o of ki(e)){const l=r[s++];for(const u of i)if(this.fn(n,o.fieldPath)&&Wa(l))i=this.gn(i,o,l);else{const c=u.Yt(o.kind);Ni.vt.It(l,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const l of i){const u=new Zo;u.seed(l.zt()),Ni.vt.It(o,u.Yt(n.kind)),s.push(u)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof ye&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ea(e),i=Ts(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return N.forEach(s,l=>i.get([l.indexId,this.uid]).next(u=>{o.push(function(d,p){const m=p?new io(p.sequenceNumber,new fn(ts(p.readTime),new W($n(p.documentKey)),p.largestBatchId)):io.empty(),I=d.fields.map(([R,C])=>new Ui(Ue.fromServerFormat(R),C));return new ro(d.indexId,d.collectionGroup,I,m)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:le(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ea(e),s=Ts(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>N.forEach(l,u=>s.put(Ly(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return N.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?N.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),N.forEach(l,u=>this.wn(e,i,u).next(c=>{const d=this.Sn(s,u);return c.isEqual(d)?N.resolve():this.bn(e,s,u,c,d)}))))})}Dn(e,n,r,i){return Es(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Es(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Es(e);let s=new Ce(Cr);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,l)=>{s=s.add(new bi(r.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>s)}Sn(e,n){let r=new Ce(Cr);const i=this.Vn(n,e);if(i==null)return r;const s=Gd(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Wa(o))for(const l of o.arrayValue.values||[])r=r.add(new bi(n.indexId,e.key,this.dn(l),i))}else r=r.add(new bi(n.indexId,e.key,tu,i));return r}bn(e,n,r,i,s){j("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(u,c,d,p,m){const I=u.getIterator(),R=c.getIterator();let C=ws(I),M=ws(R);for(;C||M;){let _=!1,v=!1;if(C&&M){const E=d(C,M);E<0?v=!0:E>0&&(_=!0)}else C!=null?v=!0:_=!0;_?(p(M),M=ws(R)):v?(m(C),C=ws(I)):(C=ws(I),M=ws(R))}}(i,s,Cr,l=>{o.push(this.Dn(e,n,r,l))},l=>{o.push(this.vn(e,n,r,l))}),N.waitFor(o)}yn(e){let n=1;return Ts(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>Cr(o,l)).filter((o,l,u)=>!l||Cr(o,u[l-1])!==0);const i=[];i.push(e);for(const o of r){const l=Cr(o,e),u=Cr(o,n);if(l===0)i[0]=e.Zt();else if(l>0&&u<0)i.push(o),i.push(o.Zt());else if(u>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const l=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,tu,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,tu,[]];s.push(IDBKeyRange.bound(l,u))}return s}Cn(e,n){return Cr(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(Gy)}getMinOffset(e,n){return N.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||X())).next(Gy)}}function Ky(t){return gt(t,"collectionParents")}function Es(t){return gt(t,"indexEntries")}function ea(t){return gt(t,"indexConfiguration")}function Ts(t){return gt(t,"indexState")}function Gy(t){ee(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;hp(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new fn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qy={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Bt{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Bt(e,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hE(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let l=0;const u=r.J({range:o},(d,p,m)=>(l++,m.delete()));s.push(u.next(()=>{ee(l===1)}));const c=[];for(const d of n.mutations){const p=uw(e,d.key.path,n.batchId);s.push(i.delete(p)),c.push(d.key)}return N.waitFor(s).next(()=>c)}function lc(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw X();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bt.DEFAULT_COLLECTION_PERCENTILE=10,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bt.DEFAULT=new Bt(41943040,Bt.DEFAULT_COLLECTION_PERCENTILE,Bt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bt.DISABLED=new Bt(-1,0,0);class Bc{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){ee(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Bc(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kr(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Rs(e),o=kr(e);return o.add({}).next(l=>{ee(typeof l=="number");const u=new vp(l,n,r,i),c=function(I,R,C){const M=C.baseMutations.map(v=>Xa(I.ct,v)),_=C.mutations.map(v=>Xa(I.ct,v));return{userId:R,batchId:C.batchId,localWriteTimeMs:C.localWriteTime.toMillis(),baseMutations:M,mutations:_}}(this.serializer,this.userId,u),d=[];let p=new Ce((m,I)=>le(m.canonicalString(),I.canonicalString()));for(const m of i){const I=uw(this.userId,m.key.path,l);p=p.add(m.key.path.popLast()),d.push(o.put(c)),d.push(s.put(I,tx))}return p.forEach(m=>{d.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[l]=u.keys()}),N.waitFor(d).next(()=>u)})}lookupMutationBatch(e,n){return kr(e).get(n).next(r=>r?(ee(r.userId===this.userId),Di(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?N.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return kr(e).J({index:"userMutationsIndex",range:i},(o,l,u)=>{l.userId===this.userId&&(ee(l.batchId>=r),s=Di(this.serializer,l)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return kr(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kr(e).U("userMutationsIndex",n).next(r=>r.map(i=>Di(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=vu(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Rs(e).J({range:i},(o,l,u)=>{const[c,d,p]=o,m=$n(d);if(c===this.userId&&n.path.isEqual(m))return kr(e).get(p).next(I=>{if(!I)throw X();ee(I.userId===this.userId),s.push(Di(this.serializer,I))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ce(le);const i=[];return n.forEach(s=>{const o=vu(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=Rs(e).J({range:l},(c,d,p)=>{const[m,I,R]=c,C=$n(I);m===this.userId&&s.path.isEqual(C)?r=r.add(R):p.done()});i.push(u)}),N.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=vu(this.userId,r),o=IDBKeyRange.lowerBound(s);let l=new Ce(le);return Rs(e).J({range:o},(u,c,d)=>{const[p,m,I]=u,R=$n(m);p===this.userId&&r.isPrefixOf(R)?R.length===i&&(l=l.add(I)):d.done()}).next(()=>this.xn(e,l))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(kr(e).get(s).next(o=>{if(o===null)throw X();ee(o.userId===this.userId),r.push(Di(this.serializer,o))}))}),N.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return hE(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),N.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return N.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Rs(e).J({range:r},(s,o,l)=>{if(s[0]===this.userId){const u=$n(s[1]);i.push(u)}else l.done()}).next(()=>{ee(i.length===0)})})}containsKey(e,n){return dE(e,this.userId,n)}Nn(e){return fE(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function dE(t,e,n){const r=vu(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Rs(t).J({range:s,H:!0},(l,u,c)=>{const[d,p,m]=l;d===e&&p===i&&(o=!0),c.done()}).next(()=>o)}function kr(t){return gt(t,"mutations")}function Rs(t){return gt(t,"documentMutations")}function fE(t){return gt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ns(0)}static kn(){return new ns(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ns(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>ne.fromTimestamp(new Xe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Is(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(ee(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Is(e).J((o,l)=>{const u=ca(l);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>N.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Is(e).J((r,i)=>{const s=ca(i);n(s)})}qn(e){return Wy(e).get("targetGlobalKey").next(n=>(ee(n!==null),n))}Qn(e,n){return Wy(e).put("targetGlobalKey",n)}Kn(e,n){return Is(e).put(lE(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Xi(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Is(e).J({range:i,index:"queryTargetsIndex"},(o,l,u)=>{const c=ca(l);al(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Or(e);return n.forEach(o=>{const l=zt(o.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,o))}),N.waitFor(i)}removeMatchingKeys(e,n,r){const i=Or(e);return N.forEach(n,s=>{const o=zt(s.path);return N.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Or(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Or(e);let s=ce();return i.J({range:r,H:!0},(o,l,u)=>{const c=$n(o[1]),d=new W(c);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=zt(n.path),i=IDBKeyRange.bound([r],[nw(r)],!1,!0);let s=0;return Or(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,l],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return Is(e).get(n).next(r=>r?ca(r):null)}}function Is(t){return gt(t,"targets")}function Wy(t){return gt(t,"targetGlobal")}function Or(t){return gt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy([t,e],[n,r]){const i=le(t,n);return i===0?le(e,r):i}class mR{constructor(e){this.Un=e,this.buffer=new Ce(Hy),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();Hy(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class pE{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){j("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ci(n)?j("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ui(n)}await this.Hn(3e5)})}}class gR{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return N.resolve(Zt.oe);const r=new mR(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(j("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(Qy)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(j("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Qy):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,l,u,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(j("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,l=Date.now(),this.removeTargets(e,r,n))).next(p=>(s=p,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(c=Date.now(),Ss()<=Ee.DEBUG&&j("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${p} documents in `+(c-u)+`ms
Total Duration: ${c-d}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function mE(t,e){return new gR(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e,n){this.db=e,this.garbageCollector=mE(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return nu(e,r)}removeReference(e,n,r){return nu(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return nu(e,n)}nr(e,n){return function(i,s){let o=!1;return fE(i).Y(l=>dE(i,l,s).next(u=>(u&&(o=!0),N.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,l)=>{if(l<=n){const u=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ne.min()),Or(e).delete(function(p){return[0,zt(p.path)]}(o))))});i.push(u)}}).next(()=>N.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return nu(e,n)}tr(e,n){const r=Or(e);let i,s=Zt.oe;return r.J({index:"documentTargetsIndex"},([o,l],{path:u,sequenceNumber:c})=>{o===0?(s!==Zt.oe&&n(new W($n(i)),s),s=c,i=u):s=Zt.oe}).next(()=>{s!==Zt.oe&&n(new W($n(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nu(t,e){return Or(t).put(function(r,i){return{targetId:0,path:zt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(){this.changes=new _r(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Fe.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?N.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return xi(e).put(r)}removeEntry(e,n,r){return xi(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],oc(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=Fe.newInvalidDocument(n);return xi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ta(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:Fe.newInvalidDocument(n)};return xi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ta(n))},(i,s)=>{r={document:this.ir(n,s),size:lc(s)}}).next(()=>r)}getEntries(e,n){let r=tn();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=tn(),i=new Ne(W.comparator);return this._r(e,n,(s,o)=>{const l=this.ir(s,o);r=r.insert(s,l),i=i.insert(s,lc(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return N.resolve();let i=new Ce(Jy);n.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(ta(i.first()),ta(i.last())),o=i.getIterator();let l=o.getNext();return xi(e).J({index:"documentKeyIndex",range:s},(u,c,d)=>{const p=W.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;l&&Jy(l,p)<0;)r(l,null),l=o.getNext();l&&l.isEqual(p)&&(r(l,c),l=o.hasNext()?o.getNext():null),l?d.$(ta(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),oc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return xi(e).U(IDBKeyRange.bound(l,u,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=tn();for(const p of c){const m=this.ir(W.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);m.isFoundDocument()&&(ul(n,m)||i.has(m.key))&&(d=d.insert(m.key,m))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=tn();const o=Xy(n,r),l=Xy(n,fn.max());return xi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(u,c,d)=>{const p=this.ir(W.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new vR(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Yy(e).get("remoteDocumentGlobalKey").next(n=>(ee(!!n),n))}rr(e,n){return Yy(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=iR(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(ne.min())))return r}return Fe.newInvalidDocument(e)}}function yE(t){return new _R(t)}class vR extends gE{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new _r(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ce((s,o)=>le(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=Oy(this.cr.serializer,o);i=i.add(s.path.popLast());const c=lc(u);r+=c-l.size,n.push(this.cr.addEntry(e,s,u))}else if(r-=l.size,this.trackRemovals){const u=Oy(this.cr.serializer,o.convertToNoDocument(ne.min()));n.push(this.cr.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),N.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function Yy(t){return gt(t,"remoteDocumentGlobal")}function xi(t){return gt(t,"remoteDocumentsV14")}function ta(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Xy(t,e){const n=e.documentKey.path.toArray();return[t,oc(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Jy(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=le(n[s],r[s]),i)return i;return i=le(n.length,r.length),i||(i=le(n[n.length-2],r[r.length-2]),i||le(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wR{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _E{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Ia(r.mutation,i,en.empty(),Xe.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ce()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ce()){const i=qn();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=la();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=qn();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ce()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,i){let s=tn();const o=Ta(),l=function(){return Ta()}();return n.forEach((u,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof vr)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Ia(d.mutation,c,d.mutation.getFieldMask(),Xe.now())):o.set(c.key,en.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var p;return l.set(c,new wR(d,(p=o.get(c))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=Ta();let i=new Ne((o,l)=>o-l),s=ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const c=n.get(u);if(c===null)return;let d=r.get(u)||en.empty();d=l.applyToLocalView(c,d),r.set(u,d);const p=(i.get(l.batchId)||ce()).add(u);i=i.insert(l.batchId,p)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),c=u.key,d=u.value,p=bw();d.forEach(m=>{if(!s.has(m)){const I=zw(n.get(m),r.get(m));I!==null&&p.set(m,I),s=s.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,p))}return N.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return W.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):mp(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):N.resolve(qn());let l=-1,u=s;return o.next(c=>N.forEach(c,(d,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(d)?N.resolve():this.remoteDocumentCache.getEntry(e,d).next(m=>{u=u.insert(d,m)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,ce())).next(d=>({batchId:l,changes:Nw(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new W(n)).next(r=>{let i=la();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=la();return this.indexManager.getCollectionParents(e,s).next(l=>N.forEach(l,u=>{const c=function(p,m){return new yr(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,Fe.newInvalidDocument(d)))});let l=la();return o.forEach((u,c)=>{const d=s.get(u);d!==void 0&&Ia(d.mutation,c,en.empty(),Xe.now()),ul(n,c)&&(l=l.insert(u,c))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return N.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:lt(i.createTime)}}(n)),N.resolve()}getNamedQuery(e,n){return N.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:Sp(i.bundledQuery),readTime:lt(i.readTime)}}(n)),N.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(){this.overlays=new Ne(W.comparator),this.Ir=new Map}getOverlay(e,n){return N.resolve(this.overlays.get(n))}getOverlays(e,n){const r=qn();return N.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),N.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),N.resolve()}getOverlaysForCollection(e,n,r){const i=qn(),s=n.length+1,o=new W(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return N.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ne((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=qn(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const l=qn(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,d)=>l.set(c,d)),!(l.size()>=i)););return N.resolve(l)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Ep(n,r));let s=this.Ir.get(n);s===void 0&&(s=ce(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IR{constructor(){this.sessionToken=it.EMPTY_BYTE_STRING}getSessionToken(e){return N.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,N.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rp{constructor(){this.Tr=new Ce(vt.Er),this.dr=new Ce(vt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new vt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new vt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new W(new ge([])),r=new vt(n,e),i=new vt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new W(new ge([])),r=new vt(n,e),i=new vt(n,e+1);let s=ce();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new vt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class vt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return W.comparator(e.key,n.key)||le(e.wr,n.wr)}static Ar(e,n){return le(e.wr,n.wr)||W.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ce(vt.Er)}checkEmpty(e){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new vp(s,n,r,i);this.mutationQueue.push(o);for(const l of i)this.br=this.br.add(new vt(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return N.resolve(o)}lookupMutationBatch(e,n){return N.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return N.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new vt(n,0),i=new vt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const l=this.Dr(o.wr);s.push(l)}),N.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ce(le);return n.forEach(i=>{const s=new vt(i,0),o=new vt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],l=>{r=r.add(l.wr)})}),N.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;W.isDocumentKey(s)||(s=s.child(""));const o=new vt(new W(s),0);let l=new Ce(le);return this.br.forEachWhile(u=>{const c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(l=l.add(u.wr)),!0)},o),N.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){ee(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return N.forEach(n.mutations,i=>{const s=new vt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new vt(n,0),i=this.br.firstAfterOrEqual(r);return N.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,N.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AR{constructor(e){this.Mr=e,this.docs=function(){return new Ne(W.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return N.resolve(r?r.document.mutableCopy():Fe.newInvalidDocument(n))}getEntries(e,n){let r=tn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Fe.newInvalidDocument(i))}),N.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=tn();const o=n.path,l=new W(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:c,value:{document:d}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||hp(iw(d),r)<=0||(i.has(d.key)||ul(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return N.resolve(s)}getAllFromCollectionGroup(e,n,r,i){X()}Or(e,n){return N.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new xR(this)}getSize(e){return N.resolve(this.size)}}class xR extends gE{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),N.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RR{constructor(e){this.persistence=e,this.Nr=new _r(n=>Xi(n),al),this.lastRemoteSnapshotVersion=ne.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Rp,this.targetCount=0,this.kr=ns.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),N.resolve()}getLastRemoteSnapshotVersion(e){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return N.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),N.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ns(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,N.resolve()}updateTargetData(e,n){return this.Kn(n),N.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,N.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),N.waitFor(s).next(()=>i)}getTargetCount(e){return N.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return N.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),N.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),N.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),N.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return N.resolve(r)}containsKey(e,n){return N.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pp{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Zt(0),this.Kr=!1,this.Kr=!0,this.$r=new IR,this.referenceDelegate=e(this),this.Ur=new RR(this),this.indexManager=new dR,this.remoteDocumentCache=function(i){return new AR(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new aE(n),this.Gr=new ER(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new TR,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new SR(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){j("MemoryPersistence","Starting transaction:",e);const i=new PR(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return N.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class PR extends ow{constructor(e){super(),this.currentSequenceNumber=e}}class jc{constructor(e){this.persistence=e,this.Jr=new Rp,this.Yr=null}static Zr(e){return new jc(e)}get Xr(){if(this.Yr)return this.Yr;throw X()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),N.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),N.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),N.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.Xr,r=>{const i=W.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,ne.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return N.or([()=>N.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}class uc{constructor(e,n){this.persistence=e,this.ti=new _r(r=>zt(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=mE(this,n)}static Zr(e,n){return new uc(e,n)}zr(){}jr(e){return N.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}Yn(e){const n=this.er(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}Zn(e,n){return N.forEach(this.ti,(r,i)=>this.nr(e,r,i).next(s=>s?N.resolve():n(i)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.Or(e,o=>this.nr(e,o,n).next(l=>{l||(r++,s.removeEntry(o,ne.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.ti.set(n,e.currentSequenceNumber),N.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),N.resolve()}removeReference(e,n,r){return this.ti.set(r,e.currentSequenceNumber),N.resolve()}updateLimboDocument(e,n){return this.ti.set(n,e.currentSequenceNumber),N.resolve()}Wr(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Eu(e.data.value)),n}nr(e,n,r){return N.or([()=>this.persistence.Hr(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const i=this.ti.get(n);return N.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e){this.serializer=e}O(e,n,r,i){const s=new Vc("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",dy,{unique:!0}),u.createObjectStore("documentMutations")}(e),Zy(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=N.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),Zy(e)),o=o.next(()=>function(u){const c=u.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ne.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").U().next(d=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",dy,{unique:!0});const p=c.store("mutations"),m=d.map(I=>p.put(I));return N.waitFor(m)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){const c=u.createObjectStore("documentOverlays",{keyPath:fx});c.createIndex("collectionPathOverlayIndex",px,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",mx,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){const c=u.createObjectStore("remoteDocumentsV14",{keyPath:nx});c.createIndex("documentKeyIndex",rx),c.createIndex("collectionGroupIndex",ix)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:ux}).createIndex("sequenceNumberIndex",cx,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:hx}).createIndex("documentKeyIndex",dx,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(u){u.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=lc(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>N.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(l=>N.forEach(l,u=>{ee(u.userId===s.userId);const c=Di(this.serializer,u);return hE(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,l)=>{const u=new ge(o),c=function(p){return[0,zt(p)]}(u);s.push(n.get(c).next(d=>d?N.resolve():(p=>n.put({targetId:0,path:zt(p),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>N.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:lx});const r=n.store("collectionParents"),i=new xp,s=o=>{if(i.add(o)){const l=o.lastSegment(),u=o.popLast();return r.put({collectionId:l,parent:zt(u)})}};return n.store("remoteDocuments").J({H:!0},(o,l)=>{const u=new ge(o);return s(u.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,l,u],c)=>{const d=$n(l);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=ca(i),o=lE(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const l=n.store("remoteDocumentsV14"),u=function(p){return p.document?new W(ge.fromString(p.document.name).popFirst(5)):p.noDocument?W.fromSegments(p.noDocument.path):p.unknownDocument?W.fromSegments(p.unknownDocument.path):X()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(c))}).next(()=>N.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=yE(this.serializer),s=new Pp(jc.Zr,this.serializer.ct);return r.U().next(o=>{const l=new Map;return o.forEach(u=>{var c;let d=(c=l.get(u.userId))!==null&&c!==void 0?c:ce();Di(this.serializer,u).keys().forEach(p=>d=d.add(p)),l.set(u.userId,d)}),N.forEach(l,(u,c)=>{const d=new Et(c),p=Lc.lt(this.serializer,d),m=s.getIndexManager(d),I=Bc.lt(d,this.serializer,m,s.referenceDelegate);return new _E(i,I,p,m).recalculateAndSaveOverlaysForDocumentKeys(new Qd(n,Zt.oe),u).next()})})}}function Zy(t){t.createObjectStore("targetDocuments",{keyPath:ox}).createIndex("documentTargetsIndex",ax,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",sx,{unique:!0}),t.createObjectStore("targetGlobal")}const $h="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Cp{constructor(e,n,r,i,s,o,l,u,c,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=l,this.ci=c,this.li=d,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!Cp.D())throw new z(b.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new yR(this,i),this.Ai=n+"main",this.serializer=new aE(u),this.Ri=new Qn(this.Ai,this.hi,new CR(this.serializer)),this.$r=new oR,this.Ur=new pR(this.referenceDelegate,this.serializer),this.remoteDocumentCache=yE(this.serializer),this.Gr=new sR,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&at("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new z(b.FAILED_PRECONDITION,$h);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Zt(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ru(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(ci(e))return j("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return j("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return na(e).get("owner").next(n=>N.resolve(this.vi(n)))}Ci(e){return ru(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=gt(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(l=>s.indexOf(l)===-1);return N.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?N.resolve(!0):na(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new z(b.FAILED_PRECONDITION,$h);return!1}}return!(!this.networkEnabled||!this.inForeground)||ru(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&j("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Qd(e,Zt.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ru(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Bc.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fR(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Lc.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){j("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===17?_x:u===16?yx:u===15?fp:u===14?dw:u===13?hw:u===12?gx:u===11?cw:void X()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,l=>(o=new Qd(l,this.Qr?this.Qr.next():Zt.oe),n==="readwrite-primary"?this.wi(o).next(u=>!!u||this.Si(o)).next(u=>{if(!u)throw at(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new z(b.FAILED_PRECONDITION,sw);return r(o)}).next(u=>this.Di(o).next(()=>u)):this.Ki(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return na(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new z(b.FAILED_PRECONDITION,$h)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return na(e).put("owner",n)}static D(){return Qn.D()}bi(e){const n=na(e);return n.get("owner").next(r=>this.vi(r)?(j("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):N.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(at(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;L0()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return j("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return at("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){at("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function na(t){return gt(t,"owner")}function ru(t){return gt(t,"clientMetadata")}function kp(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vp{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=ce(),i=ce();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Vp(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kR{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vE{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return L0()?8:aw(Ju())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new kR;return this.Xi(e,n,o).next(l=>{if(s.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Ss()<=Ee.DEBUG&&j("QueryEngine","SDK will not create cache indexes for query:",As(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),N.resolve()):(Ss()<=Ee.DEBUG&&j("QueryEngine","Query:",As(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Ss()<=Ee.DEBUG&&j("QueryEngine","The SDK decides to create cache indexes for query:",As(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ut(n))):N.resolve())}Yi(e,n){if(Ay(n))return N.resolve(null);let r=Ut(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=ic(n,null,"F"),r=Ut(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=ce(...s);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const c=this.ts(n,l);return this.ns(n,c,o,u.readTime)?this.Yi(e,ic(n,null,"F")):this.rs(e,c,n,u)}))})))}Zi(e,n,r,i){return Ay(n)||i.isEqual(ne.min())?N.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?N.resolve(null):(Ss()<=Ee.DEBUG&&j("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),As(n)),this.rs(e,o,n,rw(i,-1)).next(l=>l))})}ts(e,n){let r=new Ce(Vw(e));return n.forEach((i,s)=>{ul(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Ss()<=Ee.DEBUG&&j("QueryEngine","Using full collection scan to execute query:",As(n)),this.Ji.getDocumentsMatchingQuery(e,n,fn.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Ne(le),this._s=new _r(s=>Xi(s),al),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new _E(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function wE(t,e,n,r){return new VR(t,e,n,r)}async function EE(t,e){const n=K(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let u=ce();for(const c of i){o.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}for(const c of s){l.push(c.batchId);for(const d of c.mutations)u=u.add(d.key)}return n.localDocuments.getDocuments(r,u).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:l}))})})}function DR(t,e){const n=K(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,c,d){const p=c.batch,m=p.keys();let I=N.resolve();return m.forEach(R=>{I=I.next(()=>d.getEntry(u,R)).next(C=>{const M=c.docVersions.get(R);ee(M!==null),C.version.compareTo(M)<0&&(p.applyToRemoteDocument(C,c),C.isValidDocument()&&(C.setReadTime(c.commitVersion),d.addEntry(C)))})}),I.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=ce();for(let c=0;c<l.mutationResults.length;++c)l.mutationResults[c].transformResults.length>0&&(u=u.add(l.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function TE(t){const e=K(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function NR(t,e){const n=K(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const l=[];e.targetChanges.forEach((d,p)=>{const m=i.get(p);if(!m)return;l.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,p)));let I=m.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?I=I.withResumeToken(it.EMPTY_BYTE_STRING,ne.min()).withLastLimboFreeSnapshotVersion(ne.min()):d.resumeToken.approximateByteSize()>0&&(I=I.withResumeToken(d.resumeToken,r)),i=i.insert(p,I),function(C,M,_){return C.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-C.snapshotVersion.toMicroseconds()>=3e8?!0:_.addedDocuments.size+_.modifiedDocuments.size+_.removedDocuments.size>0}(m,I,d)&&l.push(n.Ur.updateTargetData(s,I))});let u=tn(),c=ce();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),l.push(IE(s,o,e.documentUpdates).next(d=>{u=d.Ps,c=d.Is})),!r.isEqual(ne.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(p=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(d)}return N.waitFor(l).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.os=i,s))}function IE(t,e,n){let r=ce(),i=ce();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=tn();return n.forEach((l,u)=>{const c=s.get(l);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(ne.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):j("LocalStore","Ignoring outdated watch update for ",l,". Current version:",c.version," Watch version:",u.version)}),{Ps:o,Is:i}})}function bR(t,e){const n=K(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function co(t,e){const n=K(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,N.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new ar(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function ho(t,e,n){const r=K(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ci(o))throw o;j("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function cc(t,e,n){const r=K(t);let i=ne.min(),s=ce();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,d){const p=K(u),m=p._s.get(d);return m!==void 0?N.resolve(p.os.get(m)):p.Ur.getTargetData(c,d)}(r,o,Ut(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:ne.min(),n?s:ce())).next(l=>(xE(r,kw(e),l),{documents:l,Ts:s})))}function SE(t,e){const n=K(t),r=K(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function AE(t,e){const n=K(t),r=n.us.get(e)||ne.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,rw(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(xE(n,e,i),i))}function xE(t,e,n){let r=t.us.get(e)||ne.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}async function MR(t,e,n,r){const i=K(t);let s=ce(),o=tn();for(const c of n){const d=e.Es(c.metadata.name);c.document&&(s=s.add(d));const p=e.ds(c);p.setReadTime(e.As(c.metadata.readTime)),o=o.insert(d,p)}const l=i.cs.newChangeBuffer({trackRemovals:!0}),u=await co(i,function(d){return Ut(So(ge.fromString(`__bundle__/docs/${d}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>IE(c,l,o).next(d=>(l.apply(c),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Ur.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,d.Ps,d.Is)).next(()=>d.Ps)))}async function OR(t,e,n=ce()){const r=await co(t,Ut(Sp(e.bundledQuery))),i=K(t);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=lt(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Gr.saveNamedQuery(s,e);const l=r.withResumeToken(it.EMPTY_BYTE_STRING,o);return i.os=i.os.insert(l.targetId,l),i.Ur.updateTargetData(s,l).next(()=>i.Ur.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ur.addMatchingKeys(s,n,r.targetId)).next(()=>i.Gr.saveNamedQuery(s,e))})}function e_(t,e){return`firestore_clients_${t}_${e}`}function t_(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function qh(t,e){return`firestore_targets_${t}_${e}`}class hc{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new z(i.error.code,i.error.message))),o?new hc(e,n,i.state,s):(at("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sa{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new z(r.error.code,r.error.message))),s?new Sa(e,r.state,i):(at("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class dc{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=gp();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=lw(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new dc(e,s):(at("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Dp{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Dp(n.clientId,n.onlineState):(at("SharedClientState",`Failed to parse online state: ${e}`),null)}}class lf{constructor(){this.activeTargetIds=gp()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Kh{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ne(le),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=e_(this.persistenceKey,this.ps),this.vs=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new lf),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Os=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(e_(this.persistenceKey,r));if(i){const s=dc.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(qh(this.persistenceKey,e));if(i){const s=Sa.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(qh(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return j("SharedClientState","READ",e,n),n}setItem(e,n){j("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){j("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(j("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void at("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let o=Zt.oe;if(s!=null)try{const l=JSON.parse(s);ee(typeof l=="number"),o=l}catch(l){at("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(n.newValue);r!==Zt.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new hc(this.currentUser,e,n,r),s=t_(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=t_(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=qh(this.persistenceKey,e),s=new Sa(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return dc.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return hc.Rs(new Et(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return Sa.Rs(i,n)}Ls(e){return Dp.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);j("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],l=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||l.push(u)}),this.syncEngine.io(o,l).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=gp();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class RE{constructor(){this.so=new lf,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new lf,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FR{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){j("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){j("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iu=null;function Gh(){return iu===null?iu=function(){return 268435456+Math.round(2147483648*Math.random())}():iu++,"0x"+iu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LR={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lt="WebChannelConnection";class jR extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const l=Gh(),u=this.xo(n,r.toUriEncodedString());j("RestConnection",`Sending RPC '${n}' ${l}:`,u,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,u,c,i).then(d=>(j("RestConnection",`Received RPC '${n}' ${l}: `,d),d),d=>{throw Sn("RestConnection",`RPC '${n}' ${l} failed with error: `,d,"url: ",u,"request:",i),d})}Lo(n,r,i,s,o,l){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Io}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=LR[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Gh();return new Promise((o,l)=>{const u=new W0;u.setWithCredentials(!0),u.listenOnce(H0.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case _u.NO_ERROR:const d=u.getResponseJson();j(Lt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case _u.TIMEOUT:j(Lt,`RPC '${e}' ${s} timed out`),l(new z(b.DEADLINE_EXCEEDED,"Request time out"));break;case _u.HTTP_ERROR:const p=u.getStatus();if(j(Lt,`RPC '${e}' ${s} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const I=m==null?void 0:m.error;if(I&&I.status&&I.message){const R=function(M){const _=M.toLowerCase().replace(/_/g,"-");return Object.values(b).indexOf(_)>=0?_:b.UNKNOWN}(I.status);l(new z(R,I.message))}else l(new z(b.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new z(b.UNAVAILABLE,"Connection failed."));break;default:X()}}finally{j(Lt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);j(Lt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=Gh(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=J0(),l=X0(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const d=s.join("");j(Lt,`Creating RPC '${e}' stream ${i}: ${d}`,u);const p=o.createWebChannel(d,u);let m=!1,I=!1;const R=new BR({Io:M=>{I?j(Lt,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(m||(j(Lt,`Opening RPC '${e}' stream ${i} transport.`),p.open(),m=!0),j(Lt,`RPC '${e}' stream ${i} sending:`,M),p.send(M))},To:()=>p.close()}),C=(M,_,v)=>{M.listen(_,E=>{try{v(E)}catch(O){setTimeout(()=>{throw O},0)}})};return C(p,aa.EventType.OPEN,()=>{I||(j(Lt,`RPC '${e}' stream ${i} transport opened.`),R.yo())}),C(p,aa.EventType.CLOSE,()=>{I||(I=!0,j(Lt,`RPC '${e}' stream ${i} transport closed`),R.So())}),C(p,aa.EventType.ERROR,M=>{I||(I=!0,Sn(Lt,`RPC '${e}' stream ${i} transport errored:`,M),R.So(new z(b.UNAVAILABLE,"The operation could not be completed")))}),C(p,aa.EventType.MESSAGE,M=>{var _;if(!I){const v=M.data[0];ee(!!v);const E=v,O=E.error||((_=E[0])===null||_===void 0?void 0:_.error);if(O){j(Lt,`RPC '${e}' stream ${i} received error:`,O);const U=O.status;let B=function(T){const A=ht[T];if(A!==void 0)return Kw(A)}(U),w=O.message;B===void 0&&(B=b.INTERNAL,w="Unknown error status: "+U+" with message "+O.message),I=!0,R.So(new z(B,w)),p.close()}else j(Lt,`RPC '${e}' stream ${i} received:`,v),R.bo(v)}}),C(l,Y0.STAT_EVENT,M=>{M.stat===Kd.PROXY?j(Lt,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===Kd.NOPROXY&&j(Lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{R.wo()},0),R}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PE(){return typeof window<"u"?window:null}function Au(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fl(t){return new Wx(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Np{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&j("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CE{constructor(e,n,r,i,s,o,l,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Np(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===b.RESOURCE_EXHAUSTED?(at(n.toString()),at("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===b.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new z(b.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return j("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(j("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class zR extends CE{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=Xx(this.serializer,e),r=function(s){if(!("targetChange"in s))return ne.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ne.min():o.readTime?lt(o.readTime):ne.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=nf(this.serializer),n.addTarget=function(s,o){let l;const u=o.target;if(l=nc(u)?{documents:tE(s,u)}:{query:Fc(s,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Hw(s,o.resumeToken);const c=ef(s,o.expectedCount);c!==null&&(l.expectedCount=c)}else if(o.snapshotVersion.compareTo(ne.min())>0){l.readTime=uo(s,o.snapshotVersion.toTimestamp());const c=ef(s,o.expectedCount);c!==null&&(l.expectedCount=c)}return l}(this.serializer,e);const r=Zx(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=nf(this.serializer),n.removeTarget=e,this.a_(n)}}class UR extends CE{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ee(!!e.streamToken),this.lastStreamToken=e.streamToken,ee(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ee(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=Jx(e.writeResults,e.commitTime),r=lt(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=nf(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Xa(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $R extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new z(b.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,tf(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new z(b.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,tf(n,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===b.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new z(b.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class qR{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(at(n),this.D_=!1):j("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{di(this)&&(j("RemoteStore","Restarting streams for network reachability change."),await async function(u){const c=K(u);c.L_.add(4),await Ro(c),c.q_.set("Unknown"),c.L_.delete(4),await pl(c)}(this))})}),this.q_=new qR(r,i)}}async function pl(t){if(di(t))for(const e of t.B_)await e(!0)}async function Ro(t){for(const e of t.B_)await e(!1)}function zc(t,e){const n=K(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Op(n)?Mp(n):Co(n).r_()&&bp(n,e))}function fo(t,e){const n=K(t),r=Co(n);n.N_.delete(e),r.r_()&&kE(n,e),n.N_.size===0&&(r.r_()?r.o_():di(n)&&n.q_.set("Unknown"))}function bp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ne.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Co(t).A_(e)}function kE(t,e){t.Q_.xe(e),Co(t).R_(e)}function Mp(t){t.Q_=new qx({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Co(t).start(),t.q_.v_()}function Op(t){return di(t)&&!Co(t).n_()&&t.N_.size>0}function di(t){return K(t).L_.size===0}function VE(t){t.Q_=void 0}async function GR(t){t.q_.set("Online")}async function QR(t){t.N_.forEach((e,n)=>{bp(t,e)})}async function WR(t,e){VE(t),Op(t)?(t.q_.M_(e),Mp(t)):t.q_.set("Unknown")}async function HR(t,e,n){if(t.q_.set("Online"),e instanceof Ww&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.N_.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.N_.delete(l),i.Q_.removeTarget(l))}(t,e)}catch(r){j("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await fc(t,r)}else if(e instanceof Su?t.Q_.Ke(e):e instanceof Qw?t.Q_.He(e):t.Q_.We(e),!n.isEqual(ne.min()))try{const r=await TE(t.localStore);n.compareTo(r)>=0&&await function(s,o){const l=s.Q_.rt(o);return l.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,c)=>{const d=s.N_.get(u);if(!d)return;s.N_.set(u,d.withResumeToken(it.EMPTY_BYTE_STRING,d.snapshotVersion)),kE(s,u);const p=new ar(d.target,u,c,d.sequenceNumber);bp(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){j("RemoteStore","Failed to raise snapshot:",r),await fc(t,r)}}async function fc(t,e,n){if(!ci(e))throw e;t.L_.add(1),await Ro(t),t.q_.set("Offline"),n||(n=()=>TE(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{j("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await pl(t)})}function DE(t,e){return e().catch(n=>fc(t,n,e))}async function Po(t){const e=K(t),n=ri(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;YR(e);)try{const i=await bR(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,XR(e,i)}catch(i){await fc(e,i)}NE(e)&&bE(e)}function YR(t){return di(t)&&t.O_.length<10}function XR(t,e){t.O_.push(e);const n=ri(t);n.r_()&&n.V_&&n.m_(e.mutations)}function NE(t){return di(t)&&!ri(t).n_()&&t.O_.length>0}function bE(t){ri(t).start()}async function JR(t){ri(t).p_()}async function ZR(t){const e=ri(t);for(const n of t.O_)e.m_(n.mutations)}async function eP(t,e,n){const r=t.O_.shift(),i=wp.from(r,e,n);await DE(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Po(t)}async function tP(t,e){e&&ri(t).V_&&await async function(r,i){if(function(o){return qw(o)&&o!==b.ABORTED}(i.code)){const s=r.O_.shift();ri(r).s_(),await DE(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Po(r)}}(t,e),NE(t)&&bE(t)}async function r_(t,e){const n=K(t);n.asyncQueue.verifyOperationInProgress(),j("RemoteStore","RemoteStore received new credentials");const r=di(n);n.L_.add(3),await Ro(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await pl(n)}async function uf(t,e){const n=K(t);e?(n.L_.delete(2),await pl(n)):e||(n.L_.add(2),await Ro(n),n.q_.set("Unknown"))}function Co(t){return t.K_||(t.K_=function(n,r,i){const s=K(n);return s.w_(),new zR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:GR.bind(null,t),Ro:QR.bind(null,t),mo:WR.bind(null,t),d_:HR.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Op(t)?Mp(t):t.q_.set("Unknown")):(await t.K_.stop(),VE(t))})),t.K_}function ri(t){return t.U_||(t.U_=function(n,r,i){const s=K(n);return s.w_(),new UR(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:JR.bind(null,t),mo:tP.bind(null,t),f_:ZR.bind(null,t),g_:eP.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Po(t)):(await t.U_.stop(),t.O_.length>0&&(j("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fp{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new It,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,l=new Fp(e,n,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new z(b.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ko(t,e){if(at("AsyncQueue",`${e}: ${t}`),ci(t))return new z(b.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(e){this.comparator=e?(n,r)=>e(n,r)||W.comparator(n.key,r.key):(n,r)=>W.comparator(n.key,r.key),this.keyedMap=la(),this.sortedSet=new Ne(this.comparator)}static emptySet(e){return new Ws(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ws)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ws;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i_{constructor(){this.W_=new Ne(W.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):X():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class po{constructor(e,n,r,i,s,o,l,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new po(e,n,Ws.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ll(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class rP{constructor(){this.queries=s_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=K(n),s=i.queries;i.queries=s_(),s.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new z(b.ABORTED,"Firestore shutting down"))}}function s_(){return new _r(t=>Cw(t),ll)}async function Lp(t,e){const n=K(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new nP,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const l=ko(o,`Initialization of query '${As(e.query)}' failed`);return void e.onError(l)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&jp(n)}async function Bp(t,e){const n=K(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function iP(t,e){const n=K(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const l of o.j_)l.X_(i)&&(r=!0);o.z_=i}}r&&jp(n)}function sP(t,e,n){const r=K(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function jp(t){t.Y_.forEach(e=>{e.next()})}var cf,o_;(o_=cf||(cf={})).ea="default",o_.Cache="cache";class zp{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new po(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=po.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cf.Cache}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,n){this.aa=e,this.byteLength=n}ua(){return"metadata"in this.aa}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a_{constructor(e){this.serializer=e}Es(e){return Wn(this.serializer,e)}ds(e){return e.metadata.exists?eE(this.serializer,e.document,!1):Fe.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return lt(e)}}class aP{constructor(e,n,r){this.ca=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ME(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++n;const r=ge.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ha(e){const n=new Map,r=new a_(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Es(i.metadata.name);for(const o of i.metadata.queries){const l=(n.get(o)||ce()).add(s);n.set(o,l)}}return n}async complete(){const e=await MR(this.localStore,new a_(this.serializer),this.documents,this.ca.id),n=this.ha(this.documents);for(const r of this.queries)await OR(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function ME(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e){this.key=e}}class FE{constructor(e){this.key=e}}class LE{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=ce(),this.mutatedKeys=ce(),this.Aa=Vw(e),this.Ra=new Ws(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new i_,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const m=i.get(d),I=ul(this.query,p)?p:null,R=!!m&&this.mutatedKeys.has(m.key),C=!!I&&(I.hasLocalMutations||this.mutatedKeys.has(I.key)&&I.hasCommittedMutations);let M=!1;m&&I?m.data.isEqual(I.data)?R!==C&&(r.track({type:3,doc:I}),M=!0):this.ga(m,I)||(r.track({type:2,doc:I}),M=!0,(u&&this.Aa(I,u)>0||c&&this.Aa(I,c)<0)&&(l=!0)):!m&&I?(r.track({type:0,doc:I}),M=!0):m&&!I&&(r.track({type:1,doc:m}),M=!0,(u||c)&&(l=!0)),M&&(I?(o=o.add(I),s=C?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:l,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,p)=>function(I,R){const C=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return X()}};return C(I)-C(R)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=i!=null&&i;const l=n&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,c=u!==this.Ea;return this.Ea=u,o.length!==0||c?{snapshot:new po(this.query,e.Ra,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new i_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=ce(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new FE(r))}),this.da.forEach(r=>{e.has(r)||n.push(new OE(r))}),n}ba(e){this.Ta=e.Ts,this.da=ce();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return po.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class lP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class uP{constructor(e){this.key=e,this.va=!1}}class cP{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new _r(l=>Cw(l),ll),this.Ma=new Map,this.xa=new Set,this.Oa=new Ne(W.comparator),this.Na=new Map,this.La=new Rp,this.Ba={},this.ka=new Map,this.qa=ns.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function hP(t,e,n=!0){const r=Uc(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await BE(r,e,n,!0),i}async function dP(t,e){const n=Uc(t);await BE(n,e,!0,!1)}async function BE(t,e,n,r){const i=await co(t.localStore,Ut(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let l;return r&&(l=await Up(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&zc(t.remoteStore,i),l}async function Up(t,e,n,r,i){t.Ka=(p,m,I)=>async function(C,M,_,v){let E=M.view.ma(_);E.ns&&(E=await cc(C.localStore,M.query,!1).then(({documents:w})=>M.view.ma(w,E)));const O=v&&v.targetChanges.get(M.targetId),U=v&&v.targetMismatches.get(M.targetId)!=null,B=M.view.applyChanges(E,C.isPrimaryClient,O,U);return hf(C,M.targetId,B.wa),B.snapshot}(t,p,m,I);const s=await cc(t.localStore,e,!0),o=new LE(e,s.Ts),l=o.ma(s.documents),u=dl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(l,t.isPrimaryClient,u);hf(t,n,c.wa);const d=new lP(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function fP(t,e,n){const r=K(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!ll(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ho(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&fo(r.remoteStore,i.targetId),mo(r,i.targetId)}).catch(ui)):(mo(r,i.targetId),await ho(r.localStore,i.targetId,!0))}async function pP(t,e){const n=K(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),fo(n.remoteStore,r.targetId))}async function mP(t,e,n){const r=Gp(t);try{const i=await function(o,l){const u=K(o),c=Xe.now(),d=l.reduce((I,R)=>I.add(R.key),ce());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",I=>{let R=tn(),C=ce();return u.cs.getEntries(I,d).next(M=>{R=M,R.forEach((_,v)=>{v.isValidDocument()||(C=C.add(_))})}).next(()=>u.localDocuments.getOverlayedDocuments(I,R)).next(M=>{p=M;const _=[];for(const v of l){const E=zx(v,p.get(v.key).overlayedDocument);E!=null&&_.push(new vr(v.key,E,_w(E.value.mapValue),$e.exists(!0)))}return u.mutationQueue.addMutationBatch(I,c,_,l)}).next(M=>{m=M;const _=M.applyToLocalDocumentSet(p,C);return u.documentOverlayCache.saveOverlays(I,M.batchId,_)})}).then(()=>({batchId:m.batchId,changes:Nw(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let c=o.Ba[o.currentUser.toKey()];c||(c=new Ne(le)),c=c.insert(l,u),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await wr(r,i.changes),await Po(r.remoteStore)}catch(i){const s=ko(i,"Failed to persist write");n.reject(s)}}async function jE(t,e){const n=K(t);try{const r=await NR(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(ee(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?ee(o.va):i.removedDocuments.size>0&&(ee(o.va),o.va=!1))}),await wr(n,r,e)}catch(r){await ui(r)}}function l_(t,e,n){const r=K(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const l=o.view.Z_(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=K(o);u.onlineState=l;let c=!1;u.queries.forEach((d,p)=>{for(const m of p.j_)m.Z_(l)&&(c=!0)}),c&&jp(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function gP(t,e,n){const r=K(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ne(W.comparator);o=o.insert(s,Fe.newNoDocument(s,ne.min()));const l=ce().add(s),u=new hl(ne.min(),new Map,new Ne(le),o,l);await jE(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),Kp(r)}else await ho(r.localStore,e,!1).then(()=>mo(r,e,n)).catch(ui)}async function yP(t,e){const n=K(t),r=e.batch.batchId;try{const i=await DR(n.localStore,e);qp(n,r,null),$p(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await wr(n,i)}catch(i){await ui(i)}}async function _P(t,e,n){const r=K(t);try{const i=await function(o,l){const u=K(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return u.mutationQueue.lookupMutationBatch(c,l).next(p=>(ee(p!==null),d=p.keys(),u.mutationQueue.removeMutationBatch(c,p))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,d,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>u.localDocuments.getDocuments(c,d))})}(r.localStore,e);qp(r,e,n),$p(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await wr(r,i)}catch(i){await ui(i)}}async function vP(t,e){const n=K(t);di(n.remoteStore)||j("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(o){const l=K(o);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>l.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();const i=n.ka.get(r)||[];i.push(e),n.ka.set(r,i)}catch(r){const i=ko(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function $p(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function qp(t,e,n){const r=K(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function mo(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||zE(t,r)})}function zE(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(fo(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Kp(t))}function hf(t,e,n){for(const r of n)r instanceof OE?(t.La.addReference(r.key,e),wP(t,r)):r instanceof FE?(j("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||zE(t,r.key)):X()}function wP(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(j("SyncEngine","New document in limbo: "+n),t.xa.add(r),Kp(t))}function Kp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new W(ge.fromString(e)),r=t.qa.next();t.Na.set(r,new uP(n)),t.Oa=t.Oa.insert(n,r),zc(t.remoteStore,new ar(Ut(So(n.path)),r,"TargetPurposeLimboResolution",Zt.oe))}}async function wr(t,e,n){const r=K(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const p=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(c){i.push(c);const p=Vp.Wi(u.targetId,c);s.push(p)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(u,c){const d=K(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>N.forEach(c,m=>N.forEach(m.$i,I=>d.persistence.referenceDelegate.addReference(p,m.targetId,I)).next(()=>N.forEach(m.Ui,I=>d.persistence.referenceDelegate.removeReference(p,m.targetId,I)))))}catch(p){if(!ci(p))throw p;j("LocalStore","Failed to update sequence numbers: "+p)}for(const p of c){const m=p.targetId;if(!p.fromCache){const I=d.os.get(m),R=I.snapshotVersion,C=I.withLastLimboFreeSnapshotVersion(R);d.os=d.os.insert(m,C)}}}(r.localStore,s))}async function EP(t,e){const n=K(t);if(!n.currentUser.isEqual(e)){j("SyncEngine","User change. New user:",e.toKey());const r=await EE(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(l=>{l.forEach(u=>{u.reject(new z(b.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await wr(n,r.hs)}}function TP(t,e){const n=K(t),r=n.Na.get(e);if(r&&r.va)return ce().add(r.key);{let i=ce();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const l=n.Fa.get(o);i=i.unionWith(l.view.Va)}return i}}async function IP(t,e){const n=K(t),r=await cc(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&hf(n,e.targetId,i.wa),i}async function SP(t,e){const n=K(t);return AE(n.localStore,e).then(r=>wr(n,r))}async function AP(t,e,n,r){const i=K(t),s=await function(l,u){const c=K(l),d=K(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",p=>d.Mn(p,u).next(m=>m?c.localDocuments.getDocuments(p,m):N.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Po(i.remoteStore):n==="acknowledged"||n==="rejected"?(qp(i,e,r||null),$p(i,e),function(l,u){K(K(l).mutationQueue).On(u)}(i.localStore,e)):X(),await wr(i,s)):j("SyncEngine","Cannot apply mutation batch with id: "+e)}async function xP(t,e){const n=K(t);if(Uc(n),Gp(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await u_(n,r.toArray());n.Qa=!0,await uf(n.remoteStore,!0);for(const s of i)zc(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(mo(n,o),ho(n.localStore,o,!0))),fo(n.remoteStore,o)}),await i,await u_(n,r),function(o){const l=K(o);l.Na.forEach((u,c)=>{fo(l.remoteStore,c)}),l.La.pr(),l.Na=new Map,l.Oa=new Ne(W.comparator)}(n),n.Qa=!1,await uf(n.remoteStore,!1)}}async function u_(t,e,n){const r=K(t),i=[],s=[];for(const o of e){let l;const u=r.Ma.get(o);if(u&&u.length!==0){l=await co(r.localStore,Ut(u[0]));for(const c of u){const d=r.Fa.get(c),p=await IP(r,d);p.snapshot&&s.push(p.snapshot)}}else{const c=await SE(r.localStore,o);l=await co(r.localStore,c),await Up(r,UE(c),o,!1,l.resumeToken)}i.push(l)}return r.Ca.d_(s),i}function UE(t){return xw(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function RP(t){return function(n){return K(K(n).persistence).Qi()}(K(t).localStore)}async function PP(t,e,n,r){const i=K(t);if(i.Qa)return void j("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await AE(i.localStore,kw(s[0])),l=hl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",it.EMPTY_BYTE_STRING);await wr(i,o,l);break}case"rejected":await ho(i.localStore,e,!0),mo(i,e,r);break;default:X()}}async function CP(t,e,n){const r=Uc(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){j("SyncEngine","Adding an already active target "+i);continue}const s=await SE(r.localStore,i),o=await co(r.localStore,s);await Up(r,UE(s),o.targetId,!1,o.resumeToken),zc(r.remoteStore,o)}for(const i of n)r.Ma.has(i)&&await ho(r.localStore,i,!1).then(()=>{fo(r.remoteStore,i),mo(r,i)}).catch(ui)}}function Uc(t){const e=K(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=gP.bind(null,e),e.Ca.d_=iP.bind(null,e.eventManager),e.Ca.$a=sP.bind(null,e.eventManager),e}function Gp(t){const e=K(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_P.bind(null,e),e}function kP(t,e,n){const r=K(t);(async function(s,o,l){try{const u=await o.getMetadata();if(await function(I,R){const C=K(I),M=lt(R.createTime);return C.persistence.runTransaction("hasNewerBundle","readonly",_=>C.Gr.getBundleMetadata(_,R.id)).then(_=>!!_&&_.createTime.compareTo(M)>=0)}(s.localStore,u))return await o.close(),l._completeWith(function(I){return{taskState:"Success",documentsLoaded:I.totalDocuments,bytesLoaded:I.totalBytes,totalDocuments:I.totalDocuments,totalBytes:I.totalBytes}}(u)),Promise.resolve(new Set);l._updateProgress(ME(u));const c=new aP(u,s.localStore,o.serializer);let d=await o.Ua();for(;d;){const m=await c.la(d);m&&l._updateProgress(m),d=await o.Ua()}const p=await c.complete();return await wr(s,p.Ia,void 0),await function(I,R){const C=K(I);return C.persistence.runTransaction("Save bundle","readwrite",M=>C.Gr.saveBundleMetadata(M,R))}(s.localStore,u),l._completeWith(p.progress),Promise.resolve(p.Pa)}catch(u){return Sn("SyncEngine",`Loading bundle failed with ${u}`),l._failWith(u),Promise.resolve(new Set)}})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}class ii{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=fl(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return wE(this.persistence,new vE,e.initialUser,this.serializer)}Ga(e){return new Pp(jc.Zr,this.serializer)}Wa(e){return new RE}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ii.provider={build:()=>new ii};class VP extends ii{constructor(e){super(),this.cacheSizeBytes=e}ja(e,n){ee(this.persistence.referenceDelegate instanceof uc);const r=this.persistence.referenceDelegate.garbageCollector;return new pE(r,e.asyncQueue,n)}Ga(e){const n=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new Pp(r=>uc.Zr(r,n),this.serializer)}}class Qp extends ii{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Gp(this.Ja.syncEngine),await Po(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return wE(this.persistence,new vE,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new pE(r,e.asyncQueue,n)}Ha(e,n){const r=new ZA(n,this.persistence);return new JA(e.asyncQueue,r)}Ga(e){const n=kp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Bt.withCacheSize(this.cacheSizeBytes):Bt.DEFAULT;return new Cp(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,PE(),Au(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new RE}}class $E extends Qp{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Kh&&(this.sharedClientState.syncEngine={no:AP.bind(null,n),ro:PP.bind(null,n),io:CP.bind(null,n),Qi:RP.bind(null,n),eo:SP.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await xP(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=PE();if(!Kh.D(n))throw new z(b.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=kp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Kh(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class si{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>l_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=EP.bind(null,this.syncEngine),await uf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new rP}()}createDatastore(e){const n=fl(e.databaseInfo.databaseId),r=function(s){return new jR(s)}(e.databaseInfo);return function(s,o,l,u){return new $R(s,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,l){return new KR(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>l_(this.syncEngine,n,0),function(){return n_.D()?new n_:new FR}())}createSyncEngine(e,n){return function(i,s,o,l,u,c,d){const p=new cP(i,s,o,l,u,c);return d&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=K(i);j("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Ro(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}si.provider={build:()=>new si};function c_(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const r={value:t.slice(n,n+e),done:!1};return n+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):at("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,n){this.Xa=e,this.serializer=n,this.metadata=new It,this.buffer=new Uint8Array,this.eu=function(){return new TextDecoder("utf-8")}(),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r==null?void 0:r.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(e===null)return null;const n=this.eu.decode(e),r=Number(n);isNaN(r)&&this.ru(`length string (${n}) is not valid number`);const i=await this.iu(r);return new oP(JSON.parse(i),e.length+r)}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async nu(){for(;this.su()<0&&!await this.ou(););if(this.buffer.length===0)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const n=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NP{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new z(b.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await async function(i,s){const o=K(i),l={documents:s.map(p=>Ya(o.serializer,p))},u=await o.Lo("BatchGetDocuments",o.serializer.databaseId,ge.emptyPath(),l,s.length),c=new Map;u.forEach(p=>{const m=Yx(o.serializer,p);c.set(m.key.toString(),m)});const d=[];return s.forEach(p=>{const m=c.get(p.toString());ee(!!m),d.push(m)}),d}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new xo(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{const i=W.fromPath(r);this.mutations.push(new _p(i,this.precondition(i)))}),await async function(r,i){const s=K(r),o={writes:i.map(l=>Xa(s.serializer,l))};await s.Mo("Commit",s.serializer.databaseId,ge.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw X();n=ne.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new z(b.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(ne.min())?$e.exists(!1):$e.updateTime(n):$e.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(ne.min()))throw new z(b.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return $e.updateTime(n)}return $e.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bP{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new Np(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go(async()=>{const e=new NP(this.datastore),n=this.cu(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.lu(i)}))}).catch(r=>{this.lu(r)})})}cu(e){try{const n=this.updateFunction(e);return!ol(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!qw(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MP{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Et.UNAUTHENTICATED,this.clientId=tw.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{j("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(j("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new It;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=ko(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Qh(t,e){t.asyncQueue.verifyOperationInProgress(),j("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await EE(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function h_(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Wp(t);j("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>r_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>r_(e.remoteStore,i)),t._onlineComponents=e}async function Wp(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){j("FirestoreClient","Using user provided OfflineComponentProvider");try{await Qh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===b.FAILED_PRECONDITION||i.code===b.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Sn("Error using user provided cache. Falling back to memory cache: "+n),await Qh(t,new ii)}}else j("FirestoreClient","Using default OfflineComponentProvider"),await Qh(t,new ii);return t._offlineComponents}async function qc(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(j("FirestoreClient","Using user provided OnlineComponentProvider"),await h_(t,t._uninitializedComponentsProvider._online)):(j("FirestoreClient","Using default OnlineComponentProvider"),await h_(t,new si))),t._onlineComponents}function qE(t){return Wp(t).then(e=>e.persistence)}function Vo(t){return Wp(t).then(e=>e.localStore)}function KE(t){return qc(t).then(e=>e.remoteStore)}function Hp(t){return qc(t).then(e=>e.syncEngine)}function GE(t){return qc(t).then(e=>e.datastore)}async function go(t){const e=await qc(t),n=e.eventManager;return n.onListen=hP.bind(null,e.syncEngine),n.onUnlisten=fP.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=dP.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=pP.bind(null,e.syncEngine),n}function OP(t){return t.asyncQueue.enqueue(async()=>{const e=await qE(t),n=await KE(t);return e.setNetworkEnabled(!0),function(i){const s=K(i);return s.L_.delete(0),pl(s)}(n)})}function FP(t){return t.asyncQueue.enqueue(async()=>{const e=await qE(t),n=await KE(t);return e.setNetworkEnabled(!1),async function(i){const s=K(i);s.L_.add(0),await Ro(s),s.q_.set("Offline")}(n)})}function LP(t,e){const n=new It;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const l=await function(c,d){const p=K(c);return p.persistence.runTransaction("read document","readonly",m=>p.localDocuments.getDocument(m,d))}(i,s);l.isFoundDocument()?o.resolve(l):l.isNoDocument()?o.resolve(null):o.reject(new z(b.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const u=ko(l,`Failed to get document '${s} from cache`);o.reject(u)}}(await Vo(t),e,n)),n.promise}function QE(t,e,n={}){const r=new It;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,c){const d=new $c({next:m=>{d.Za(),o.enqueueAndForget(()=>Bp(s,p));const I=m.docs.has(l);!I&&m.fromCache?c.reject(new z(b.UNAVAILABLE,"Failed to get document because the client is offline.")):I&&m.fromCache&&u&&u.source==="server"?c.reject(new z(b.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new zp(So(l.path),d,{includeMetadataChanges:!0,_a:!0});return Lp(s,p)}(await go(t),t.asyncQueue,e,n,r)),r.promise}function BP(t,e){const n=new It;return t.asyncQueue.enqueueAndForget(async()=>async function(i,s,o){try{const l=await cc(i,s,!0),u=new LE(s,l.Ts),c=u.ma(l.documents),d=u.applyChanges(c,!1);o.resolve(d.snapshot)}catch(l){const u=ko(l,`Failed to execute query '${s} against cache`);o.reject(u)}}(await Vo(t),e,n)),n.promise}function WE(t,e,n={}){const r=new It;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,c){const d=new $c({next:m=>{d.Za(),o.enqueueAndForget(()=>Bp(s,p)),m.fromCache&&u.source==="server"?c.reject(new z(b.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(m)},error:m=>c.reject(m)}),p=new zp(l,d,{includeMetadataChanges:!0,_a:!0});return Lp(s,p)}(await go(t),t.asyncQueue,e,n,r)),r.promise}function jP(t,e,n){const r=new It;return t.asyncQueue.enqueueAndForget(async()=>{try{const i=await GE(t);r.resolve(async function(o,l,u){var c;const d=K(o),{request:p,ut:m,parent:I}=nE(d.serializer,Rw(l),u);d.connection.Fo||delete p.parent;const R=(await d.Lo("RunAggregationQuery",d.serializer.databaseId,I,p,1)).filter(M=>!!M.result);ee(R.length===1);const C=(c=R[0].result)===null||c===void 0?void 0:c.aggregateFields;return Object.keys(C).reduce((M,_)=>(M[m[_]]=C[_],M),{})}(i,e,n))}catch(i){r.reject(i)}}),r.promise}function zP(t,e){const n=new $c(e);return t.asyncQueue.enqueueAndForget(async()=>function(i,s){K(i).Y_.add(s),s.next()}(await go(t),n)),()=>{n.Za(),t.asyncQueue.enqueueAndForget(async()=>function(i,s){K(i).Y_.delete(s)}(await go(t),n))}}function UP(t,e,n,r){const i=function(o,l){let u;return u=typeof o=="string"?Gw().encode(o):o,function(d,p){return new DP(d,p)}(function(d,p){if(d instanceof Uint8Array)return c_(d,p);if(d instanceof ArrayBuffer)return c_(new Uint8Array(d),p);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),l)}(n,fl(e));t.asyncQueue.enqueueAndForget(async()=>{kP(await Hp(t),i,r)})}function $P(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){const s=K(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(await Vo(t),e))}function qP(t,e){return t.asyncQueue.enqueue(async()=>async function(r,i){const s=K(r),o=s.indexManager,l=[];return s.persistence.runTransaction("Configure indexes","readwrite",u=>o.getFieldIndexes(u).next(c=>function(p,m,I,R,C){p=[...p],m=[...m],p.sort(I),m.sort(I);const M=p.length,_=m.length;let v=0,E=0;for(;v<_&&E<M;){const O=I(p[E],m[v]);O<0?C(p[E++]):O>0?R(m[v++]):(v++,E++)}for(;v<_;)R(m[v++]);for(;E<M;)C(p[E++])}(c,i,WA,d=>{l.push(o.addFieldIndex(u,d))},d=>{l.push(o.deleteFieldIndex(u,d))})).next(()=>N.waitFor(l)))}(await Vo(t),e))}function KP(t,e){return t.asyncQueue.enqueue(async()=>function(r,i){K(r).ss.zi=i}(await Vo(t),e))}function GP(t){return t.asyncQueue.enqueue(async()=>function(n){const r=K(n),i=r.indexManager;return r.persistence.runTransaction("Delete All Indexes","readwrite",s=>i.deleteAllFieldIndexes(s))}(await Vo(t)))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HE(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(t,e,n){if(!n)throw new z(b.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function QP(t,e,n,r){if(e===!0&&r===!0)throw new z(b.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function f_(t){if(!W.isDocumentKey(t))throw new z(b.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function p_(t){if(W.isDocumentKey(t))throw new z(b.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Kc(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":X()}function pe(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new z(b.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Kc(t);throw new z(b.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function YE(t,e){if(e<=0)throw new z(b.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m_{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new z(b.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QP("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=HE((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new z(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new z(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new z(b.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ml{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new m_({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new z(b.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new z(b.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new m_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new jA;switch(r.type){case"firstParty":return new qA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new z(b.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=d_.get(n);r&&(j("ComponentProvider","Removing Datastore"),d_.delete(n),r.terminate())}(this),Promise.resolve()}}function WP(t,e,n,r={}){var i;const s=(t=pe(t,ml))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Sn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Et.MOCK_USER;else{l=TS(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new z(b.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Et(c)}t._authCredentials=new zA(new Z0(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Vt(this.firestore,e,this._query)}}class ut{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ut(this.firestore,e,this._key)}}class Hn extends Vt{constructor(e,n,r){super(e,n,So(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ut(this.firestore,null,new W(e))}withConverter(e){return new Hn(this.firestore,e,this._path)}}function os(t,e,...n){if(t=St(t),Yp("collection","path",e),t instanceof ml){const r=ge.fromString(e,...n);return p_(r),new Hn(t,null,r)}{if(!(t instanceof ut||t instanceof Hn))throw new z(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return p_(r),new Hn(t.firestore,null,r)}}function QC(t,e){if(t=pe(t,ml),Yp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new z(b.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Vt(t,null,function(r){return new yr(ge.emptyPath(),r)}(e))}function Xp(t,e,...n){if(t=St(t),arguments.length===1&&(e=tw.newId()),Yp("doc","path",e),t instanceof ml){const r=ge.fromString(e,...n);return f_(r),new ut(t,null,new W(r))}{if(!(t instanceof ut||t instanceof Hn))throw new z(b.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(ge.fromString(e,...n));return f_(r),new ut(t.firestore,t instanceof Hn?t.converter:null,new W(r))}}function WC(t,e){return t=St(t),e=St(e),(t instanceof ut||t instanceof Hn)&&(e instanceof ut||e instanceof Hn)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function XE(t,e){return t=St(t),e=St(e),t instanceof Vt&&e instanceof Vt&&t.firestore===e.firestore&&ll(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Np(this,"async_queue_retry"),this.Vu=()=>{const r=Au();r&&j("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Au();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Au();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new It;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ci(e))throw e;j("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw at("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Fp.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&X()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function df(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const i=n;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}class HP{constructor(){this._progressObserver={},this._taskCompletionResolver=new It,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HC=-1;class Ve extends ml{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new g_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new g_(e),this._firestoreClient=void 0,await e}}}function YC(t,e,n){n||(n="(default)");const r=up(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Wi(s,e))return i;throw new z(b.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new z(b.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new z(b.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function YP(t,e){const n=typeof t=="object"?t:PA(),r=typeof t=="string"?t:e||"(default)",i=up(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=wS("firestore");s&&WP(i,...s)}return i}function Ze(t){if(t._terminated)throw new z(b.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||JE(t),t._firestoreClient}function JE(t){var e,n,r;const i=t._freezeSettings(),s=function(l,u,c,d){return new wx(l,u,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,HE(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new MP(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}function XC(t,e){Sn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return ZE(t,si.provider,{build:r=>new Qp(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}async function JC(t){Sn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=t._freezeSettings();ZE(t,si.provider,{build:n=>new $E(n,e.cacheSizeBytes)})}function ZE(t,e,n){if((t=pe(t,Ve))._firestoreClient||t._terminated)throw new z(b.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new z(b.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},JE(t)}function ZC(t){if(t._initialized&&!t._terminated)throw new z(b.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new It;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(r){if(!Qn.D())return Promise.resolve();const i=r+"main";await Qn.delete(i)}(kp(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function ek(t){return function(n){const r=new It;return n.asyncQueue.enqueueAndForget(async()=>vP(await Hp(n),r)),r.promise}(Ze(t=pe(t,Ve)))}function tk(t){return OP(Ze(t=pe(t,Ve)))}function nk(t){return FP(Ze(t=pe(t,Ve)))}function rk(t){return SA(t.app,"firestore",t._databaseId.database),t._delete()}function ik(t,e){const n=Ze(t=pe(t,Ve)),r=new HP;return UP(n,t._databaseId,e,r),r}function sk(t,e){return $P(Ze(t=pe(t,Ve)),e).then(n=>n?new Vt(t,null,n.query):null)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e="count",n){this._internalFieldPath=n,this.type="AggregateField",this.aggregateType=e}}class XP{constructor(e,n,r){this._userDataWriter=n,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rs{constructor(e){this._byteString=e}static fromBase64String(e){try{return new rs(it.fromBase64String(e))}catch(n){throw new z(b.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new rs(it.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new z(b.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function ok(){return new as("__name__")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new z(b.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new z(b.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return le(this._lat,e._lat)||le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP=/^__.*__$/;class ZP{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new vr(e,this.data,this.fieldMask,n,this.fieldTransforms):new Ao(e,this.data,n,this.fieldTransforms)}}class eT{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new vr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function tT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw X()}}class Qc{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Qc(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return pc(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(tT(this.Cu)&&JP.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class eC{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||fl(e)}Qu(e,n,r,i=!1){return new Qc({Cu:e,methodName:n,qu:r,path:Ue.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function us(t){const e=t._freezeSettings(),n=fl(t._databaseId);return new eC(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Wc(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);sm("Data must be an object, but it was:",o,r);const l=iT(r,o);let u,c;if(s.merge)u=new en(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const m=Za(e,p,n);if(!o.contains(m))throw new z(b.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);oT(d,m)||d.push(m)}u=new en(d),c=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,c=o.fieldTransforms;return new ZP(new Pt(l),u,c)}class gl extends ls{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gl}}function nT(t,e,n){return new Qc({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Zp extends ls{_toFieldTransform(e){return new cl(e.path,new ao)}isEqual(e){return e instanceof Zp}}class em extends ls{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=nT(this,e,!0),r=this.Ku.map(s=>cs(s,n)),i=new Ji(r);return new cl(e.path,i)}isEqual(e){return e instanceof em&&Wi(this.Ku,e.Ku)}}class tm extends ls{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=nT(this,e,!0),r=this.Ku.map(s=>cs(s,n)),i=new Zi(r);return new cl(e.path,i)}isEqual(e){return e instanceof tm&&Wi(this.Ku,e.Ku)}}class nm extends ls{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new lo(e.serializer,Ow(e.serializer,this.$u));return new cl(e.path,n)}isEqual(e){return e instanceof nm&&this.$u===e.$u}}function rm(t,e,n,r){const i=t.Qu(1,e,n);sm("Data must be an object, but it was:",i,r);const s=[],o=Pt.empty();hi(r,(u,c)=>{const d=Hc(e,u,n);c=St(c);const p=i.Nu(d);if(c instanceof gl)s.push(d);else{const m=cs(c,p);m!=null&&(s.push(d),o.set(d,m))}});const l=new en(s);return new eT(o,l,i.fieldTransforms)}function im(t,e,n,r,i,s){const o=t.Qu(1,e,n),l=[Za(e,r,n)],u=[i];if(s.length%2!=0)throw new z(b.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<s.length;m+=2)l.push(Za(e,s[m])),u.push(s[m+1]);const c=[],d=Pt.empty();for(let m=l.length-1;m>=0;--m)if(!oT(c,l[m])){const I=l[m];let R=u[m];R=St(R);const C=o.Nu(I);if(R instanceof gl)c.push(I);else{const M=cs(R,C);M!=null&&(c.push(I),d.set(I,M))}}const p=new en(c);return new eT(d,p,o.fieldTransforms)}function rT(t,e,n,r=!1){return cs(n,t.Qu(r?4:3,e))}function cs(t,e){if(sT(t=St(t)))return sm("Unsupported field value:",e,t),iT(t,e);if(t instanceof ls)return function(r,i){if(!tT(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let u=cs(l,i.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=St(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ow(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Xe.fromDate(r);return{timestampValue:uo(i.serializer,s)}}if(r instanceof Xe){const s=new Xe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:uo(i.serializer,s)}}if(r instanceof Jp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof rs)return{bytesValue:Hw(i.serializer,r._byteString)};if(r instanceof ut){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ip(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Gc)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return yp(l.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Kc(r)}`)}(t,e)}function iT(t,e){const n={};return pw(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):hi(t,(r,i)=>{const s=cs(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function sT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Xe||t instanceof Jp||t instanceof rs||t instanceof ut||t instanceof ls||t instanceof Gc)}function sm(t,e,n){if(!sT(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Kc(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Za(t,e,n){if((e=St(e))instanceof as)return e._internalPath;if(typeof e=="string")return Hc(t,e);throw pc("Field path arguments must be of type string or ",t,!1,void 0,n)}const tC=new RegExp("[~\\*/\\[\\]]");function Hc(t,e,n){if(e.search(tC)>=0)throw pc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new as(...e.split("."))._internalPath}catch{throw pc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function pc(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new z(b.INVALID_ARGUMENT,l+t+u)}function oT(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ut(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new nC(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Yc("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class nC extends el{data(){return super.data()}}function Yc(t,e){return typeof e=="string"?Hc(t,e):e instanceof as?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new z(b.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class om{}class yl extends om{}function ak(t,e,...n){let r=[];e instanceof om&&r.push(e),r=r.concat(n),function(s){const o=s.filter(u=>u instanceof Do).length,l=s.filter(u=>u instanceof _l).length;if(o>1||o>0&&l>0)throw new z(b.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class _l extends yl{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new _l(e,n,r)}_apply(e){const n=this._parse(e);return uT(e._query,n),new Vt(e.firestore,e.converter,Zd(e._query,n))}_parse(e){const n=us(e.firestore);return function(s,o,l,u,c,d,p){let m;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new z(b.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){__(p,d);const I=[];for(const R of p)I.push(y_(u,s,R));m={arrayValue:{values:I}}}else m=y_(u,s,p)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||__(p,d),m=rT(l,o,p,d==="in"||d==="not-in");return ye.create(c,d,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function lk(t,e,n){const r=e,i=Yc("where",t);return _l._create(i,r,n)}class Do extends om{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Do(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:xe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)uT(o,u),o=Zd(o,u)}(e._query,n),new Vt(e.firestore,e.converter,Zd(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function uk(...t){return t.forEach(e=>cT("or",e)),Do._create("or",t)}function ck(...t){return t.forEach(e=>cT("and",e)),Do._create("and",t)}class am extends yl{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new am(e,n)}_apply(e){const n=function(i,s,o){if(i.startAt!==null)throw new z(b.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new z(b.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ha(s,o)}(e._query,this._field,this._direction);return new Vt(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new yr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}}function hk(t,e="asc"){const n=e,r=Yc("orderBy",t);return am._create(r,n)}class Xc extends yl{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Xc(e,n,r)}_apply(e){return new Vt(e.firestore,e.converter,ic(e._query,this._limit,this._limitType))}}function dk(t){return YE("limit",t),Xc._create("limit",t,"F")}function fk(t){return YE("limitToLast",t),Xc._create("limitToLast",t,"L")}class Jc extends yl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Jc(e,n,r)}_apply(e){const n=lT(e,this.type,this._docOrFields,this._inclusive);return new Vt(e.firestore,e.converter,function(i,s){return new yr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}}function pk(...t){return Jc._create("startAt",t,!0)}function mk(...t){return Jc._create("startAfter",t,!1)}class Zc extends yl{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Zc(e,n,r)}_apply(e){const n=lT(e,this.type,this._docOrFields,this._inclusive);return new Vt(e.firestore,e.converter,function(i,s){return new yr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}}function gk(...t){return Zc._create("endBefore",t,!1)}function yk(...t){return Zc._create("endAt",t,!0)}function lT(t,e,n,r){if(n[0]=St(n[0]),n[0]instanceof el)return function(s,o,l,u,c){if(!u)throw new z(b.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const d=[];for(const p of Qs(s))if(p.field.isKeyField())d.push(Yi(o,u.key));else{const m=u.data.field(p.field);if(Dc(m))throw new z(b.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(m===null){const I=p.field.canonicalString();throw new z(b.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${I}' (used as the orderBy) does not exist.`)}d.push(m)}return new ni(d,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const i=us(t.firestore);return function(o,l,u,c,d,p){const m=o.explicitOrderBy;if(d.length>m.length)throw new z(b.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const I=[];for(let R=0;R<d.length;R++){const C=d[R];if(m[R].field.isKeyField()){if(typeof C!="string")throw new z(b.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof C}`);if(!mp(o)&&C.indexOf("/")!==-1)throw new z(b.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${C}' contains a slash.`);const M=o.path.child(ge.fromString(C));if(!W.isDocumentKey(M))throw new z(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${M}' is not because it contains an odd number of segments.`);const _=new W(M);I.push(Yi(l,_))}else{const M=rT(u,c,C);I.push(M)}}return new ni(I,p)}(t._query,t.firestore._databaseId,i,e,n,r)}}function y_(t,e,n){if(typeof(n=St(n))=="string"){if(n==="")throw new z(b.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!mp(e)&&n.indexOf("/")!==-1)throw new z(b.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(ge.fromString(n));if(!W.isDocumentKey(r))throw new z(b.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Yi(t,new W(r))}if(n instanceof ut)return Yi(t,n._key);throw new z(b.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kc(n)}.`)}function __(t,e){if(!Array.isArray(t)||t.length===0)throw new z(b.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uT(t,e){const n=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new z(b.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new z(b.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}function cT(t,e){if(!(e instanceof _l||e instanceof Do))throw new z(b.INVALID_ARGUMENT,`Function ${t}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}class hT{convertValue(e,n="none"){switch(ei(e)){case 0:return null;case 1:return e.booleanValue;case 2:return je(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(mr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw X()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return hi(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>je(o.doubleValue));return new Gc(s)}convertGeoPoint(e){return new Jp(je(e.latitude),je(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Nc(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Ga(e));default:return null}}convertTimestamp(e){const n=pr(e);return new Xe(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=ge.fromString(e);ee(oE(r));const i=new Hi(r.get(1),r.get(3)),s=new W(r.popFirst(5));return i.isEqual(n)||at(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class rC extends hT{constructor(e){super(),this.firestore=e}convertBytes(e){return new rs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ut(this.firestore,null,n)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(t){return new Ja("sum",Za("sum",t))}function vk(t){return new Ja("avg",Za("average",t))}function iC(){return new Ja("count")}function wk(t,e){var n,r;return t instanceof Ja&&e instanceof Ja&&t.aggregateType===e.aggregateType&&((n=t._internalFieldPath)===null||n===void 0?void 0:n.canonicalString())===((r=e._internalFieldPath)===null||r===void 0?void 0:r.canonicalString())}function Ek(t,e){return XE(t.query,e.query)&&Wi(t.data(),e.data())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yo extends el{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new xu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Yc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class xu extends yo{data(e={}){return super.data(e)}}class _o{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Li(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new xu(this._firestore,this._userDataWriter,r.key,r,new Li(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new z(b.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new xu(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Li(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new xu(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Li(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return l.type!==0&&(c=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:sC(l.type),doc:u,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function sC(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return X()}}function Tk(t,e){return t instanceof yo&&e instanceof yo?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof _o&&e instanceof _o&&t._firestore===e._firestore&&XE(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ik(t){t=pe(t,ut);const e=pe(t.firestore,Ve);return QE(Ze(e),t._key).then(n=>lm(e,t,n))}class fi extends hT{constructor(e){super(),this.firestore=e}convertBytes(e){return new rs(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ut(this.firestore,null,n)}}function Sk(t){t=pe(t,ut);const e=pe(t.firestore,Ve),n=Ze(e),r=new fi(e);return LP(n,t._key).then(i=>new yo(e,r,t._key,i,new Li(i!==null&&i.hasLocalMutations,!0),t.converter))}function Ak(t){t=pe(t,ut);const e=pe(t.firestore,Ve);return QE(Ze(e),t._key,{source:"server"}).then(n=>lm(e,t,n))}function oC(t){t=pe(t,Vt);const e=pe(t.firestore,Ve),n=Ze(e),r=new fi(e);return aT(t._query),WE(n,t._query).then(i=>new _o(e,r,t,i))}function xk(t){t=pe(t,Vt);const e=pe(t.firestore,Ve),n=Ze(e),r=new fi(e);return BP(n,t._query).then(i=>new _o(e,r,t,i))}function Rk(t){t=pe(t,Vt);const e=pe(t.firestore,Ve),n=Ze(e),r=new fi(e);return WE(n,t._query,{source:"server"}).then(i=>new _o(e,r,t,i))}function dT(t,e,n){t=pe(t,ut);const r=pe(t.firestore,Ve),i=eh(t.converter,e,n);return vl(r,[Wc(us(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,$e.none())])}function Pk(t,e,n,...r){t=pe(t,ut);const i=pe(t.firestore,Ve),s=us(i);let o;return o=typeof(e=St(e))=="string"||e instanceof as?im(s,"updateDoc",t._key,e,n,r):rm(s,"updateDoc",t._key,e),vl(i,[o.toMutation(t._key,$e.exists(!0))])}function Ck(t){return vl(pe(t.firestore,Ve),[new xo(t._key,$e.none())])}function th(t,e){const n=pe(t.firestore,Ve),r=Xp(t),i=eh(t.converter,e);return vl(n,[Wc(us(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,$e.exists(!1))]).then(()=>r)}function kk(t,...e){var n,r,i;t=St(t);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||df(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(df(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let u,c,d;if(t instanceof ut)c=pe(t.firestore,Ve),d=So(t._key.path),u={next:p=>{e[o]&&e[o](lm(c,t,p))},error:e[o+1],complete:e[o+2]};else{const p=pe(t,Vt);c=pe(p.firestore,Ve),d=p._query;const m=new fi(c);u={next:I=>{e[o]&&e[o](new _o(c,m,p,I))},error:e[o+1],complete:e[o+2]},aT(t._query)}return function(m,I,R,C){const M=new $c(C),_=new zp(I,M,R);return m.asyncQueue.enqueueAndForget(async()=>Lp(await go(m),_)),()=>{M.Za(),m.asyncQueue.enqueueAndForget(async()=>Bp(await go(m),_))}}(Ze(c),d,l,u)}function Vk(t,e){return zP(Ze(t=pe(t,Ve)),df(e)?e:{next:e})}function vl(t,e){return function(r,i){const s=new It;return r.asyncQueue.enqueueAndForget(async()=>mP(await Hp(r),i,s)),s.promise}(Ze(t),e)}function lm(t,e,n){const r=n.docs.get(e._key),i=new fi(t);return new yo(t,i,e._key,r,new Li(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dk(t){return aC(t,{count:iC()})}function aC(t,e){const n=pe(t.firestore,Ve),r=Ze(n),i=fw(e,(s,o)=>new $w(o,s.aggregateType,s._internalFieldPath));return jP(r,t._query,i).then(s=>function(l,u,c){const d=new fi(l);return new XP(u,d,c)}(n,t,s))}class lC{constructor(e){this.kind="memory",this._onlineComponentProvider=si.provider,e!=null&&e.garbageCollector?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=ii.provider}toJSON(){return{kind:this.kind}}}class uC{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=pC(void 0),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class cC{constructor(){this.kind="memoryEager",this._offlineComponentProvider=ii.provider}toJSON(){return{kind:this.kind}}}class hC{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new VP(e)}}toJSON(){return{kind:this.kind}}}function Nk(){return new cC}function bk(t){return new hC(t==null?void 0:t.cacheSizeBytes)}function Mk(t){return new lC(t)}function Ok(t){return new uC(t)}class dC{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=si.provider,this._offlineComponentProvider={build:n=>new Qp(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class fC{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=si.provider,this._offlineComponentProvider={build:n=>new $E(n,e==null?void 0:e.cacheSizeBytes)}}}function pC(t){return new dC(t==null?void 0:t.forceOwnership)}function Fk(){return new fC}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mC={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=us(e)}set(e,n,r){this._verifyNotCommitted();const i=Fr(e,this._firestore),s=eh(i.converter,n,r),o=Wc(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,$e.none())),this}update(e,n,r,...i){this._verifyNotCommitted();const s=Fr(e,this._firestore);let o;return o=typeof(n=St(n))=="string"||n instanceof as?im(this._dataReader,"WriteBatch.update",s._key,n,r,i):rm(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,$e.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Fr(e,this._firestore);return this._mutations=this._mutations.concat(new xo(n._key,$e.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new z(b.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Fr(t,e){if((t=St(t)).firestore!==e)throw new z(b.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=us(n)}get(n){const r=Fr(n,this._firestore),i=new rC(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return X();const o=s[0];if(o.isFoundDocument())return new el(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new el(this._firestore,i,r._key,null,r.converter);throw X()})}set(n,r,i){const s=Fr(n,this._firestore),o=eh(s.converter,r,i),l=Wc(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,l),this}update(n,r,i,...s){const o=Fr(n,this._firestore);let l;return l=typeof(r=St(r))=="string"||r instanceof as?im(this._dataReader,"Transaction.update",o._key,r,i,s):rm(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,l),this}delete(n){const r=Fr(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Fr(e,this._firestore),r=new fi(this._firestore);return super.get(e).then(i=>new yo(this._firestore,r,n._key,i._document,new Li(!1,!1),n.converter))}}function Bk(t,e,n){t=pe(t,Ve);const r=Object.assign(Object.assign({},mC),n);return function(s){if(s.maxAttempts<1)throw new z(b.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,l){const u=new It;return s.asyncQueue.enqueueAndForget(async()=>{const c=await GE(s);new bP(s.asyncQueue,c,l,o,u).au()}),u.promise}(Ze(t),i=>e(new yC(t,i)),r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jk(){return new gl("deleteField")}function zk(){return new Zp("serverTimestamp")}function Uk(...t){return new em("arrayUnion",t)}function $k(...t){return new tm("arrayRemove",t)}function qk(t){return new nm("increment",t)}function Kk(t){return new Gc(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(t){return Ze(t=pe(t,Ve)),new gC(t,e=>vl(t,e))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(t,e){const n=Ze(t=pe(t,Ve));if(!n._uninitializedComponentsProvider||n._uninitializedComponentsProvider._offline.kind==="memory")return Sn("Cannot enable indexes when persistence is disabled"),Promise.resolve();const r=function(s){const o=typeof s=="string"?function(c){try{return JSON.parse(c)}catch(d){throw new z(b.INVALID_ARGUMENT,"Failed to parse JSON: "+(d==null?void 0:d.message))}}(s):s,l=[];if(Array.isArray(o.indexes))for(const u of o.indexes){const c=v_(u,"collectionGroup"),d=[];if(Array.isArray(u.fields))for(const p of u.fields){const m=Hc("setIndexConfiguration",v_(p,"fieldPath"));p.arrayConfig==="CONTAINS"?d.push(new Ui(m,2)):p.order==="ASCENDING"?d.push(new Ui(m,0)):p.order==="DESCENDING"&&d.push(new Ui(m,1))}l.push(new ro(ro.UNKNOWN_ID,c,d,io.empty()))}return l}(e);return qP(n,r)}function v_(t,e){if(typeof t[e]!="string")throw new z(b.INVALID_ARGUMENT,"Missing string value for: "+e);return t[e]}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function Wk(t){var e;t=pe(t,Ve);const n=w_.get(t);if(n)return n;if(((e=Ze(t)._uninitializedComponentsProvider)===null||e===void 0?void 0:e._offline.kind)!=="persistent")return null;const r=new _C(t);return w_.set(t,r),r}function Hk(t){fT(t,!0)}function Yk(t){fT(t,!1)}function Xk(t){GP(Ze(t._firestore)).then(e=>j("deleting all persistent cache indexes succeeded")).catch(e=>Sn("deleting all persistent cache indexes failed",e))}function fT(t,e){KP(Ze(t._firestore),e).then(n=>j(`setting persistent cache index auto creation isEnabled=${e} succeeded`)).catch(n=>Sn(`setting persistent cache index auto creation isEnabled=${e} failed`,n))}const w_=new WeakMap;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jk(t){var e;const n=(e=Ze(pe(t.firestore,Ve))._onlineComponents)===null||e===void 0?void 0:e.datastore.serializer;return n===void 0?null:Fc(n,Ut(t._query))._t}function Zk(t,e){var n;const r=fw(e,(s,o)=>new $w(o,s.aggregateType,s._internalFieldPath)),i=(n=Ze(pe(t.firestore,Ve))._onlineComponents)===null||n===void 0?void 0:n.datastore.serializer;return i===void 0?null:nE(i,Rw(t._query),r,!0).request}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eV{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return um.instance.onExistenceFilterMismatch(e)}}class um{constructor(){this.Uu=new Map}static get instance(){return su||(su=new um,function(n){if(sc)throw new Error("a TestingHooksSpi instance is already set");sc=n}(su)),su}et(e){this.Uu.forEach(n=>n(e))}onExistenceFilterMismatch(e){const n=Symbol(),r=this.Uu;return r.set(n,e),()=>r.delete(n)}}let su=null;(function(e,n=!0){(function(i){Io=i})(RA),tc(new Ua("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new Ve(new UA(r.getProvider("auth-internal")),new KA(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new z(b.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hi(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Gs(uy,"4.7.3",e),Gs(uy,"4.7.3","esm2017")})();const vC={apiKey:"AIzaSyB9AuQ47ZrbtU3F5HN-Gnk3LKE1ACfGzxk",authDomain:"cognac-movement-test.firebaseapp.com",databaseURL:"https://cognac-movement-test-default-rtdb.firebaseio.com",projectId:"cognac-movement-test",storageBucket:"cognac-movement-test.firebasestorage.app",messagingSenderId:"784152528183",appId:"1:784152528183:web:11414bdf11b1097964c6b2",measurementId:"G-J8TQMTS5Y2"},wC=q0(vC),pi=YP(wC),EC=os(pi,"globalInvigorationSubjects"),TC=os(pi,"globalInvigorationTrials"),IC=os(pi,"globalInvigorationGames"),pT=async t=>{try{const e=t.id;if(!e)throw new Error("Subject ID is required");const n=Xp(EC,e);return await dT(n,{...t,id:e,timestamp:new Date().toISOString()})}catch(e){throw console.error("Error saving subject data: ",e),e}},SC=async t=>{try{return await th(TC,t)}catch(e){throw console.error("Error saving trial data: ",e),e}},AC=async t=>{try{return await th(os(pi,"clicks"),t)}catch(e){throw console.error("Error saving click data: ",e),e}},xC=async t=>{try{const e={...t,id:`game_${Date.now()}`,timestamp:new Date().toISOString(),gameDuration:t.endTime-t.startTime},n=await th(IC,e);return console.log("Game data saved with ID:",n.id),n}catch(e){throw console.error("Error saving game data: ",e),e}},RC=Object.freeze(Object.defineProperty({__proto__:null,database:pi,saveClickData:AC,saveGameData:xC,saveSubjectData:pT,saveTrialData:SC},Symbol.toStringTag,{value:"Module"})),PC=t=>(t==null?void 0:t.workerId)||"UNK",CC=()=>({timestamp:new Date().toISOString(),userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,screenWidth:window.screen.width,screenHeight:window.screen.height,screenColorDepth:window.screen.colorDepth,windowWidth:window.innerWidth,windowHeight:window.innerHeight,devicePixelRatio:window.devicePixelRatio,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,hasTouch:"ontouchstart"in window,maxTouchPoints:navigator.maxTouchPoints||0,browser:kC(),os:VC()}),kC=()=>{const t=navigator.userAgent;return t.includes("Chrome")?"Chrome":t.includes("Firefox")?"Firefox":t.includes("Safari")?"Safari":t.includes("Edge")?"Edge":"Unknown"},VC=()=>{const t=navigator.userAgent;return t.includes("Windows")?"Windows":t.includes("Mac")?"macOS":t.includes("Linux")?"Linux":t.includes("Android")?"Android":t.includes("iOS")?"iOS":"Unknown"},DC=async t=>{const e=PC(t),n=CC(),r={id:e,...t,systemInfo:n,sessionStart:new Date().toISOString(),experimentVersion:"1.0",status:"active"};try{return await pT(r),e}catch(i){throw console.error("Failed to initialize participant:",i),i}},NC=async(t,e,n)=>{try{const r=os(pi,"globalInvigorationTrials"),i=Xp(r,n);return await dT(i,e)}catch(r){throw console.error("Error saving participant trial:",r),r}};class E_{constructor(e){this.participantId=e,this.isTracking=!1,this.startTime=null,this.endTime=null,this.movements=[],this.trialInfo=null,this.barPositions=null}startTracking(e,n=null){this.isTracking=!0,this.startTime=Date.now(),this.trialInfo=e,this.barPositions=n,this.movements=[],console.log("Raw movement tracking started:",e)}recordMovement(e,n,r){if(!this.isTracking)return;const i={timestamp:Date.now(),relativeTime:Date.now()-this.startTime,x:Math.round(e),y:Math.round(n),currentBar:r};this.movements.push(i)}stopTracking(){if(!this.isTracking)return null;this.isTracking=!1,this.endTime=Date.now();const e={participantId:this.participantId,trialInfo:this.trialInfo,startTime:this.startTime,endTime:this.endTime,duration:this.endTime-this.startTime,screenDimensions:{width:window.innerWidth,height:window.innerHeight},barPositions:this.barPositions,rawMovements:this.movements,totalMovements:this.movements.length,samplingRate:this.movements.length/((this.endTime-this.startTime)/1e3)};return console.log("Raw movement tracking stopped:",e),e}}class T_{constructor(e){this.participantId=e,this.isTracking=!1,this.startTime=null,this.endTime=null,this.trialInfo=null,this.expectedSequence=[],this.keyPresses=[]}startTracking(e,n){this.isTracking=!0,this.startTime=Date.now(),this.trialInfo=e,this.expectedSequence=n,this.keyPresses=[],console.log("Reward tracking started:",{trialInfo:e,expectedSequence:n})}recordKeyPress(e,n){if(!this.isTracking)return;const r={timestamp:Date.now(),relativeTime:Date.now()-this.startTime,pressedKey:e,expectedKey:n,isCorrect:e===n};this.keyPresses.push(r)}stopTracking(){if(!this.isTracking)return null;this.isTracking=!1,this.endTime=Date.now();const e=this.keyPresses.filter(o=>o.isCorrect).length,n=this.keyPresses.length,r=n>0?e/n*100:0;let i=0;if(this.keyPresses.length>1){const o=[];for(let l=1;l<this.keyPresses.length;l++){const u=this.keyPresses[l].relativeTime-this.keyPresses[l-1].relativeTime;o.push(u)}i=o.reduce((l,u)=>l+u,0)/o.length}const s={participantId:this.participantId,trialInfo:this.trialInfo,startTime:this.startTime,endTime:this.endTime,duration:this.endTime-this.startTime,expectedSequence:this.expectedSequence,keyPresses:this.keyPresses,totalPresses:n,correctPresses:e,accuracy:r,overshoot:Math.max(0,n-this.expectedSequence.length),averageInterKeyInterval:i,completionTime:n>=this.expectedSequence.length?this.endTime-this.startTime:null};return console.log("Reward tracking stopped:",s),s}}const bC=async(t,e)=>{try{const n=os(pi,`globalInvigorationSubjects/${t}/sessions`),r=await th(n,e);return console.log("Participant session saved with ID:",r.id),r}catch(n){throw console.error("Error saving participant session:",n),n}};const MC=({participantData:t,participantId:e,onGameComplete:n})=>{const[r,i]=q.useState(!1),[s,o]=q.useState(8),[l,u]=q.useState(0),[c,d]=q.useState(null),[p,m]=q.useState("reaching"),[I,R]=q.useState(!1),[C,M]=q.useState(0),[_,v]=q.useState({width:window.innerWidth,height:window.innerHeight}),[E,O]=q.useState(!1),U=q.useRef(null),B=q.useRef(!1),w=q.useRef(null),y=q.useRef(Date.now()),[T,A]=q.useState([]),[x,V]=q.useState(0),[S,be]=q.useState([]),[oe,gn]=q.useState("poor"),[he,G]=q.useState(1),[re,ae]=q.useState(0),[Ae,ve]=q.useState(!1),[Pe,et]=q.useState(""),[tt]=q.useState("key"),[_e]=q.useState(Date.now()),ue=q.useRef(null),st=q.useRef(null),[fe,L]=q.useState([]),[yt,Be]=q.useState(!1),[qe,Ke]=q.useState(0),[Dt,yn]=q.useState([]),[An,Er]=q.useState([]),[mi,Tr]=q.useState([]),[on,Ln]=q.useState([]),[gi,Xn]=q.useState([]),[hs,yi]=q.useState([]),[ct,ft]=q.useState([]),[Jn,ds]=q.useState([]),[fs,No]=q.useState([]),[Ir,_i]=q.useState([]),[ps,vi]=q.useState([]),[nh,wl]=q.useState(1),[ms,bo]=q.useState(null),[El,Sr]=q.useState(1),wi=q.useRef(!1),Ei=q.useRef(!1),Zn=(ie,P,J)=>{let H,Y;const te=Ge.x+Ge.width,de=Qe.x;ie>=Ge.x&&ie<=te?(H="ASW",Y="L"):ie>=de&&ie<=Qe.x+Qe.width?(H="ATW",Y="R"):(H="RO",Y="N"),ms&&ms!==Y&&Y!=="N"&&wl(se=>se+1),bo(Y),yn(se=>[...se,H]),Er(se=>[...se,wi.current?"RC":"NONE"]),Tr(se=>[...se,nh]),Ln(se=>[...se,ie]),Xn(se=>[...se,P]),yi(se=>[...se,Y]),ft(se=>[...se,null]),ds(se=>[...se,null]),No(se=>[...se,J]),_i(se=>[...se,null]),vi(se=>[...se,null])},Tl=(ie,P,J,H)=>{let Y;H?Y="SC":Y="SO",yn(te=>[...te,Y]),Er(te=>[...te,H?"RREC":"RR"]),Tr(te=>[...te,null]),Ln(te=>[...te,null]),Xn(te=>[...te,null]),yi(te=>[...te,null]),ft(te=>[...te,El]),ds(te=>[...te,ie]),No(te=>[...te,P]),_i(te=>[...te,null]),vi(te=>[...te,J]),Sr(te=>te+1)},Ti=ie=>{if(!r||p!=="coin")return;const P=ie.key.toLowerCase();["a","s","d","f"].includes(P)&&_i(H=>{const Y=[...H];for(let te=Y.length-1;te>=0;te--)if(Jn[te]===P&&Y[te]===null){Y[te]=Date.now();break}return Y})},Mo=async ie=>{try{console.log(`Exporting ${ie}...`);const{collection:P,getDocs:J}=await Jg(()=>import("./index.esm-d40ffb0d.js"),[]),{database:H}=await Jg(()=>Promise.resolve().then(()=>RC),void 0),Y=await J(P(H,ie)),te=[];if(Y.forEach(Pn=>{te.push({documentId:Pn.id,...Pn.data()})}),console.log(`Found ${te.length} documents in ${ie}`),te.length===0){alert(`No data found in ${ie}`);return}const de=new Set;te.forEach(Pn=>{Object.keys(Pn).forEach(Cn=>de.add(Cn))});const se=Array.from(de),Nt=[se.join(",")];te.forEach(Pn=>{const Cn=se.map(qt=>{const Kt=Pn[qt];return Kt==null?"":Array.isArray(Kt)?`"${JSON.stringify(Kt).replace(/"/g,'""')}"`:typeof Kt=="object"?`"${JSON.stringify(Kt).replace(/"/g,'""')}"`:`"${String(Kt).replace(/"/g,'""')}"`});Nt.push(Cn.join(","))});const an=Nt.join(`
`),Yt=new Blob([an],{type:"text/csv;charset=utf-8;"}),xn=URL.createObjectURL(Yt),Rn=document.createElement("a");Rn.href=xn,Rn.download=`${ie}_export_${new Date().toISOString().split("T")[0]}.csv`,Rn.click(),console.log(` Exported ${te.length} documents to CSV`)}catch(P){console.error(` Error exporting ${ie}:`,P),alert(`Export failed: ${P.message}`)}},er=()=>{const ie=[8,10,12],P=ie[Math.floor(Math.random()*ie.length)];return Ke(P),P},Oo=ie=>Math.floor((ie-1)/2)+1,_t=()=>{const ie=["a","s","d","f"],P=[];for(let H=0;H<10;H++)P.push(ie[Math.floor(Math.random()*ie.length)]);A(P),V(0),be(new Array(10).fill("pending"))},Il=()=>{gn("rich"),G(1),m("reaching"),o(er()),i(!0),R(!1),A([]),be([]),ae(0),d(null),O(!1),ue.current&&ue.current.isTracking&&ue.current.stopTracking(),ue.current&&ue.current.startTracking({environment:"rich",environmentRound:1,participantId:e})},Bn=Math.max(_.width*.1,100),Ar=Math.max(_.height,600),Ge={x:0,y:0,width:Bn,height:Ar},Qe={x:Math.max(_.width-Bn,Bn),y:0,width:Bn,height:Ar},Te={x:Math.max(_.width/2,400),y:Math.max(_.height/2-60,200)},We=Math.max(Math.min(_.width,_.height)*.12,30);q.useEffect(()=>{const ie=()=>{const J={width:window.innerWidth,height:window.innerHeight};v(J)},P={width:window.innerWidth,height:window.innerHeight};return v(P),window.addEventListener("resize",ie),()=>window.removeEventListener("resize",ie)},[]),q.useEffect(()=>{if(r&&p==="reaching"){const ie=setInterval(()=>{o(P=>{if(P===3&&(wi.current=!0),P<=1){if(oe==="break"||!r)return 0;m("coin"),R(!0);let J=0;if(oe==="poor"){const H=[10,10,0,10,10,0,10,30,10,10],Y=Math.floor((he-1)/2);J=H[Y]}else if(oe==="rich"){const H=[30,50,30,50,10,30,50,30,50,30,0],Y=Math.floor((he-1)/2);J=H[Y]}return ae(J),tt==="key"&&_t(),0}return P-1})},1e3);return()=>clearInterval(ie)}},[r,p]),q.useEffect(()=>{if(p==="reaching"&&ue.current){let ie=0;if(oe==="poor"){const H=[10,10,0,10,10,0,10,50,10,10],Y=Math.floor((he-1)/2);ie=H[Y]}else if(oe==="rich"){const H=[50,100,50,100,10,50,100,50,100,50],Y=Math.floor((he-1)/2);ie=H[Y]}console.log("Starting raw movement tracking for trial:",{environment:oe,environmentRound:he,expectedReward:ie,isTracking:ue.current.isTracking});let P=0;oe==="poor"?he<=5?P=he%2===1?10:30:P=he%2===1?20:40:oe==="rich"&&(he<=5?P=Math.max(50-(he-1)*8,20):P=Math.max(40-(he-6)*5,15));const J={environment:oe,environmentRound:he,expectedReward:P};ue.current.startTracking(J,{left:Ge,right:Qe}),console.log("Raw movement tracking started successfully:",{tracker:!!ue.current,isTracking:ue.current.isTracking,trialInfo:J})}},[p,oe,he,Ge,Qe]),q.useEffect(()=>{if(p==="coin"&&T.length>0&&st.current){console.log("Starting reward tracking for sequence:",T);let ie=0;if(oe==="poor"){const J=[10,10,0,10,10,0,10,30,10,10],H=Math.floor((he-1)/2);ie=J[H]}else if(oe==="rich"){const J=[30,50,30,50,10,30,50,30,50,30],H=Math.floor((he-1)/2);ie=J[H]}const P={environment:oe,environmentRound:he,expectedReward:ie};st.current.isTracking?console.log("Reward tracker already active, skipping start"):(st.current.startTracking(P,T),Ei.current=!0),console.log("Reward tracking started successfully:",{tracker:!!st.current,isTracking:st.current.isTracking,trialInfo:P,keySequence:T})}},[T,p,oe,he]),q.useEffect(()=>{const ie=P=>{var te;if(p==="break"&&P.key===" "){Il();return}if(!r||p!=="coin"||!I||T.length===0)return;const J=P.key.toLowerCase(),H=T[x],Y=J===H;if(st.current&&st.current.isTracking){st.current.recordKeyPress(J,H),console.log("Key press recorded:",{pressedKey:J,expectedKey:H,isCorrect:Y});const de=x===T.length-1;Tl(J,Date.now(),Y,de),de&&(Ei.current=!1)}else console.log("Reward tracking not active:",{hasTracker:!!st.current,isTracking:(te=st.current)==null?void 0:te.isTracking});J===H?(be(de=>{const se=[...de];return se[x]="correct",se}),V(de=>{var Nt;const se=de+1;if(se>=T.length){const an=re||0;if(u(Yt=>(Yt||0)+an),an>0&&(et(`+${an}`),ve(!0),setTimeout(()=>{ve(!1)},2e3)),M(Yt=>Yt+1),st.current&&!yt){if(Be(!0),console.log("About to stop reward tracking, tracker state:",{hasTracker:!!st.current,isTracking:(Nt=st.current)==null?void 0:Nt.isTracking}),!st.current||!st.current.isTracking){console.error("Reward tracker is not active! Cannot collect data.");return}console.log("Using synchronized arrays for data collection"),console.log("Array lengths:",{gameState:Dt.length,event:An.length,reachNumber:mi.length,posX:on.length,posY:gi.length,keytapNumber:ct.length,keytapValue:Jn.length,timestamp:fs.length,validity:ps.length}),console.log("Saving trial data with synchronized arrays:",{gameStateLength:Dt.length,eventLength:An.length,reachNumberLength:mi.length,posXLength:on.length,posYLength:gi.length,currentWallLength:hs.length,keytapNumberLength:ct.length,keytapValueLength:Jn.length,timestampLength:fs.length,keyupTimestampLength:Ir.length,validityLength:ps.length});try{const Yt={participantId:e,block:oe==="poor"?1:oe==="rich"?2:0,round:Oo(he),gameState:Dt,event:An,reachNumber:mi,pos_x:on,pos_y:gi,currentWall:hs,keytapNumber:ct,keytapValue:Jn,timestamp:fs,keyupTimestamp:Ir,validity:ps,score:an||0},xn=`${(t==null?void 0:t.workerId)||"unknown"}_block${oe==="poor"?1:oe==="rich"?2:0}_round${Oo(he)}`;e&&NC(e,Yt,xn).catch(Rn=>console.warn("Participant trial save failed:",Rn))}catch(Yt){console.warn("Failed to build/save flat trial row:",Yt)}Be(!1)}if(fe.length,oe==="poor"&&he>=19)return gn("break"),m("break"),R(!1),A([]),be([]),se;if(oe==="rich"&&he>=21)return i(!1),R(!1),A([]),be([]),B.current||(B.current=!0,n==null||n()),se;G(Yt=>Yt+1),_t(),m("reaching"),o(er()),i(!0),d(null),O(!1)}return se})):(be(de=>{const se=[...de];return se[x]="incorrect",se}),setTimeout(()=>{be(de=>{const se=[...de];return se[x]==="incorrect"&&(se[x]="pending"),se})},500))};return window.addEventListener("keydown",ie),window.addEventListener("keyup",Ti),()=>{window.removeEventListener("keydown",ie),window.removeEventListener("keyup",Ti)}},[r,p,I,T,x,S,oe,re,e,t,_e,fe,n]),q.useEffect(()=>{p==="reaching"&&(yn([]),Er([]),Tr([]),Ln([]),Xn([]),yi([]),ft([]),ds([]),No([]),_i([]),vi([]),wl(1),bo(null),Sr(1),wi.current=!1,Ei.current=!1,console.log("Data collection arrays reset for new trial"))},[p]);const rh=ie=>{var de;if(!r||p!=="reaching")return;const J=U.current.getBoundingClientRect(),H=ie.clientX-J.left,Y=ie.clientY-J.top;let te=null;H>=Ge.x&&H<=Ge.x+Ge.width&&Y>=Ge.y&&Y<=Ge.y+Ge.height?te="left":H>=Qe.x&&H<=Qe.x+Qe.width&&Y>=Qe.y&&Y<=Qe.y+Qe.height&&(te="right"),ue.current&&ue.current.isTracking?(ue.current.recordMovement(H,Y,te||"none"),console.log("Movement recorded:",{x:Math.round(H),y:Math.round(Y),currentBar:te||"none"}),Zn(Math.round(H),Math.round(Y),Date.now())):console.log("Movement tracking not active:",{hasTracker:!!ue.current,isTracking:(de=ue.current)==null?void 0:de.isTracking,gamePhase:p,gameActive:r}),H>=Ge.x&&H<=Ge.x+Ge.width&&Y>=Ge.y&&Y<=Ge.y+Ge.height?c!=="left"&&(d("left"),y.current=Date.now(),O(!1),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{O(!0)},2e3)):H>=Qe.x&&H<=Qe.x+Qe.width&&Y>=Qe.y&&Y<=Qe.y+Qe.height&&c!=="right"&&(d("right"),O(!1),w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{O(!0)},2e3))},Ii=()=>{if(i(!0),m("reaching"),o(er()),G(1),gn("poor"),u(0),M(0),d(null),e)ue.current=new E_(e),st.current=new T_(e);else{const ie="temp_"+Date.now();ue.current=new E_(ie),st.current=new T_(ie)}};return q.useEffect(()=>{if(!e){const ie=setTimeout(()=>{Ii()},100);return()=>clearTimeout(ie)}Ii()},[e]),q.useEffect(()=>()=>{w.current&&clearTimeout(w.current)},[]),q.useEffect(()=>{const ie=U.current;if(!ie){console.error("Canvas ref is null!");return}const P=ie.getContext("2d");if(!P){console.error("Could not get canvas context!");return}if(P.clearRect(0,0,_.width,_.height),P.fillStyle="#000000",P.fillRect(0,0,_.width,_.height),p==="reaching"){try{P.beginPath(),P.rect(Ge.x,Ge.y,Ge.width,Ge.height),P.fillStyle=c==="left"?"#27ae60":"#3498db",P.fill(),P.strokeStyle="#2980b9",P.lineWidth=3,P.stroke(),P.beginPath(),P.rect(Qe.x,Qe.y,Qe.width,Qe.height),P.fillStyle=c==="right"?"#27ae60":"#3498db",P.fill(),P.strokeStyle="#2980b9",P.lineWidth=3,P.stroke(),console.log("Bars drawn successfully")}catch(J){console.error("Error drawing bars:",J)}s<=3&&(P.beginPath(),P.arc(Te.x,Te.y,We,0,2*Math.PI),P.fillStyle="#808080",P.fill(),P.strokeStyle="#606060",P.lineWidth=3,P.stroke(),P.fillStyle="#ffffff",P.font=`bold ${We*.8}px "Arial", sans-serif`,P.textAlign="center",P.textBaseline="middle",P.fillText("?",Te.x,Te.y)),P.fillStyle="#ffffff",P.font='bold 48px "Orbitron", "Courier New", monospace',P.textAlign="center",P.fillText(`Score: ${l}`,_.width/2,80),P.fillStyle="#ffffff",P.font='16px "Press Start 2P", "Courier New", monospace',P.textAlign="center",P.fillText("Move your cursor back and forth between the bars!",_.width/2,_.height-50),E&&(P.fillStyle="#FF6B6B",P.font='bold 20px "Orbitron", "Courier New", monospace',P.textAlign="center",P.fillText("Move Faster!",_.width/2,_.height-100)),Ae&&(P.fillStyle="#00FF00",P.font='bold 36px "Orbitron", "Courier New", monospace',P.textAlign="center",P.fillText(Pe,_.width/2,_.height/2-100))}else if(p==="coin"){if(I)if(re===0){P.beginPath(),P.arc(Te.x,Te.y,We,0,2*Math.PI),P.fillStyle="#f0f0f0",P.fill(),P.strokeStyle="#c0c0c0",P.lineWidth=4,P.stroke();const J="0",H=We*.4;P.font=`bold ${H}px "Arial", sans-serif`,P.textAlign="center",P.textBaseline="middle";const Y=Te.x,te=Te.y-We*.7;P.fillStyle="rgba(0, 0, 0, 0.4)",P.fillText(J,Y+1,te+1),P.fillStyle="#888888",P.fillText(J,Y,te)}else{let J,H,Y;re===10?(J={center:"#8B4513",mid:"#A0522D",edge:"#654321"},H="#5D4037",Y="#3E2723"):re===30?(J={center:"#C0C0C0",mid:"#A8A8A8",edge:"#909090"},H="#777777",Y="#555555"):(J={center:"#FFFF00",mid:"#FFEB3B",edge:"#FFC107"},H="#FF9800",Y="#B8860B");const te=P.createRadialGradient(Te.x-We*.3,Te.y-We*.3,0,Te.x,Te.y,We);te.addColorStop(0,J.center),te.addColorStop(.7,J.mid),te.addColorStop(1,J.edge),P.beginPath(),P.arc(Te.x,Te.y,We,0,2*Math.PI),P.fillStyle=te,P.fill(),P.strokeStyle=H,P.lineWidth=4,P.stroke(),P.fillStyle=Y,P.fillRect(Te.x-We*.1,Te.y-We*.4,We*.2,We*.8),P.strokeStyle=H,P.lineWidth=2,P.strokeRect(Te.x-We*.1,Te.y-We*.4,We*.2,We*.8);const de=(re||0).toString(),se=We*.4;if(P.font=`bold ${se}px "Arial", sans-serif`,P.textAlign="center",P.textBaseline="middle",de.length===1){const Nt=Te.x,an=Te.y-We*.7;P.fillStyle="rgba(0, 0, 0, 0.7)",P.fillText(de,Nt+1,an+1),P.fillStyle=Y,P.fillText(de,Nt,an)}else{const Nt=We*.7,xn=.055+.025*(de.length-1),Rn=-Math.PI*(.5+xn),Cn=(-Math.PI*(.5-xn)-Rn)/(de.length-1);for(let qt=0;qt<de.length;qt++){const Kt=Rn+Cn*qt,ih=Te.x+Math.cos(Kt)*Nt,Sl=Te.y+Math.sin(Kt)*Nt;P.save(),P.translate(ih,Sl),P.rotate(Kt+Math.PI/2),P.fillStyle="rgba(0, 0, 0, 0.7)",P.fillText(de[qt],1,1),P.fillStyle=Y,P.fillText(de[qt],0,0),P.restore()}}}if(T.length>0){const H=Te.x-T.length*45/2,Y=Te.y+We+80;P.font='bold 36px "Arial", sans-serif',P.textAlign="center",P.textBaseline="middle",T.forEach((de,se)=>{const Nt=H+se*45;S[se]==="correct"?P.fillStyle="#27ae60":S[se]==="incorrect"?P.fillStyle="#e74c3c":se===x?P.fillStyle="#f39c12":P.fillStyle="#7f8c8d",P.fillText(de.toUpperCase(),Nt,Y)}),x<T.length&&(P.fillStyle="#FFD700",P.font='bold 24px "Arial", sans-serif',P.fillText(`Press: ${T[x].toUpperCase()}`,Te.x,Y+60));const te=`${x}/${T.length}`;P.fillStyle="#ecf0f1",P.font='20px "Arial", sans-serif',P.fillText(te,Te.x,Y+90)}P.fillStyle="#ffffff",P.font='bold 48px "Orbitron", "Courier New", monospace',P.textAlign="center",P.fillText(`Score: ${l}`,_.width/2,80),P.fillStyle="#ffffff",P.font='16px "Press Start 2P", "Courier New", monospace',P.textAlign="center",Ae&&(P.fillStyle="#00FF00",P.font='bold 36px "Orbitron", "Courier New", monospace',P.textAlign="center",P.fillText(Pe,_.width/2,_.height/2-100))}else p==="break"?(console.log("Rendering break screen"),P.fillStyle="#000000",P.fillRect(0,0,_.width,_.height),P.fillStyle="#ffffff",P.font='bold 32px "Orbitron", "Courier New", monospace',P.textAlign="center",P.fillText("Block 1 Complete!",_.width/2,_.height/2-100),P.font='20px "Orbitron", "Courier New", monospace',P.fillText("Take a short break.",_.width/2,_.height/2-40),P.fillText("Press SPACE to continue to Block 2",_.width/2,_.height/2+40),P.font='bold 24px "Orbitron", "Courier New", monospace',P.fillText(`Current Score: ${l}`,_.width/2,_.height/2+100)):(P.fillStyle="#ff0000",P.font='bold 24px "Arial", sans-serif',P.textAlign="center",P.fillText("DEBUG: Invalid game state",_.width/2,_.height/2-50),P.fillText(`gamePhase: ${p}`,_.width/2,_.height/2),P.fillText(`gameActive: ${r}`,_.width/2,_.height/2+50),P.fillText(`environment: ${oe}`,_.width/2,_.height/2+100))},[s,l,c,p,I,_,E,Ae,T,x,S,oe,re,Pe,r,he]),q.useEffect(()=>{if(oe==="rich"&&he>=21&&!B.current){console.log("RICH ENVIRONMENT COMPLETE - ENDING GAME (round 21 reached)"),console.log(" Current trial data:",fe),console.log("Trial data length:",fe.length),i(!1),R(!1),A([]),be([]),B.current=!0;const ie={participantId:e,participantData:t,sessionStartTime:_e,sessionEndTime:Date.now(),sessionDuration:Date.now()-_e,completedAt:new Date().toISOString(),totalScore:l,totalCoinsCollected:C,allTrials:fe,summary:{totalTrials:fe.length,poorEnvironmentTrials:fe.filter(J=>J.environment==="poor").length,richEnvironmentTrials:fe.filter(J=>J.environment==="rich").length,totalKeyPresses:fe.reduce((J,H)=>{var Y;return J+(((Y=H.rewardData)==null?void 0:Y.totalPresses)||0)},0),totalCorrectPresses:fe.reduce((J,H)=>{var Y;return J+(((Y=H.rewardData)==null?void 0:Y.correctPresses)||0)},0),overallAccuracy:(()=>{const J=fe.reduce((Y,te)=>{var de;return Y+(((de=te.rewardData)==null?void 0:de.totalPresses)||0)},0),H=fe.reduce((Y,te)=>{var de;return Y+(((de=te.rewardData)==null?void 0:de.correctPresses)||0)},0);return J>0?H/J:0})(),averageReactionTime:(()=>{const J=fe.map(H=>{var Y;return((Y=H.rewardData)==null?void 0:Y.averageInterKeyInterval)||0}).filter(H=>H>0);return J.length>0?J.reduce((H,Y)=>H+Y,0)/J.length:0})()}};console.log("About to save comprehensive session data:",ie);const P=JSON.parse(JSON.stringify(ie));console.log("FINAL SESSION DATA BREAKDOWN:"),console.log("Participant Info:",P.participantData),console.log("Session Summary:",{totalTrials:P.summary.totalTrials,poorTrials:P.summary.poorEnvironmentTrials,richTrials:P.summary.richEnvironmentTrials,totalScore:P.totalScore,totalCoinsCollected:P.totalCoinsCollected}),console.log("All Trials:",P.allTrials),console.log("Poor Environment Trials:",P.allTrials.filter(J=>J.environment==="poor")),console.log("Rich Environment Trials:",P.allTrials.filter(J=>J.environment==="rich")),P.environmentSummaries?console.log(" Environment Summaries:",{poor:P.environmentSummaries.poor,rich:P.environmentSummaries.rich}):console.log("Environment summaries not available"),console.log("Overall Summary:",P.summary),e?bC(e,P).then(()=>{console.log("Session data saved, calling onGameComplete"),n==null||n(P)}).catch(J=>{console.error("Failed to save session data:",J),n==null||n(P)}):n==null||n(P)}},[oe,he,B,e,t,_e,l,C,fe,n]),q.useEffect(()=>{console.log("State changed:",{currentEnvironment:oe,environmentRound:he,gamePhase:p,gameActive:r,trialDataLength:fe.length})},[oe,he,p,r,fe.length]),k.jsx("div",{className:"game-container",children:k.jsxs("div",{className:"canvas-container",children:[k.jsx("canvas",{ref:U,width:_.width,height:_.height,onMouseMove:rh,className:"game-canvas",style:{width:"100vw",height:"100vh",display:"block",backgroundColor:"#000000"}}),k.jsxs("div",{style:{position:"absolute",top:"10px",right:"10px",zIndex:1e3,display:"flex",flexDirection:"column",gap:"10px"},children:[k.jsx("button",{onClick:()=>Mo("globalInvigorationTrials"),style:{padding:"8px 16px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},title:"Export all trial data to CSV",children:"Export Trials"}),k.jsx("button",{onClick:()=>Mo("globalInvigorationSubjects"),style:{padding:"8px 16px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px",fontWeight:"bold"},title:"Export all participant data to CSV",children:"Export Subjects"})]})]})})},OC=({onPracticeComplete:t})=>{const[e,n]=q.useState(!1),[r,i]=q.useState(8),[s,o]=q.useState(0),[l,u]=q.useState(null),[c,d]=q.useState("reaching"),[p,m]=q.useState(0),[I,R]=q.useState(!1),[C,M]=q.useState(1),[_,v]=q.useState(0),[E,O]=q.useState({width:window.innerWidth,height:window.innerHeight}),[U,B]=q.useState(!1),[w,y]=q.useState(!1),T=q.useRef(null),A=q.useRef(!1),x=q.useRef(null),V=q.useRef(null),[S,be]=q.useState([]),[oe,gn]=q.useState(0),[he,G]=q.useState([]),re=2,ae=()=>{const fe=[8,10,12];return fe[Math.floor(Math.random()*fe.length)]},Ae=()=>{const fe=["a","s","d","f"],L=[];for(let Be=0;Be<10;Be++)L.push(fe[Math.floor(Math.random()*fe.length)]);be(L),gn(0),G(new Array(10).fill("pending"))},ve=E.width*.1,Pe=E.height,et={x:0,y:0,width:ve,height:Pe},tt={x:E.width-ve,y:0,width:ve,height:Pe},_e={x:E.width/2,y:E.height/2-60},ue=Math.min(E.width,E.height)*.12;q.useEffect(()=>{const fe=()=>{O({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",fe),()=>window.removeEventListener("resize",fe)},[]),q.useEffect(()=>{if(e&&c==="reaching"){const fe=setInterval(()=>{i(L=>L<=1?(d("coin"),R(!0),Ae(),0):L-1)},1e3);return()=>clearInterval(fe)}},[e,c]),q.useEffect(()=>{const fe=L=>{if(!e||c!=="coin"||!I||S.length===0)return;const yt=L.key.toLowerCase(),Be=S[oe];yt===Be?(G(qe=>{const Ke=[...qe];return Ke[oe]="correct",Ke}),gn(qe=>{const Ke=qe+1;return Ke>=S.length?(o(Dt=>Dt+50),y(!0),setTimeout(()=>{y(!1)},2e3),v(Dt=>Dt+1),C>=re?(n(!1),be([]),G([]),A.current||(A.current=!0,setTimeout(()=>{t()},2e3))):(M(Dt=>Dt+1),d("reaching"),i(ae()),R(!1),m(0),u(null),be([]),G([])),0):Ke})):(G(qe=>{const Ke=[...qe];return Ke[oe]="incorrect",Ke}),setTimeout(()=>{G(qe=>{const Ke=[...qe];return Ke[oe]==="incorrect"&&(Ke[oe]="pending"),Ke})},500))};return window.addEventListener("keydown",fe),()=>window.removeEventListener("keydown",fe)},[e,c,I,C,re,s,_,t,S,oe]);const st=fe=>{if(!e)return;const yt=T.current.getBoundingClientRect(),Be=fe.clientX-yt.left,qe=fe.clientY-yt.top;Be>=et.x&&Be<=et.x+et.width&&qe>=et.y&&qe<=et.y+et.height?l!=="left"&&(u("left"),x.current=Date.now(),B(!1),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{B(!0)},2e3)):Be>=tt.x&&Be<=tt.x+tt.width&&qe>=tt.y&&qe<=tt.y+tt.height&&l!=="right"&&(u("right"),x.current=Date.now(),B(!1),V.current&&clearTimeout(V.current),V.current=setTimeout(()=>{B(!0)},2e3))};return q.useEffect(()=>{n(!0),d("reaching"),i(ae())},[]),q.useEffect(()=>()=>{V.current&&clearTimeout(V.current)},[]),q.useEffect(()=>{const fe=T.current;if(!fe)return;const L=fe.getContext("2d");if(L.clearRect(0,0,E.width,E.height),L.fillStyle="#000000",L.fillRect(0,0,E.width,E.height),c==="reaching")L.beginPath(),L.rect(et.x,et.y,et.width,et.height),L.fillStyle=l==="left"?"#27ae60":"#3498db",L.fill(),L.strokeStyle="#2980b9",L.lineWidth=3,L.stroke(),L.beginPath(),L.rect(tt.x,tt.y,tt.width,tt.height),L.fillStyle=l==="right"?"#27ae60":"#3498db",L.fill(),L.strokeStyle="#2980b9",L.lineWidth=3,L.stroke(),r<=3&&(L.beginPath(),L.arc(_e.x,_e.y,ue,0,2*Math.PI),L.fillStyle="#808080",L.fill(),L.strokeStyle="#606060",L.lineWidth=3,L.stroke(),L.fillStyle="#ffffff",L.font=`bold ${ue*.8}px "Arial", sans-serif`,L.textAlign="center",L.textBaseline="middle",L.fillText("?",_e.x,_e.y)),L.fillStyle="#ffffff",L.font='bold 48px "Orbitron", "Courier New", monospace',L.textAlign="center",L.fillText(`Score: ${s}`,E.width/2,80),L.fillStyle="#ffffff",L.font='16px "Press Start 2P", "Courier New", monospace',L.textAlign="center",L.fillText("Move your cursor back and forth between the bars!",E.width/2,E.height-50),U&&(L.fillStyle="#FF6B6B",L.font='bold 20px "Orbitron", "Courier New", monospace',L.textAlign="center",L.fillText("Move Faster!",E.width/2,E.height-100)),w&&(L.fillStyle="#00FF00",L.font='bold 36px "Orbitron", "Courier New", monospace',L.textAlign="center",L.fillText("+50",E.width/2,E.height/2-100));else if(c==="coin"){if(I){const yt=L.createRadialGradient(_e.x-ue*.3,_e.y-ue*.3,0,_e.x,_e.y,ue);yt.addColorStop(0,"#FFFF00"),yt.addColorStop(.7,"#FFEB3B"),yt.addColorStop(1,"#FFC107"),L.beginPath(),L.arc(_e.x,_e.y,ue,0,2*Math.PI),L.fillStyle=yt,L.fill(),L.strokeStyle="#FF9800",L.lineWidth=4,L.stroke(),L.fillStyle="#B8860B",L.fillRect(_e.x-ue*.1,_e.y-ue*.4,ue*.2,ue*.8),L.strokeStyle="#FF9800",L.lineWidth=2,L.strokeRect(_e.x-ue*.1,_e.y-ue*.4,ue*.2,ue*.8);const Be="50",qe=ue*.4;L.font=`bold ${qe}px "Arial", sans-serif`,L.textAlign="center",L.textBaseline="middle";const Ke=ue*.7,An=.055+.025*(Be.length-1),Er=-Math.PI*(.5+An),Tr=(-Math.PI*(.5-An)-Er)/(Be.length-1);for(let on=0;on<Be.length;on++){const Ln=Er+Tr*on,gi=_e.x+Math.cos(Ln)*Ke,Xn=_e.y+Math.sin(Ln)*Ke;L.save(),L.translate(gi,Xn),L.rotate(Ln+Math.PI/2),L.fillStyle="rgba(0, 0, 0, 0.7)",L.fillText(Be[on],1,1),L.fillStyle="#8B4513",L.fillText(Be[on],0,0),L.restore()}}if(S.length>0){const Be=_e.x-S.length*45/2,qe=_e.y+ue+80;L.font='bold 36px "Arial", sans-serif',L.textAlign="center",L.textBaseline="middle",S.forEach((Dt,yn)=>{const An=Be+yn*45;he[yn]==="correct"?L.fillStyle="#27ae60":he[yn]==="incorrect"?L.fillStyle="#e74c3c":yn===oe?L.fillStyle="#f39c12":L.fillStyle="#7f8c8d",L.fillText(Dt.toUpperCase(),An,qe)}),oe<S.length&&(L.fillStyle="#FFD700",L.font='bold 24px "Arial", sans-serif',L.fillText(`Press: ${S[oe].toUpperCase()}`,_e.x,qe+60));const Ke=`${oe}/${S.length}`;L.fillStyle="#ecf0f1",L.font='20px "Arial", sans-serif',L.fillText(Ke,_e.x,qe+90)}L.fillStyle="#ffffff",L.font='bold 48px "Orbitron", "Courier New", monospace',L.textAlign="center",L.fillText(`Score: ${s}`,E.width/2,80),L.fillStyle="#ffffff",L.font='16px "Press Start 2P", "Courier New", monospace',L.textAlign="center",S.length>0?L.fillText("Press the highlighted keys in sequence to collect the coin!",E.width/2,E.height-50):L.fillText("Get ready to follow the key sequence!",E.width/2,E.height-50),w&&(L.fillStyle="#00FF00",L.font='bold 36px "Orbitron", "Courier New", monospace',L.textAlign="center",L.fillText("+50",E.width/2,E.height/2-100))}},[r,s,l,c,I,p,C,re,E,U,w,S,oe,he]),k.jsx("div",{className:"game-container",children:k.jsx("div",{className:"canvas-container",children:k.jsx("canvas",{ref:T,width:E.width,height:E.height,onMouseMove:st,className:"game-canvas",style:{width:"100vw",height:"100vh",display:"block"}})})})},FC=()=>{const t=async e=>{try{console.log(`Exporting ${e}...`);const n=await oC(os(pi,e)),r=[];if(n.forEach(p=>{r.push({documentId:p.id,...p.data()})}),console.log(`Found ${r.length} documents in ${e}`),r.length===0){alert(`No data found in ${e}`);return}const i=new Set;r.forEach(p=>{Object.keys(p).forEach(m=>i.add(m))});const s=Array.from(i),o=[s.join(",")];r.forEach(p=>{const m=s.map(I=>{const R=p[I];return R==null?"":Array.isArray(R)?`"${JSON.stringify(R).replace(/"/g,'""')}"`:typeof R=="object"?`"${JSON.stringify(R).replace(/"/g,'""')}"`:`"${String(R).replace(/"/g,'""')}"`});o.push(m.join(","))});const l=o.join(`
`),u=new Blob([l],{type:"text/csv;charset=utf-8;"}),c=URL.createObjectURL(u),d=document.createElement("a");d.href=c,d.download=`${e}_export_${new Date().toISOString().split("T")[0]}.csv`,d.click(),console.log(` Exported ${r.length} documents to CSV`)}catch(n){console.error(` Error exporting ${e}:`,n),alert(`Export failed: ${n.message}`)}};return k.jsxs("div",{style:{padding:"20px",backgroundColor:"#f5f5f5",borderRadius:"8px",margin:"20px",maxWidth:"400px"},children:[k.jsx("h3",{style:{marginTop:0,color:"#333"},children:"Export Firebase Data to CSV"}),k.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[k.jsx("button",{onClick:()=>t("globalInvigorationTrials"),style:{padding:"12px 20px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Export Trials Data"}),k.jsx("button",{onClick:()=>t("globalInvigorationSubjects"),style:{padding:"12px 20px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"bold"},children:" Export Subjects Data"})]}),k.jsx("p",{style:{fontSize:"12px",color:"#666",marginTop:"15px",marginBottom:0},children:"Downloads CSV files with all data from your Firebase collections"})]})};function LC(){const[t,e]=q.useState("consent"),[n,r]=q.useState(null),[i,s]=q.useState(null),[o,l]=q.useState(0),u=async()=>{try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?await document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen?await document.documentElement.msRequestFullscreen():(window.moveTo(0,0),window.resizeTo(screen.width,screen.height))}catch(C){console.warn("Could not enter fullscreen mode:",C);try{window.moveTo(0,0),window.resizeTo(screen.width,screen.height)}catch(M){console.warn("Could not maximize window:",M)}}},c=async()=>{await u(),e("survey")},d=async C=>{r(C);try{const M=await DC(C);s(M),console.log("Participant initialized with ID:",M)}catch(M){console.error("Failed to initialize participant data collection:",M)}l(0),e("instructions")},p=()=>{e("game")},m=()=>{e("practice")},I=()=>{l(3),e("instructions")},R=C=>{e("complete")};return k.jsxs("div",{className:"app",children:[t==="consent"&&k.jsx("div",{style:{position:"fixed",top:"20px",right:"20px",zIndex:9999},children:k.jsx("button",{onClick:()=>e("export"),style:{padding:"10px 15px",backgroundColor:"#FF6B35",color:"white",border:"none",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"bold",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},title:"Export Firebase data to CSV",children:" Export Data"})}),t==="consent"&&k.jsx(oS,{onConsent:c,onDecline:()=>e("decline")}),t==="survey"&&k.jsx(aS,{onSubmit:d}),t==="instructions"&&k.jsx(lS,{onStart:p,onPractice:m,currentPage:o,setCurrentPage:l}),t==="practice"&&k.jsx(OC,{onPracticeComplete:I}),t==="game"&&k.jsx(MC,{participantData:n,participantId:i,onGameComplete:R}),t==="export"&&k.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.8)",zIndex:1e4,display:"flex",justifyContent:"center",alignItems:"center"},children:k.jsxs("div",{style:{backgroundColor:"white",borderRadius:"12px",padding:"20px",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto"},children:[k.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[k.jsx("h2",{style:{margin:0},children:"Export Firebase Data"}),k.jsx("button",{onClick:()=>e("consent"),style:{padding:"8px 12px",backgroundColor:"#666",color:"white",border:"none",borderRadius:"4px",cursor:"pointer"},children:" Close"})]}),k.jsx(FC,{})]})}),t==="complete"&&k.jsxs("div",{className:"complete-message",children:[k.jsx("h1",{children:"Study Complete!"}),k.jsx("p",{children:"Thank you for participating in our research study."})]}),t==="decline"&&k.jsxs("div",{className:"decline-message",children:[k.jsx("h1",{children:"Thank you for your time"}),k.jsx("p",{children:"You have chosen not to participate in this study."})]})]})}const BC=Wh.createRoot(document.getElementById("root"));BC.render(k.jsx(WT.StrictMode,{children:k.jsx(LC,{})}));export{os as $,hT as A,rs as B,Hn as C,ut as D,Zk as E,as as F,Jp as G,Jk as H,qC as I,Sn as J,QP as K,HP as L,th as M,wk as N,Ek as O,_C as P,Vt as Q,ck as R,HC as S,Xe as T,$k as U,Gc as V,gC as W,Uk as X,vk as Y,ZC as Z,tw as _,Ja as a,QC as a0,WP as a1,iC as a2,Xk as a3,Ck as a4,jk as a5,nk as a6,Yk as a7,Xp as a8,ok as a9,sk as aA,kk as aB,Vk as aC,uk as aD,hk as aE,Ok as aF,Fk as aG,pC as aH,ak as aI,XE as aJ,WC as aK,Bk as aL,zk as aM,dT as aN,Qk as aO,jC as aP,Tk as aQ,mk as aR,pk as aS,_k as aT,rk as aU,Pk as aV,Kk as aW,ek as aX,lk as aY,Gk as aZ,XC as aa,JC as ab,tk as ac,Hk as ad,yk as ae,gk as af,Ze as ag,vl as ah,aC as ai,Dk as aj,Ik as ak,Sk as al,Ak as am,oC as an,xk as ao,Rk as ap,YP as aq,Wk as ar,qk as as,YC as at,dk as au,fk as av,ik as aw,Nk as ax,Mk as ay,bk as az,XP as b,yo as c,ls as d,Ve as e,z as f,Do as g,yl as h,xu as i,Zc as j,_l as k,Xc as l,am as m,_o as n,Jc as o,Li as p,yC as q,it as r,Hi as s,W as t,UC as u,jA as v,Ue as w,eV as x,pe as y,zC as z};
